组织通常有多个存储帐户, 以让它们实施不同的要求集。 在巧克力制造商的示例中, 专用业务数据有一个存储帐户, 另一个存储帐户用于面向使用者的文件。 在这里, 你将了解由存储帐户控制的策略因素, 这将帮助你决定需要多少帐户。

## <a name="what-is-azure-storage"></a>什么是 Azure 存储？

Azure 提供了多种存储数据的方法。 有多个数据库选项, 如 azure SQL Server、azure Cosmos DB 和 azure 表存储。 azure 提供了多种方法来存储和发送邮件, 如 Azure 队列和事件中心。 您甚至可以使用 azure 文件和 azure blob 等服务存储松散文件。

azure 选择了这些数据服务中的四个, 并将它们放在名称_Azure 存储_下。 四个服务是 azure blob、azure 文件、azure 队列和 Azure 表。 下图显示了 Azure 存储的元素。

![图: 列出属于 azure 存储的 azure 数据服务。](../media/2-azure-storage.png)

这四个被授予特殊处理的原因是, 它们都是基于云的所有基元存储服务, 并且通常在同一应用程序中一起使用。

## <a name="what-is-a-storage-account"></a>什么是存储帐户？

_存储帐户_是将一组 Azure 存储服务组合在一起的容器。 仅 azure 存储中的数据服务可以包含在存储帐户 (azure blob、azure 文件、azure 队列和 Azure 表) 中。 下图显示了包含多个数据服务的存储帐户。

![包含混合的数据服务集合的 Azure 存储帐户的插图。](../media/2-what-is-a-storage-account.png)

将数据服务组合到存储帐户中, 可以将其作为一个组进行管理。 您在创建帐户时指定的设置或创建后所做的任何更改都将应用于该帐户中的所有内容。 删除存储帐户会删除存储在其中的所有数据。

存储帐户是 Azure 资源, 包含在资源组中。 下图显示了包含多个资源组的 Azure 订阅, 其中每个组包含一个或多个存储帐户。

![包含多个资源组和存储帐户的 Azure 订阅的插图。](../media/2-resource-groups-and-storage-accounts.png)

其他 azure 数据服务 (如 azure SQL 和 Cosmos DB) 作为独立的 azure 资源进行管理, 不能包含在存储帐户中。 下图显示了一种典型的排列方式: blob、文件、队列和表位于存储帐户内, 而其他服务则不是。

![显示一些无法放置在存储帐户中的数据服务的 Azure 订阅的插图。](../media/2-typical-subscription-organization.png)

## <a name="storage-account-settings"></a>存储帐户设置

存储帐户定义适用于帐户中所有存储服务的策略。 例如, 您可以指定将所有包含的服务存储在美国西部数据中心, 只能通过 https 访问, 并对销售部门的订阅收费。

由存储帐户控制的设置为:

- **订阅**: 将为帐户中的服务计费的 Azure 订阅。

- **Location**: 将在帐户中存储服务的数据中心。

- **性能**: 确定可以在存储帐户中使用的数据服务和用于存储数据的硬件磁盘的类型。 **标准**允许您拥有任何数据服务 (Blob、文件、队列、表) 并使用磁盘驱动器。 **Premium**限制为您提供一种称为_页面 blob_的特定类型的 blob, 并使用固态驱动器 (SSD) 进行存储。

- **复制**: 确定用于制作数据副本以防止硬件故障或自然灾害的策略。 Azure 至少会在与存储帐户关联的数据中心中自动维护一份数据副本。 这称为 "本地冗余存储 (LRS)", 可防止出现硬件故障, 但不能防止您导致整个数据中心的事件。 您可以升级到其他选项之一 (如地域冗余存储 (GRS)), 以在世界范围内的不同数据中心获取复制。

- **访问层**: 控制您将能够以多快的速度访问此存储帐户中的 blob。 "热" 提供了更快的访问权限, 但成本增加。 这仅适用于 blob, 并用作新 blob 的默认值。

- **需要进行安全传输**: 确定访问支持的协议的安全功能。 Enabled 需要 HTTPs, 而禁用则允许 HTTP。

- **虚拟网络**: 仅允许来自您指定的虚拟网络的入站访问请求的安全功能。

## <a name="how-many-storage-accounts-do-you-need"></a>你需要多少个存储帐户？

存储帐户代表位置、复制策略和订阅所有者等设置的集合。 对于要应用于数据的每组设置, 您都需要一个存储帐户。 下图显示了一种设置不同的两个存储帐户;一个差异足以满足需要单独的存储帐户。

![图示显示具有不同设置的两个存储帐户。](../media/2-multiple-storage-accounts.png)

您所需的存储帐户数通常由您的数据多样性、成本敏感度和管理开销的容限决定。

### <a name="data-diversity"></a>数据多样性

组织通常会生成与使用情况不同的数据、数据的敏感程度、帐单支付费用等。按照上述任何一个矢量的多样性可能会导致多个存储帐户。 让我们考虑两个示例:

1. 您是否有特定于某个国家或地区的数据？ 如果是这样, 出于性能或合规性原因, 您可能需要在该国家/地区的数据中心中查找它。 每个位置都需要一个存储帐户。

1. 您是否有一些数据是专有的, 一些用于公共消耗量？ 如果是这样, 则可以为专用数据 (而不是公共数据) 启用虚拟网络。 这还需要单独的存储帐户。

总的来说, 增加的多样性意味着存储帐户数量增加。

### <a name="cost-sensitivity"></a>成本敏感度

存储帐户本身没有财务成本;但是, 为帐户选择的设置会影响帐户中服务的成本。 地域冗余存储的成本高于本地冗余存储。 高级性能和热接入层将增加 blob 的成本。

您可以使用多个存储帐户来降低成本。 例如, 您可以将数据划分为关键和非临界的类别。 您可以将您的关键数据放在具有地域冗余存储的存储帐户中, 并将非关键数据放在具有本地冗余存储的不同存储帐户中。

### <a name="tolerance-for-management-overhead"></a>管理开销的容错能力

每个存储帐户需要管理员进行一些时间和关注, 以供管理员创建和维护。 它还增加了向云存储区添加数据的任何人的复杂性;此角色中的每个人都需要了解每个存储帐户的用途, 以便他们将新数据添加到正确的帐户。

存储帐户是一个功能强大的工具, 可帮助您实现所需的性能和安全性, 同时最大限度地减少成本。 典型策略是首先分析数据, 并创建共享诸如位置、计费和复制策略等特征的分区, 然后为每个分区创建一个存储帐户。