<span data-ttu-id="de41a-101">我们有一个在本地 Ubuntu Linux 服务器上运行的现有网站。</span><span class="sxs-lookup"><span data-stu-id="de41a-101">We have an existing website running on a local Ubuntu Linux server.</span></span> <span data-ttu-id="de41a-102">我们的目标是使用最新的 Ubuntu 图像创建 Azure 虚拟机 (VM), 然后将该网站迁移到云。</span><span class="sxs-lookup"><span data-stu-id="de41a-102">Our goal is to create an Azure virtual machine (VM) using the latest Ubuntu image and then migrate the site to the cloud.</span></span> <span data-ttu-id="de41a-103">在此单元中, 你将了解在 Azure 中创建虚拟机时需要评估的选项。</span><span class="sxs-lookup"><span data-stu-id="de41a-103">In this unit, you will learn about the options you will need to evaluate when creating a virtual machine in Azure.</span></span>

## <a name="introduction-to-azure-virtual-machines"></a><span data-ttu-id="de41a-104">Azure 虚拟机简介</span><span class="sxs-lookup"><span data-stu-id="de41a-104">Introduction to Azure Virtual Machines</span></span>

<span data-ttu-id="de41a-105">Azure 虚拟机是一个按需的可扩展云计算资源。</span><span class="sxs-lookup"><span data-stu-id="de41a-105">Azure Virtual Machines is an on-demand, scalable cloud-computing resource.</span></span> <span data-ttu-id="de41a-106">其中包括处理器、内存、存储和网络资源。</span><span class="sxs-lookup"><span data-stu-id="de41a-106">They include processors, memory, storage, and networking resources.</span></span> <span data-ttu-id="de41a-107">你可以随时启动和停止虚拟机, 也可以从 azure 门户或 azure CLI 进行管理。</span><span class="sxs-lookup"><span data-stu-id="de41a-107">You can start and stop virtual machines at will and manage them from the Azure portal or with the Azure CLI.</span></span> <span data-ttu-id="de41a-108">您还可以使用远程安全命令行管理程序 (SSH) 直接连接到正在运行的 VM, 并执行命令, 就像您在本地计算机上一样。</span><span class="sxs-lookup"><span data-stu-id="de41a-108">You can also use a remote Secure Shell (SSH) to connect directly to the running VM and execute commands as if you were on a local computer.</span></span>

### <a name="running-linux-in-azure"></a><span data-ttu-id="de41a-109">在 Azure 中运行 Linux</span><span class="sxs-lookup"><span data-stu-id="de41a-109">Running Linux in Azure</span></span>

<span data-ttu-id="de41a-110">在 Azure 中创建基于 Linux 的 vm 非常简单。</span><span class="sxs-lookup"><span data-stu-id="de41a-110">Creating Linux-based VMs in Azure is easy.</span></span> <span data-ttu-id="de41a-111">Microsoft 已与主要的 Linux 供应商合作, 以确保为 Azure 平台优化其分发。</span><span class="sxs-lookup"><span data-stu-id="de41a-111">Microsoft has partnered with prominent Linux vendors to ensure their distributions are optimized for the Azure platform.</span></span> <span data-ttu-id="de41a-112">您可以从预构建的映像创建虚拟机, 以用于各种流行的 linux 分布 (如 SUSE、红色帽子和 Ubuntu), 或者构建您自己的 linux 分发以在云中运行。</span><span class="sxs-lookup"><span data-stu-id="de41a-112">You can create virtual machines from prebuilt images for a variety of popular Linux distributions, such as SUSE, Red Hat, and Ubuntu, or build your own Linux distribution to run in the cloud.</span></span>

## <a name="creating-an-azure-vm"></a><span data-ttu-id="de41a-113">创建 Azure 虚拟机</span><span class="sxs-lookup"><span data-stu-id="de41a-113">Creating an Azure VM</span></span>

<span data-ttu-id="de41a-114">可以通过以下几种方式在 Azure 上定义和部署 vm: azure 门户、脚本 (使用 Azure CLI 或 azure PowerShell) 或 Azure 资源管理器模板。</span><span class="sxs-lookup"><span data-stu-id="de41a-114">VMs can be defined and deployed on Azure in several ways: the Azure portal, a script (using the Azure CLI or Azure PowerShell), or an Azure Resource Manager template.</span></span> <span data-ttu-id="de41a-115">在所有情况下, 您都需要提供一些我们将很快包含的信息。</span><span class="sxs-lookup"><span data-stu-id="de41a-115">In all cases, you will need to supply several pieces of information that we'll cover shortly.</span></span>

<span data-ttu-id="de41a-116">Azure Marketplace 还提供了预配置的图像, 其中包括为特定方案安装的操作系统和喜爱的软件工具。</span><span class="sxs-lookup"><span data-stu-id="de41a-116">The Azure Marketplace also provides preconfigured images that include both an OS and favorite software tools installed for specific scenarios.</span></span>

![在 azure Marketplace 中显示多个虚拟机选项的 azure 门户的屏幕截图。](../media/2-marketplace-vm-choices.png)

## <a name="resources-used-in-a-linux-vm"></a><span data-ttu-id="de41a-118">Linux VM 中使用的资源</span><span class="sxs-lookup"><span data-stu-id="de41a-118">Resources used in a Linux VM</span></span>

<span data-ttu-id="de41a-119">在 Azure 中创建 Linux VM 时, 还会创建资源以托管 VM。</span><span class="sxs-lookup"><span data-stu-id="de41a-119">When creating a Linux VM in Azure, you also create resources to host the VM.</span></span> <span data-ttu-id="de41a-120">这些资源协同工作以虚拟化计算机并运行 Linux 操作系统。</span><span class="sxs-lookup"><span data-stu-id="de41a-120">These resources work together to virtualize a computer and run the Linux operating system.</span></span> <span data-ttu-id="de41a-121">这些项必须存在 (并在创建 vm 时选择), 否则将使用 vm 创建它们:</span><span class="sxs-lookup"><span data-stu-id="de41a-121">These must exist (and be selected during VM creation), or they will be created with the VM:</span></span>

- <span data-ttu-id="de41a-122">提供 CPU 和内存资源的虚拟机</span><span class="sxs-lookup"><span data-stu-id="de41a-122">A virtual machine that provides CPU and memory resources</span></span>
- <span data-ttu-id="de41a-123">用于保存虚拟硬盘的 Azure 存储帐户</span><span class="sxs-lookup"><span data-stu-id="de41a-123">An Azure Storage account to hold the virtual hard disks</span></span>
- <span data-ttu-id="de41a-124">用于存放 OS、应用程序和数据的虚拟磁盘</span><span class="sxs-lookup"><span data-stu-id="de41a-124">Virtual disks to hold the OS, applications, and data</span></span>
- <span data-ttu-id="de41a-125">用于将 VM 连接到其他 Azure 服务或本地硬件的虚拟网络 (VNet)</span><span class="sxs-lookup"><span data-stu-id="de41a-125">A virtual network (VNet) to connect the VM to other Azure services or your on-premises hardware</span></span>
- <span data-ttu-id="de41a-126">与 VNet 通信的网络接口</span><span class="sxs-lookup"><span data-stu-id="de41a-126">A network interface to communicate with the VNet</span></span>
- <span data-ttu-id="de41a-127">一个可选的公共 IP 地址, 以便你可以访问 VM</span><span class="sxs-lookup"><span data-stu-id="de41a-127">An optional public IP address so you can access the VM</span></span>

<span data-ttu-id="de41a-128">与其他 Azure 服务一样, 你需要一个**资源组**来包含 VM (并可以选择对这些资源进行管理)。</span><span class="sxs-lookup"><span data-stu-id="de41a-128">Like other Azure services, you'll need a **Resource Group** to contain the VM (and optionally group these resources for administration).</span></span> <span data-ttu-id="de41a-129">创建新的 VM 时, 可以使用现有的资源组, 也可以创建一个新的虚拟机。</span><span class="sxs-lookup"><span data-stu-id="de41a-129">When you create a new VM, you can either use an existing resource group or create a new one.</span></span>

## <a name="choose-the-vm-image"></a><span data-ttu-id="de41a-130">选择虚拟机映像</span><span class="sxs-lookup"><span data-stu-id="de41a-130">Choose the VM image</span></span>

<span data-ttu-id="de41a-131">选择图像是创建 VM 时第一次也是最重要的决策之一。</span><span class="sxs-lookup"><span data-stu-id="de41a-131">Selecting an image is one of the first and most important decisions you'll make when creating a VM.</span></span> <span data-ttu-id="de41a-132">图像是用于创建虚拟机的模板。</span><span class="sxs-lookup"><span data-stu-id="de41a-132">An image is a template that's used to create a VM.</span></span> <span data-ttu-id="de41a-133">这些模板包括操作系统, 通常是其他软件, 如开发工具或 web 托管环境。</span><span class="sxs-lookup"><span data-stu-id="de41a-133">These templates include an OS and often other software, such as development tools or web hosting environments.</span></span>

<span data-ttu-id="de41a-134">计算机可以安装的任何内容都可以包含在映像中。</span><span class="sxs-lookup"><span data-stu-id="de41a-134">Anything that a computer can have installed can be included in an image.</span></span> <span data-ttu-id="de41a-135">您可以从已预先配置为您所需的任务的映像中创建 VM, 例如在 Apache HTTP 服务器上承载 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="de41a-135">You can create a VM from an image that's preconfigured to precisely the tasks you need, such as hosting a web app on the Apache HTTP Server.</span></span>

> [!TIP]
> <span data-ttu-id="de41a-136">您还可以创建和上载自定义磁盘映像。</span><span class="sxs-lookup"><span data-stu-id="de41a-136">You can also create and upload custom disk images.</span></span>

## <a name="sizing-your-vm"></a><span data-ttu-id="de41a-137">调整你的 VM 的大小</span><span class="sxs-lookup"><span data-stu-id="de41a-137">Sizing your VM</span></span>

<span data-ttu-id="de41a-138">正如物理计算机具有一定数量的内存和 CPU 功能一样, 虚拟机也是如此。</span><span class="sxs-lookup"><span data-stu-id="de41a-138">Just as a physical machine has a certain amount of memory and CPU power, so does a virtual machine.</span></span> <span data-ttu-id="de41a-139">Azure 以不同的价位提供了一系列不同大小的虚拟机。</span><span class="sxs-lookup"><span data-stu-id="de41a-139">Azure offers a range of VMs of differing sizes at different price points.</span></span> <span data-ttu-id="de41a-140">您选择的大小将确定虚拟机的处理能力、内存和最大存储容量。</span><span class="sxs-lookup"><span data-stu-id="de41a-140">The size that you choose will determine the VM's processing power, memory, and maximum storage capacity.</span></span>

> [!WARNING]
> <span data-ttu-id="de41a-141">对可以影响 VM 创建的每个订阅都有配额限制。</span><span class="sxs-lookup"><span data-stu-id="de41a-141">There are quota limits on each subscription that can impact VM creation.</span></span> <span data-ttu-id="de41a-142">如果你遇到这些配额限制, 你可以[打开一个在线客户支持请求](https://docs.microsoft.com/azure/azure-supportability/resource-manager-core-quotas-request)来增加你的限制。</span><span class="sxs-lookup"><span data-stu-id="de41a-142">If you run into these quota limits you can [open an online customer support request](https://docs.microsoft.com/azure/azure-supportability/resource-manager-core-quotas-request) to increase your limits.</span></span>

<span data-ttu-id="de41a-143">VM 大小按类别进行分组, 从 B 系列开始, 以进行基本测试, 并在高达 H 系列中为大型计算任务运行。</span><span class="sxs-lookup"><span data-stu-id="de41a-143">VM sizes are grouped into categories, starting with the B-series for basic testing and running up to the H-series for massive computing tasks.</span></span> <span data-ttu-id="de41a-144">应根据要执行的工作负荷选择 VM 的大小。</span><span class="sxs-lookup"><span data-stu-id="de41a-144">You should select the size of the VM based on the workload you want to perform.</span></span> <span data-ttu-id="de41a-145">在创建虚拟机后, 可以更改其大小, 但必须先停止 vm。</span><span class="sxs-lookup"><span data-stu-id="de41a-145">It is possible to change the size of a VM after it's been created, but the VM must be stopped first.</span></span> <span data-ttu-id="de41a-146">因此, 最好在可能的情况下正确地调整其大小。</span><span class="sxs-lookup"><span data-stu-id="de41a-146">So, it's best to size it appropriately from the start if possible.</span></span>

#### <a name="here-are-some-guidelines-based-on-the-scenario-you-are-targeting"></a><span data-ttu-id="de41a-147">下面是基于您设定的方案的一些准则</span><span class="sxs-lookup"><span data-stu-id="de41a-147">Here are some guidelines based on the scenario you are targeting</span></span>

| <span data-ttu-id="de41a-148">你在做什么？</span><span class="sxs-lookup"><span data-stu-id="de41a-148">What are you doing?</span></span> | <span data-ttu-id="de41a-149">考虑这些大小</span><span class="sxs-lookup"><span data-stu-id="de41a-149">Consider these sizes</span></span>
|-------|------------------|
| <span data-ttu-id="de41a-150">**常规使用计算/web**: 测试和开发、小型到中型数据库或低到中型流量 web 服务器。</span><span class="sxs-lookup"><span data-stu-id="de41a-150">**General use computing/web**: Testing and development, small to medium databases, or low to medium traffic web servers.</span></span> | <span data-ttu-id="de41a-151">B、Dsv3、Dv3、DSv2、Dv2</span><span class="sxs-lookup"><span data-stu-id="de41a-151">B, Dsv3, Dv3, DSv2, Dv2</span></span> |
| <span data-ttu-id="de41a-152">**重计算任务**: 中型流量 web 服务器、网络设备、批处理过程和应用程序服务器。</span><span class="sxs-lookup"><span data-stu-id="de41a-152">**Heavy computational tasks**: Medium traffic web servers, network appliances, batch processes, and application servers.</span></span> | <span data-ttu-id="de41a-153">Fsv2, Fs, F</span><span class="sxs-lookup"><span data-stu-id="de41a-153">Fsv2, Fs, F</span></span> |
| <span data-ttu-id="de41a-154">**较大的内存使用率**: 关系数据库服务器、大型缓存和内存中的分析。</span><span class="sxs-lookup"><span data-stu-id="de41a-154">**Large memory usage**: Relational database servers, medium to large caches, and in-memory analytics.</span></span> | <span data-ttu-id="de41a-155">Esv3、Ev3、M、GS、G、DSv2、Dv2</span><span class="sxs-lookup"><span data-stu-id="de41a-155">Esv3, Ev3, M, GS, G, DSv2, Dv2</span></span> |
| <span data-ttu-id="de41a-156">**数据存储和处理**: 需要高磁盘吞吐量和 i/o 的大型数据、SQL 和 NoSQL 数据库。</span><span class="sxs-lookup"><span data-stu-id="de41a-156">**Data storage and processing**: Big data, SQL, and NoSQL databases that need high disk throughput and I/O.</span></span> | <span data-ttu-id="de41a-157">!</span><span class="sxs-lookup"><span data-stu-id="de41a-157">Ls</span></span> |
| <span data-ttu-id="de41a-158">**较高的图形呈现**或视频编辑, 以及深入学习的模型培训和 inferencing (ND)。</span><span class="sxs-lookup"><span data-stu-id="de41a-158">**Heavy graphics rendering** or video editing, as well as model training and inferencing (ND) with deep learning.</span></span> | <span data-ttu-id="de41a-159">NV、NC、NCv2、NCv3、ND</span><span class="sxs-lookup"><span data-stu-id="de41a-159">NV, NC, NCv2, NCv3, ND</span></span> |
| <span data-ttu-id="de41a-160">**高性能计算 (HPC)**: 您的工作负载需要具有可选择的高吞吐量网络接口的速度最快且功能最强大的 CPU 虚拟机。</span><span class="sxs-lookup"><span data-stu-id="de41a-160">**High-performance computing (HPC)**: Your workloads need the fastest and most powerful CPU virtual machines with optional high-throughput network interfaces.</span></span> | <span data-ttu-id="de41a-161">水平</span><span class="sxs-lookup"><span data-stu-id="de41a-161">H</span></span> |

## <a name="choosing-storage-options"></a><span data-ttu-id="de41a-162">选择存储选项</span><span class="sxs-lookup"><span data-stu-id="de41a-162">Choosing storage options</span></span>

<span data-ttu-id="de41a-163">下一组决策围绕存储。</span><span class="sxs-lookup"><span data-stu-id="de41a-163">The next set of decisions revolves around storage.</span></span> <span data-ttu-id="de41a-164">首先, 可以选择磁盘技术。</span><span class="sxs-lookup"><span data-stu-id="de41a-164">First, you can choose the disk technology.</span></span> <span data-ttu-id="de41a-165">选项包括传统的基于磁盘驱动器的硬盘驱动器 (HDD) 或更新式的固态驱动器 (SSD)。</span><span class="sxs-lookup"><span data-stu-id="de41a-165">Options include a traditional platter-based hard disk drive (HDD) or a more modern solid-state drive (SSD).</span></span> <span data-ttu-id="de41a-166">就像购买的硬件一样, SSD 存储成本更高, 但提供了更好的性能。</span><span class="sxs-lookup"><span data-stu-id="de41a-166">Just like the hardware you purchase, SSD storage costs more but provides better performance.</span></span>

> [!TIP]
> <span data-ttu-id="de41a-167">有两个级别的 SSD 存储可供使用: 标准版和高级版。</span><span class="sxs-lookup"><span data-stu-id="de41a-167">There are two levels of SSD storage available: standard and premium.</span></span> <span data-ttu-id="de41a-168">如果你具有正常工作负载但需要更好的性能, 请选择标准 SSD 磁盘。</span><span class="sxs-lookup"><span data-stu-id="de41a-168">Choose Standard SSD disks if you have normal workloads but want better performance.</span></span> <span data-ttu-id="de41a-169">如果您具有需要非常快地处理数据的 i/o 密集型工作负荷或任务关键型系统, 请选择 "高级 SSD 磁盘"。</span><span class="sxs-lookup"><span data-stu-id="de41a-169">Choose Premium SSD disks if you have I/O intensive workloads or mission-critical systems that need to process data very quickly.</span></span>

### <a name="mapping-storage-to-disks"></a><span data-ttu-id="de41a-170">将存储映射到磁盘</span><span class="sxs-lookup"><span data-stu-id="de41a-170">Mapping storage to disks</span></span>

<span data-ttu-id="de41a-171">Azure 使用虚拟硬盘 (vhd) 来表示虚拟机的物理磁盘。</span><span class="sxs-lookup"><span data-stu-id="de41a-171">Azure uses virtual hard disks (VHDs) to represent physical disks for the VM.</span></span> <span data-ttu-id="de41a-172">vhd 复制磁盘驱动器的逻辑格式和数据, 但存储为 Azure 存储帐户中的页面 blob。</span><span class="sxs-lookup"><span data-stu-id="de41a-172">VHDs replicate the logical format and data of a disk drive but are stored as page blobs in an Azure Storage account.</span></span> <span data-ttu-id="de41a-173">可以基于每个磁盘选择它应使用的存储类型 (SSD 或 HDD)。</span><span class="sxs-lookup"><span data-stu-id="de41a-173">You can choose on a per disk basis what type of storage it should use (SSD or HDD).</span></span> <span data-ttu-id="de41a-174">这使您可以控制每个磁盘的性能, 这可能取决于您计划在其上执行的 i/o。</span><span class="sxs-lookup"><span data-stu-id="de41a-174">This allows you to control the performance of each disk, likely based on the I/O you plan to perform on it.</span></span>

<span data-ttu-id="de41a-175">默认情况下, 将为你的 Linux VM 创建两个虚拟硬盘 (vhd):</span><span class="sxs-lookup"><span data-stu-id="de41a-175">By default, two virtual hard disks (VHDs) will be created for your Linux VM:</span></span>

1. <span data-ttu-id="de41a-176">**操作系统磁盘**: 这是主驱动器, 最大容量为 2048 GB。</span><span class="sxs-lookup"><span data-stu-id="de41a-176">The **operating system disk**: This is your primary drive, and it has a maximum capacity of 2048 GB.</span></span> <span data-ttu-id="de41a-177">默认情况下, 它`/dev/sda`会被标记为。</span><span class="sxs-lookup"><span data-stu-id="de41a-177">It will be labeled as `/dev/sda` by default.</span></span>

1. <span data-ttu-id="de41a-178">**临时磁盘**: 这将为 OS 或任何应用程序提供临时存储空间。</span><span class="sxs-lookup"><span data-stu-id="de41a-178">A **temporary disk**: This provides temporary storage for the OS or any apps.</span></span> <span data-ttu-id="de41a-179">在 Linux 虚拟机上, 磁盘已`/dev/sdb`格式化并由 Azure Linux 代理`/mnt`安装到。</span><span class="sxs-lookup"><span data-stu-id="de41a-179">On Linux virtual machines, the disk is `/dev/sdb` and is formatted and mounted to `/mnt` by the Azure Linux Agent.</span></span> <span data-ttu-id="de41a-180">根据 VM 大小调整大小, 并用于存储交换文件。</span><span class="sxs-lookup"><span data-stu-id="de41a-180">It is sized based on the VM size and is used to store the swap file.</span></span>

> [!WARNING]
> <span data-ttu-id="de41a-181">临时磁盘不是永久性的。</span><span class="sxs-lookup"><span data-stu-id="de41a-181">The temporary disk is not persistent.</span></span> <span data-ttu-id="de41a-182">你应该只向此磁盘写入对系统不重要的数据。</span><span class="sxs-lookup"><span data-stu-id="de41a-182">You should only write data to this disk that is not critical to the system.</span></span>

#### <a name="what-about-data"></a><span data-ttu-id="de41a-183">数据是什么？</span><span class="sxs-lookup"><span data-stu-id="de41a-183">What about data?</span></span>

<span data-ttu-id="de41a-184">您可以在主驱动器和操作系统上存储数据, 但更好的方法是创建专用的_数据磁盘_。</span><span class="sxs-lookup"><span data-stu-id="de41a-184">You can store data on the primary drive along with the OS, but a better approach is to create dedicated _data disks_.</span></span> <span data-ttu-id="de41a-185">你可以创建其他磁盘并将其附加到 VM。</span><span class="sxs-lookup"><span data-stu-id="de41a-185">You can create and attach additional disks to the VM.</span></span> <span data-ttu-id="de41a-186">每个磁盘最多可以包含 4095 GB 的数据, 最大存储量取决于所选的 VM 大小。</span><span class="sxs-lookup"><span data-stu-id="de41a-186">Each disk can hold up to 4095 GB of data, with the maximum amount of storage determined by the VM size you select.</span></span>

> [!NOTE]
> <span data-ttu-id="de41a-187">一种有趣的功能是从实际磁盘创建 VHD 映像。</span><span class="sxs-lookup"><span data-stu-id="de41a-187">An interesting capability is to create a VHD image from a real disk.</span></span> <span data-ttu-id="de41a-188">这使您可以轻松地将_现有_信息从本地计算机迁移到云。</span><span class="sxs-lookup"><span data-stu-id="de41a-188">This allows you to easily migrate _existing_ information from an on-premises computer to the cloud.</span></span>

### <a name="unmanaged-vs-managed-disks"></a><span data-ttu-id="de41a-189">非托管磁盘与托管磁盘</span><span class="sxs-lookup"><span data-stu-id="de41a-189">Unmanaged vs. managed disks</span></span>

<span data-ttu-id="de41a-190">你将做出的最终存储选择是使用**非托管**磁盘还是**托管**磁盘。</span><span class="sxs-lookup"><span data-stu-id="de41a-190">The final storage choice you'll make is whether to use **unmanaged** or **managed** disks.</span></span>

<span data-ttu-id="de41a-191">对于非托管磁盘, 您负责处理用于保存与您的 VM 磁盘对应的 vhd 的存储帐户。</span><span class="sxs-lookup"><span data-stu-id="de41a-191">With unmanaged disks, you are responsible for the storage accounts that are used to hold the VHDs that correspond to your VM disks.</span></span> <span data-ttu-id="de41a-192">您为所使用的空间量支付存储帐户费率。</span><span class="sxs-lookup"><span data-stu-id="de41a-192">You pay the storage account rates for the amount of space you use.</span></span> <span data-ttu-id="de41a-193">一个存储帐户的速率限制为每秒20000个 i/o 操作数。这意味着单个存储帐户能够在完全限制的情况支持40标准虚拟硬盘。</span><span class="sxs-lookup"><span data-stu-id="de41a-193">A single storage account has a fixed rate limit of 20,000 I/O operations/sec. This means that a single storage account is capable of supporting 40 standard virtual hard disks at full throttle.</span></span> <span data-ttu-id="de41a-194">如果需要向外扩展, 则需要多个存储帐户, 这可能会变得复杂。</span><span class="sxs-lookup"><span data-stu-id="de41a-194">If you need to scale out, then you need more than one storage account, which can get complicated.</span></span>

<span data-ttu-id="de41a-195">托管磁盘是较新的推荐磁盘存储模型。</span><span class="sxs-lookup"><span data-stu-id="de41a-195">Managed disks are the newer and recommended disk storage model.</span></span> <span data-ttu-id="de41a-196">它们通过将管理存储帐户的负担放到 Azure 上来解决此复杂性。 elegantly</span><span class="sxs-lookup"><span data-stu-id="de41a-196">They elegantly solve this complexity by putting the burden of managing the storage accounts onto Azure.</span></span> <span data-ttu-id="de41a-197">您可以指定磁盘类型 ("最优" 或 "标准") 和磁盘大小, 并且 Azure 将创建并管理它所使用的磁盘_和_存储。</span><span class="sxs-lookup"><span data-stu-id="de41a-197">You specify the disk type (Premium or Standard) and the size of the disk, and Azure creates and manages both the disk _and_ the storage it uses.</span></span> <span data-ttu-id="de41a-198">您无需担心存储帐户限制, 这样就可以更轻松地向外扩展。它们还提供了其他几项好处:</span><span class="sxs-lookup"><span data-stu-id="de41a-198">You don't have to worry about storage account limits, which makes them easier to scale out. They also offer several other benefits:</span></span>

- <span data-ttu-id="de41a-199">**增强了可靠性**: azure 可确保与高可靠性虚拟机相关联的 vhd 放置在 Azure 存储的不同部分, 以提供类似的恢复级别。</span><span class="sxs-lookup"><span data-stu-id="de41a-199">**Increased reliability**: Azure ensures that VHDs associated with high-reliability VMs will be placed in different parts of Azure Storage to provide similar levels of resilience.</span></span>
- <span data-ttu-id="de41a-200">**更好的安全性**: 托管磁盘是资源组中的真正管理的资源。</span><span class="sxs-lookup"><span data-stu-id="de41a-200">**Better security**: Managed disks are real managed resources in the resource group.</span></span> <span data-ttu-id="de41a-201">这意味着他们可以使用基于角色的访问控制来限制可处理 VHD 数据的人员。</span><span class="sxs-lookup"><span data-stu-id="de41a-201">This means they can use role-based access control to restrict who can work with the VHD data.</span></span>
- <span data-ttu-id="de41a-202">**快照支持**: 快照可用于创建 VHD 的只读副本。</span><span class="sxs-lookup"><span data-stu-id="de41a-202">**Snapshot support**: Snapshots can be used to create a read-only copy of a VHD.</span></span> <span data-ttu-id="de41a-203">您必须关闭拥有的 VM, 但创建快照只需几秒钟。</span><span class="sxs-lookup"><span data-stu-id="de41a-203">You have to shut down the owning VM, but creating the snapshot only takes a few seconds.</span></span> <span data-ttu-id="de41a-204">完成后, 可以打开 vm 并使用快照创建一个重复的 vm, 以解决生产问题, 或将 vm 回滚到拍摄快照的时间点。</span><span class="sxs-lookup"><span data-stu-id="de41a-204">Once it's done, you can power on the VM and use the snapshot to create a duplicate VM to troubleshoot a production issue or roll back the VM to the point in time that the snapshot was taken.</span></span>
- <span data-ttu-id="de41a-205">**备份支持**: 可以将托管磁盘自动备份到不同区域, 以使用 Azure 备份进行灾难恢复, 而不会影响 VM 的服务。</span><span class="sxs-lookup"><span data-stu-id="de41a-205">**Backup support**: Managed disks can be automatically backed up to different regions for disaster recovery with Azure Backup without affecting the service of the VM.</span></span>

## <a name="network-communication"></a><span data-ttu-id="de41a-206">网络通信</span><span class="sxs-lookup"><span data-stu-id="de41a-206">Network communication</span></span>

<span data-ttu-id="de41a-207">虚拟机使用虚拟网络 (VNet) 与外部资源进行通信。</span><span class="sxs-lookup"><span data-stu-id="de41a-207">Virtual machines communicate with external resources using a virtual network (VNet).</span></span> <span data-ttu-id="de41a-208">VNet 表示您的资源在单个区域中进行通信的专用网络。</span><span class="sxs-lookup"><span data-stu-id="de41a-208">The VNet represents a private network in a single region that your resources communicate on.</span></span> <span data-ttu-id="de41a-209">虚拟网络就像您在本地管理的网络一样。</span><span class="sxs-lookup"><span data-stu-id="de41a-209">A virtual network is just like the networks you manage on-premises.</span></span> <span data-ttu-id="de41a-210">您可以使用子网将它们划分为隔离资源, 将它们连接到其他网络 (包括您的本地网络), 并应用流量规则来控制入站和出站连接。</span><span class="sxs-lookup"><span data-stu-id="de41a-210">You can divide them up with subnets to isolate resources, connect them to other networks (including your on-premises networks), and apply traffic rules to govern inbound and outbound connections.</span></span>

### <a name="planning-your-network"></a><span data-ttu-id="de41a-211">规划网络</span><span class="sxs-lookup"><span data-stu-id="de41a-211">Planning your network</span></span>

<span data-ttu-id="de41a-212">创建新的 VM 时, 可以选择创建新的虚拟网络或使用区域中现有的 VNet。</span><span class="sxs-lookup"><span data-stu-id="de41a-212">When you create a new VM, you will have the option of creating a new virtual network or using an existing VNet in your region.</span></span>

<span data-ttu-id="de41a-213">将 Azure 与 VM 一起创建的网络非常简单, 但很可能不适合大多数方案。</span><span class="sxs-lookup"><span data-stu-id="de41a-213">Having Azure create the network together with the VM is simple, but it's likely not ideal for most scenarios.</span></span> <span data-ttu-id="de41a-214">最好_提前_规划体系结构中所有组件的网络要求并单独创建 VNet 结构。</span><span class="sxs-lookup"><span data-stu-id="de41a-214">It's better to plan your network requirements _up front_ for all the components in your architecture and create the VNet structure separately.</span></span> <span data-ttu-id="de41a-215">然后, 创建虚拟机并将其放入已创建的 vnet 中。</span><span class="sxs-lookup"><span data-stu-id="de41a-215">Then, create the VMs and place them into the already-created VNets.</span></span> <span data-ttu-id="de41a-216">我们将在本模块后面的虚拟网络中详细介绍。</span><span class="sxs-lookup"><span data-stu-id="de41a-216">We'll look more at virtual networks later in this module.</span></span>

<span data-ttu-id="de41a-217">在创建虚拟机之前, 我们需要决定如何管理 VM。</span><span class="sxs-lookup"><span data-stu-id="de41a-217">Before we create a virtual machine, we need to decide how we'd like to administer the VM.</span></span> <span data-ttu-id="de41a-218">让我们来看一下我们的选项。</span><span class="sxs-lookup"><span data-stu-id="de41a-218">Let's look at our options.</span></span>