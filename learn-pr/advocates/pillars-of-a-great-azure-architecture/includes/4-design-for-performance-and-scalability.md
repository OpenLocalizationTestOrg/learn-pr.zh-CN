假设新闻报道刚刚发布, 覆盖了贵组织的突破性 cancer 处理。 这是一种极大的里程碑, 无疑会给您的网站提供大量难题的流量。 网站是否会对此流量造成影响, 或导致网站运行缓慢或不响应？

在这里, 我们将介绍一些使用缩放和优化原则确保未完成的应用程序性能的基本原则。

## <a name="what-is-scaling-and-performance-optimization"></a>什么是扩展和性能优化？

扩展和性能优化是与应用程序在收到的需求匹配时可使用的资源。 性能优化包括扩展资源、识别和优化潜在的瓶颈, 并优化应用程序代码以实现最佳性能。

### <a name="scaling"></a>Scaling

可通过两个不同的方向扩展计算资源:

* *向上*扩展是向单个实例添加更多资源的操作。
* 向*外*扩展是对实例的添加。

![显示向上扩展和向外扩展虚拟机以提高性能能力的图。](../media/scale-up-scale-out.png)

向上扩展与向单个实例添加更多资源 (如 CPU 或内存) 相关。 此实例可以是虚拟机, 也可以是 PaaS 服务。 向实例添加更多容量的操作增加了应用程序可使用的资源, 但有限制。 虚拟机仅限于它们在其上运行的主机的容量, 并且主机本身具有物理限制。 最终, 当您向上扩展实例时, 您可以使用这些限制, 从而限制您向实例添加更多资源的能力。

向后扩展与向服务添加其他实例相关。 这些服务可以是虚拟机或 PaaS 服务, 而不是通过让单个实例更加强大而添加更多容量, 而是通过增加总实例总数增加容量。 向外扩展的优势在于, 如果要将更多的计算机添加到体系结构中, 则可以使用永久扩展。 向之外扩展需要某种类型的负载分配。 这可能是负载平衡器在可用服务器之间分发请求的形式, 或者是用于标识要向其发送请求的活动服务器的服务发现机制。

在这两种情况下, 可以减少资源, 从而将成本优化引入图片中。

### <a name="performance-optimization"></a>性能优化

在优化性能时, 你将看到网络和存储, 以确保性能可接受。 这两种情况都可能会影响应用程序的响应时间。 为你的体系结构选择适当的网络和存储技术将有助于确保你能够为你的消费者提供最佳体验。

性能优化还包括了解应用程序自身的执行方式。 相关系统中的错误、执行不好的代码和瓶颈都可以通过应用程序性能管理工具来发现。 通常, 这些问题可能对最终用户、开发人员和管理员隐藏或进行了模糊处理, 但可能会对应用程序的整体性能产生不利影响。

## <a name="scalability-and-performance-patterns-and-practices"></a>可伸缩性和性能模式和做法

我们来看看一些模式和做法, 可以利用这些模式和做法来增强应用程序的可伸缩性和性能。

### <a name="data-partitioning"></a>数据分区

在许多大规模解决方案中, 数据分为单独的分区, 可以单独管理和访问。 必须仔细选择分区策略, 以最大限度地减少负面影响的优势。 分区有助于提高可伸缩性、减少争用和优化性能。

### <a name="caching"></a>Caching

在体系结构中使用缓存可帮助提高性能。 缓存是一种用于存储经常使用的数据或资产 (网页、图像) 以加快检索速度的机制。 可以在应用程序的不同层使用缓存。 您可以在应用程序服务器和数据库之间使用缓存, 以减少数据检索次数。 您还可以在最终用户和 web 服务器之间使用缓存, 将静态内容放置在离用户更近的时间, 并减少将网页返回给最终用户所花费的时间。 这还具有从数据库或 web 服务器中卸载请求的次要效果, 从而提高了其他请求的性能。

### <a name="autoscaling"></a>缩放

自动缩放是动态分配资源以满足性能要求的过程。 随着工作量的增加, 应用程序可能需要其他资源来维护所需的性能级别并满足服务级别协议 (sla)。 随着需求的 slackens 和不再需要的其他资源, 可以对其进行释放以最大限度地减少成本。

自动缩放利用云托管环境的弹性, 同时简化管理开销。 它减少了操作员持续监视系统性能并做出有关添加或删除资源的决策的需求。

### <a name="decouple-resource-intensive-tasks-as-background-jobs"></a>将大量占用资源的任务作为后台作业分离

许多类型的应用程序都需要独立于用户界面 (UI) 运行的后台任务。 示例包括批处理作业、大量处理任务和长时间运行的进程 (如工作流)。 后台作业可在无需用户交互的情况下执行--应用程序可以启动作业, 然后继续处理来自用户的交互式请求。 这有助于最大限度地减少应用程序 UI 上的负载, 从而可提高可用性并缩短交互响应时间。

### <a name="use-a-messaging-layer-between-services"></a>在服务之间使用消息层

在服务之间添加邮件层可以对性能和可伸缩性有好处。 添加邮件层会为服务之间的请求创建一个缓冲区, 以便在应用程序无法持续的情况下, 请求可以在不出错的情况下继续流动。 当应用程序通过请求工作时, 将按接收顺序对它们进行应答。

### <a name="implement-scale-units"></a>实施扩展单元

作为一个单元进行缩放。 对于每个资源, 确定扩展活动可能对依赖系统产生的影响。 这会使应用的扩展操作更简单, 且不易影响应用程序的负面影响。 例如, 添加 x 个 web 和辅助角色的角色可能需要 y 个额外的队列和 z 个存储帐户数, 以处理这些角色生成的其他工作负载。 缩放单位可以包含 x web 和辅助角色、y 队列和 z 存储帐户。 设计应用程序, 以便通过添加一个或多个缩放单元轻松地进行缩放。

### <a name="performance-monitoring"></a>性能监视

在云中运行的分布式应用程序和服务的性质是构成许多移动部件的复杂软件部分。 在生产环境中, 很重要的一点是, 能够跟踪用户使用系统的方式、跟踪资源使用率, 并通常监视系统的运行状况和性能。 您可以使用此信息作为诊断工具来检测和纠正问题, 还可以帮助发现潜在问题并防止发生问题。

跨应用程序的所有层进行查看, 并确定和修正应用程序中的性能瓶颈。 这些瓶颈可能是应用程序中的内存处理较差, 甚至是将索引添加到数据库中的过程。 它可能是一个迭代过程, 在您缓解一个瓶颈, 然后发现另一个尚未察觉的情况。

通过全面的性能监控方法, 你将能够确定你的体系结构将从中受益的模式和做法的类型。