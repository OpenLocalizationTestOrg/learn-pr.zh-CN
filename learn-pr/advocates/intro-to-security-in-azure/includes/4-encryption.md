对于大多数组织而言, 数据是最有价值和不可替代的资产。 加密充当分层安全策略中的最新和最强的防御行为。 

Contoso 发售知道, 加密是在其离开数据中心并存储在可能会受到攻击或被窃的移动设备上的唯一保护其数据。

## <a name="what-is-encryption"></a>什么是加密？

加密是使数据不可读和不可用的未经授权的查看器的过程。 若要使用或读取加密的数据, 必须对其进行*解密*, 这需要使用密钥。 有两种顶级加密类型:**对称**和**非对称**。

**对称加密**使用相同的密钥来加密和解密数据。 考虑桌面密码管理器应用程序。 输入密码, 并使用你自己的个人密钥加密 (密钥通常是从你的主密码派生的)。 需要检索数据时, 使用相同的密钥, 并对数据进行解密。

**非对称加密**使用公钥和私钥对。 这两个密钥中的任何一个都可以加密, 但单个密钥无法解密其自己的加密数据。 若要进行解密, 您需要配对密钥。 非对称加密用于传输层安全性 (TLS) (在 HTTPS 中使用) 和数据签名等事物。

对称加密和非对称加密都在妥善保护数据方面发挥了作用。 加密通常以两种方式进行: 

1. 静态加密
1. 传输中的加密

## <a name="encryption-at-rest"></a>静态加密

rest 上的数据是存储在物理介质上的数据。 它可以是存储在服务器磁盘上的数据、存储在数据库中的数据, 也可以是存储在存储帐户中的数据。 无论采用何种存储机制, 静态数据的加密都可确保在没有解密的密钥和机密的情况下无法读取存储的数据。 如果攻击者要获取带加密数据的硬驱, 并且没有对加密密钥的访问权限, 则攻击者将无法危害数据, 而不会带来极大的困难。

加密的实际数据在组织的内容、使用情况和重要性方面有所不同。 这可能是由业务开发的商业、知识产权、企业开发的个人数据、企业存储的客户或员工的个人数据以及用于加密数据本身的密钥和机密的关键信息。.

下面的图表显示了已加密的客户数据可能与数据库中的相似之处。

![显示静态加密示例的插图。 数据以仅通过密钥访问的加密表单的形式保存在存储区中。](../media/encryption-at-rest.png)

## <a name="encryption-in-transit"></a>传输中的加密

传输中的数据是主动从一个位置移动到另一个位置 (例如跨 internet 或通过专用网络) 的数据。 安全传输可由多个不同的层处理。 在通过网络发送应用层上的数据之前, 可以通过对其加密来实现。 HTTPS 是中转加密中的应用程序层的一个示例。

您还可以在网络层设置安全通道 (如虚拟专用网络 (VPN)), 以在两个系统之间传输数据。

在传输过程中加密数据保护来自外部观察器的数据, 并提供传输数据的机制, 同时限制暴露风险。

此图显示了该过程。 在这里, 客户数据在通过网络发送时进行加密。 只有收件人具有可将数据解密为可用表单的密钥。

![显示传输过程中加密示例的插图。 数据在传输之前进行加密。 在到达目标后, 再对数据进行解密。](../media/encryption-in-transit.png)

## <a name="encryption-on-azure"></a>Azure 上的加密

让我们看一下 Azure 允许您跨服务加密数据的一些方法。

:::row:::
  :::column:::
    ![表示加密存储的图像](../media/4-encrypt-raw-storage.png)
  :::column-end:::
    :::column span="3":::  
**加密原始存储**

静态数据的**Azure 存储服务加密**可帮助您保护数据, 以满足组织的安全和合规性承诺。 使用此功能, azure 存储平台会在将数据保留到 azure 托管磁盘、azure Blob 存储、azure 文件或 azure 队列存储之前自动对数据进行加密, 并在检索之前对数据进行解密。 对使用服务的应用程序而言, 对加密、静态加密、解密和存储服务加密中的密钥管理的处理是透明的。

  :::column-end:::
:::row-end:::

:::row:::
  :::column:::
    ![表示加密虚拟机的图像](../media/4-encrypt-virtual-machines.png)
  :::column-end:::
    :::column span="3":::  
**加密虚拟机磁盘**

Storage Service encryption 为写入物理磁盘的数据提供低级别加密保护, 但如何保护虚拟机的虚拟硬盘 (vhd)？ 如果恶意攻击者获得了对你的 Azure 订阅的访问权限并获取了虚拟机的 vhd, 你如何确保他们无法访问存储的数据？
  :::column-end:::
:::row-end:::

**Azure 磁盘加密**是一种可帮助您加密 Windows 和 Linux IaaS 虚拟机磁盘的功能。 Azure 磁盘加密利用 Windows 的行业标准 BitLocker 功能和 Linux 的 dm crypt 功能为 OS 和数据磁盘提供卷加密。 此解决方案与 Azure Key Vault 集成, 可帮助您控制和管理磁盘加密密钥和密码 (您可以使用托管服务标识来访问密钥存储库)。

对于 Contoso 货运, 使用 vm 是第一次转向云的情况。 将所有 vhd 加密都是一种非常简单、低影响的方式, 以确保您能够确保贵公司的数据的安全。

:::row:::
  :::column:::
    ![表示加密数据库的图像](../media/4-encrypt-databases.png)
  :::column-end:::
    :::column span="3":::  
**加密数据库**

**透明数据加密 (TDE)** 可帮助保护 azure SQL 数据库和 azure 数据仓库不受恶意活动的威胁。 它对数据库执行实时加密和解密, 关联的备份和事务日志文件不需要对应用程序进行更改。 默认情况下, 将为所有新部署的 Azure SQL 数据库实例启用 TDE。

  :::column-end:::
:::row-end:::

TDE 通过使用名为数据库加密密钥的对称密钥来加密整个数据库的存储。 默认情况下, Azure 为每个逻辑 SQL Server 实例提供唯一的加密密钥, 并处理所有详细信息。 使用 Azure key Vault 中存储的密钥 (如下所示) 也支持带您自己的密钥 (BYOK)。

由于默认情况下启用 TDE, 因此您确信 Contoso 发售对存储在公司数据库中的数据进行了适当的保护。

:::row:::
  :::column:::
    ![表示加密机密的图像](../media/4-encrypt-secrets.png)
  :::column-end:::
    :::column span="3":::  
**加密机密**

我们已发现加密服务都使用密钥来加密和解密数据, 因此我们如何确保密钥本身是安全的？ 公司还可能有需要安全存储的密码、连接字符串或其他敏感信息片段。 在 azure 中, 我们可以使用**azure Key Vault**来保护我们的机密。

  :::column-end:::
:::row-end:::

Azure Key Vault 是用于存储应用程序机密的集中式云服务。 密钥存储库通过将应用程序的机密保存在单个中心位置, 并提供安全访问、权限控制和访问日志功能, 来帮助您控制这些机密。 它适用于各种情况:

- *机密管理*。 您可以使用密钥存储库来安全地存储和严格控制对令牌、密码、证书、*应用程序编程接口*(API) 密钥和其他机密的访问。
- *密钥管理*。 您还可以使用密钥存储库作为密钥管理解决方案。 使用密钥存储库, 可以更轻松地创建和控制用于加密数据的加密密钥。
- *证书管理*。 利用密钥存储库, 您可以更轻松地为您的 Azure 设置、管理和部署公用和私人*安全套接字层/传输层安全性*(SSL/TLS) 证书, 以及内部连接的资源。
- *存储硬件安全模块支持的机密*(hsm)。 机密和密钥可通过软件或 FIPS 140-2 级别2验证的 hsm 进行保护。

使用密钥存储库的好处包括:

- *集中式应用程序密码*。 通过将存储用于应用程序机密, 可以控制分发, 并降低秘密可能意外泄露的机会。
- *安全存储的机密和密钥*。 Azure 使用行业标准算法、密钥长度和 hsm, 并且访问需要正确的身份验证和授权。
- *监视访问和使用*。 使用密钥存储库, 您可以监视和控制对公司密码的访问。
- *简化了对应用程序密码的管理*。 密钥存储库可以更轻松地从公共证书颁发机构 (ca) 注册和续订证书。 您还可以扩展和复制区域中的内容, 并使用标准证书管理工具。
- *与其他 Azure 服务集成*。 你可以将关键保管库与存储帐户、容器注册表、事件中心和更多 Azure 服务集成。

由于可以向 azure AD 标识授予使用 azure Key Vault 密码的访问权限, 因此启用了托管服务标识的应用程序可以自动并无缝地获取所需的密码。

## <a name="summary"></a>摘要

您可能知道, 加密通常是攻击者的最后一层防御, 是用于保护系统的一种重要的层次方法。 Azure 提供了内置功能和服务, 可对数据进行加密和保护以防意外暴露。 对存储在 Azure 服务中的客户数据的保护对于 Microsoft 来说是极其重要的, 并且应包括在任何设计中。 基础服务 (如 azure 存储、azure 虚拟机、azure SQL 数据库和 Azure Key Vault) 可以通过加密来保护环境。
