假定贵公司的贸易合作伙伴的安全策略需要使用高度加密来保护其交易数据。 您可以使用在 Windows 服务器上运行的 B2B 应用程序, 并将数据存储在服务器数据磁盘上。 现在您正在转换到云, 您需要向您的贸易合作伙伴演示存储在 Azure 虚拟机上的数据无法由未经授权的用户、设备或应用程序访问。 您需要决定实现 B2B 数据加密的策略。

您的审核要求规定您的加密密钥是内部托管的, 而不是任何第三方。 此外, 您还需要维护基于 Azure 的服务器的性能和可管理性。 因此, 在实现加密之前, 您需要确保不会对性能造成影响。

## <a name="what-is-encryption"></a>什么是加密？

加密是指将有意义的信息转换为有意义的内容, 如字母和数字的随机序列。 加密过程使用某种形式的**密钥**作为创建加密数据的算法的一部分。 还需要一个密钥来执行解密。 密钥可能是**_对称_** 的, 在其中使用不同密钥的加密和解密或**_非对称_** 密钥使用同一密钥。 后者的一个示例是数字证书中使用的**公钥/私钥**对。

### <a name="symmetric-encryption"></a>对称加密

使用对称密钥的算法 (如高级加密标准 (AES)) 通常比公钥算法快, 并且通常用于保护大型数据存储。 由于只有一个密钥, 因此必须设置过程以防止密钥成为公开已知的。

### <a name="asymmetric-encryption"></a>非对称加密

使用非对称算法时, 只有对的私钥成员才必须保密和安全;顾名思义, 公钥可供任何人使用, 而不会危及加密的数据。 然而, 公钥算法的缺点是, 它们比对称算法要慢得多, 且不能用于加密大量数据。

## <a name="key-management"></a>密钥管理

在 Azure 中, 你的加密密钥可由 Microsoft 或客户管理。 对客户管理的密钥的需求通常来自需要证明遵守 HIPAA 或其他法规的组织。 此类合规性可能要求对密钥的访问进行记录, 并进行定期的关键更改并进行记录。

## <a name="azure-disk-encryption-technologies"></a>Azure 磁盘加密技术

Azure 虚拟机的基于加密的主要磁盘保护技术包括:

- 存储服务加密 (SSE)
- Azure 磁盘加密 (ADE)

### <a name="storage-service-encryption"></a>存储服务加密

azure 存储服务加密 (SSE) 是一个内置于 Azure 中用于保护静态数据的加密服务。 azure 存储平台会在存储到多个存储服务 (包括 Azure 托管磁盘) 之前自动对数据进行加密。 默认情况下, 使用256位 AES 加密启用加密, 并由存储帐户管理员进行管理。

### <a name="azure-disk-encryption"></a>Azure 磁盘加密

Azure 磁盘加密 (ADE) 由 VM 所有者进行管理。 它控制 windows 和 linux vm 控制的磁盘的加密, 在 Linux 虚拟机上使用 windows vm 上的**BitLocker**和**DM Crypt** 。 BitLocker 驱动器加密是一种与操作系统集成的数据保护功能, 可解决数据失窃或因丢失、被盗或无法正确解除授权而被取消授权的计算机泄露的威胁。 同样, DM Crypt 在写入存储之前对 Linux 的静态数据进行加密。

ADE 可确保 vm 磁盘上的所有数据在 Azure 存储中的静态位置进行加密, 并对备份到恢复保管库的虚拟机要求 ADE。

在 ADE 中, 虚拟机在客户控制的密钥和策略下启动。 ADE 与 Azure Key Vault 集成, 以管理这些磁盘加密密钥和密码。

> [!NOTE] 
> ade 不支持对基本层虚拟机进行加密, 也不能将本地密钥管理服务 (KMS) 用于 ADE。

## <a name="when-to-use-encryption"></a>何时使用加密？

当计算机数据在传输过程中 (通过 Internet 或其他网络传输) 以及它位于 rest (保存到存储设备) 时, 其存在风险。 在保护 Azure VM 磁盘上的数据时, rest 方案是主要考虑的问题。 例如, 某个人可能会下载与 Azure VM 关联的虚拟硬盘 (VHD) 文件, 并将其保存在其膝上型电脑上。 如果 vhd 未加密, 则可以在其计算机上安装 vhd 文件的任何人都能够访问 vhd 的内容。

对于操作系统 (OS) 磁盘, 密码等数据会自动加密, 因此即使 VHD 本身没有加密, 也无法轻松访问此类信息。 应用程序也可能会自动对自己的数据进行加密。 但是, 即使使用此类保护, 如果有人恶意企图访问数据磁盘, 并且磁盘本身未加密, 但它们可能会在该应用程序的数据保护中利用任何已知弱点的位置。 使用磁盘加密时, 这种利用方式是不可能的。

Storage Service Encryption (SSE) 是 Azure 本身的一部分, 在使用 SSE 时, 对 VM 磁盘 IO 不会产生显著的性能影响。 带有 SSE 的托管磁盘现在是默认设置, 因此没有理由对其进行更改。 Azure 磁盘加密 (ADE) 使用虚拟机操作系统工具 (BitLocker 和 DM-Crypt), 因此在执行 vm 磁盘上的加密或解密时, VM 本身必须执行一些工作。 除了在某些情况下, 此额外的 VM CPU 活动的影响通常是不可计的。 例如, 如果您有大量占用 CPU 的应用程序, 则可能需要保持未加密操作系统磁盘的情况以最大限度地提高性能。 在这种情况下, 可以将应用程序数据存储在单独的加密数据磁盘上, 从而获得所需的性能而不会降低安全性。

azure 提供了两种用于保护 Azure 虚拟磁盘的补充加密技术。 这些技术、SSE 和 ADE, 在不同层进行加密, 并提供不同的用途。 两者都使用 AES 256 位加密。 同时使用这两种技术提供纵深防御保护, 以防止未经授权访问 Azure 存储和特定 vhd。
