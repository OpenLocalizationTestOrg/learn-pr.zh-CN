N 层体系结构将应用程序划分为**逻辑层**和**物理层**。 **N**表示应用程序拆分成的物理层的数量, 通常与层的数量相关联。 我们可以有两层体系结构 (客户端-服务器), 甚至是五层体系结构, 尽管这很常见, 但通常最好将层数保持在四个或更少。 

我们来谈谈图层和层的组成。

## <a name="what-are-layers"></a>图层是什么？

层以逻辑方式分隔组成应用程序的应用程序代码。 每个层都具有特定职责, 如处理来自用户的请求、运行业务逻辑或处理数据存储。

通过将应用程序分离到这些逻辑层, 我们可独立处理每个层。 这将使应用程序的组件成为模块化的, 并使我们能够更轻松地维护应用程序。 我们可以为每个责任优化应用程序。 处理 web 请求的层将重点放在其主要任务上: 处理 web 请求。 无需关注数据存储或正在运行业务逻辑。 相反, 数据访问层侧重于优化与数据存储区的通信, 以及有关如何向用户呈现数据的不详细信息。 限制将重点放在特定功能上的这一概念称为*分离关注因素*。

下面的图表显示了常见的 N 层体系结构中的层。 每个层处理应用程序的一个方面。 业务层管理用户界面层和数据访问层之间的通信。

![图层的可视化](../media/2-layers.svg)

## <a name="what-are-tiers"></a>什么是层？

层表示在单独的计算资源上物理分离应用程序的各个部分。 通常, 每个**物理**层都运行应用程序的一个**逻辑**层。

将体系结构分成物理层有以下几个好处:

- 可以通过向每个层添加资源来单独扩展应用程序组件。
- 通过添加负载平衡来检测失败的资源并将请求重定向到正常系统, 应用程序可以更具灵活性。
- 应用程序可以通过限制层之间的网络通信并仅允许所需的访问来提高安全性。

层之间的通信应以自上而下的方式进行。 允许每个层与下一层对话, 但通常不允许跳过层。 这样做是为了通过限制层的公开表面区域来提高安全性。

![分层的可视化](../media/2-tiers.svg)

## <a name="the-three-tier-architecture"></a>三层体系结构


在所有 N 层体系结构中, 三层体系结构最常见。 每个层和层的责任和名称因应用程序和业务而异, 但典型的三层应用程序具有: 表示层、应用程序或中间层以及数据层。 这是最常见的 N 层样式, 对于本模块的其余部分, 我们将引用三层模型, 每个层运行一个应用程序的一个层, 并将它们作为分层引用 synonymously。

### <a name="presentation-tier"></a>表示层

表示层通常有利于用户请求。 这些用户可以是最终用户访问网页, 也可以是通过公开 API 对应用程序的公共访问。 此层的重点是用户体验, 提供了类似直观的界面, 并可确保最终用户和应用程序之间的安全通信的内容。

在此层, 您不关心数据本身, 而不是向最终用户呈现的方式。 通常情况下, 此层中不会发生数据处理或数据访问。 这是较低层的责任。

### <a name="application-tier"></a>应用层

应用程序层 (也通常称为中间层) 通常侧重于处理应用程序的业务逻辑。 这可能会处理客户订单、跟踪货物或根据收到的材料更新库存。 此层还负责创建、读取、更新、删除 (CRUD) 针对数据层的活动。 这也是调用相关服务 (如外部 api) 的一个很有用的位置。 

此层不涉及信息如何呈现给用户, 也不关心数据的存储和检索方式。 重点在于实现应用程序已收到的请求所需的业务逻辑。

### <a name="data-tier"></a>数据层

在此层, 重点是在数据存储上。 存储在表、文件或其他媒体中的数据是此层的责任。 此层提供一个接口 (如 t-sql) 来访问数据。 在三层体系结构中, 数据层提供对应用层的数据访问。

该层不侧重于向用户呈现数据的方式, 也不重点关注数据周围的任何逻辑。 存储过程的使用可能在该层中, 但在更高层上应处理数据本身的大多数逻辑。

## <a name="when-to-use-n-tier-architectures"></a>何时使用 N 层体系结构

至此, 我们已经讨论了 N 层体系结构是什么, 我们来讨论何时应使用此样式的体系结构。 考虑以下各项的 N 层体系结构:

- 小型到中型 web 应用程序
- 使用最少的重构将本地应用程序迁移到 Azure
- 利用技能集和开发人员功能, 实现内部部署开发体验

Web 应用程序对于此样式的体系结构来说是一个很有用的用例。 由于这种体系结构样式的复杂性较低, 并且在 web 应用程序中的责任之间通常是自然分离的, 因此 N 层体系结构可能很好地发挥作用。 这些应用程序可以是面向公众的应用程序, 也可以是组织内部使用的业务线应用程序。 对于较小或不太复杂的应用程序, 双层 (客户端/服务器) 体系结构可能足够, 而不是采用单独的演示文稿和应用层进行组合。

N 层体系结构在传统的本地应用程序中很常见, 因此它自然适合将现有工作负载迁移到 Azure。 此样式中的应用程序通常通过最少的重构或修改迁移到 Azure, 从而简化了初始迁移。 在 Azure 上, 您可以利用平台即服务 (PaaS) 服务来进一步改进您的应用程序。

由于这是一种常见的体系结构样式, 因此工程师通常具有更高级别的体验, 并对其进行了熟悉。 通过选择此体系结构, 您可以使用现有技能集部署应用程序, 而无需向上斜向新的体系结构模式进行斜向。 