假设您在一个主要的新闻组织中工作, 报告重大新闻通知。 我们的公司使用遍布全球的 journalists, 这些网络会不断通过 web 门户和移动应用程序发送更新。 然后, 中间层 web 服务层将使用这些警报更新, 并通过几个频道在线发布这些更新。

但是, 当发生全局重大事件时, 系统会丢失警报。 这是一个非常_大_的问题, 因为我们的竞争对手是 "scooped"! 你已手动选择作为公司的首要开发人员, 以确定并解决问题。

中间层提供大量的容量来处理正常负载。 但是, 当多个 journalists 尝试同时上载较大的重大情景时, 会发现服务器日志显示系统超载。 有些编写者 complained 门户无法响应, 其他人认为他们完全失去了其故事。 您已发现在中间层服务器上报告的问题和需求峰值之间的直接关系。

显然, 您需要一种方法来处理这些意外峰值。 您不希望添加更多的网站和中间层 web 服务实例, 因为它们成本高昂, 并且在正常情况下是冗余的。 我们可以动态地加速实例, 但这需要一些时间, 我们会在等待新服务器联机时遇到问题。

您可以通过使用 Azure 队列存储来解决此问题。 存储队列是高性能的邮件缓冲区, 可充当前端组件 ("发生器") 和中间层 ("使用者") 之间的代理。 

我们的前端组件将每个新警报的消息放入队列中。 然后, 中间层从队列中一次检索这些消息以进行处理。 在需要高需求的情况下, 队列的长度可能会增加, 但不会丢失任何情景, 并且应用程序将保持响应。 当需求降回到正常水平时, web 服务将通过队列积压工作来追赶。

我们来了解如何使用 Azure 队列存储来处理高需求, 并提高分布式应用程序的恢复能力。

## <a name="learning-objectives"></a>学习目标

- 创建支持队列的 Azure 存储帐户。
- 使用 c # 和用于 .net 的 Azure 存储客户端库创建队列。
- 使用 c # 和用于 .net 的 Azure 存储客户端库在队列中添加、检索和删除邮件。