你已将所需的客户端库添加到应用程序, 并已准备好连接到你的 Azure 存储帐户。

若要使用存储帐户中的数据, 应用将需要两个数据片段:

1. 一个访问键
1. REST API 终结点

## <a name="security-access-keys"></a>安全访问密钥

每个存储帐户都有两个用于保护存储帐户的唯一_访问密钥_。 如果您的应用程序需要连接到多个存储帐户, 则您的应用程序将需要每个存储帐户的访问密钥。

![显示连接到云中的两个不同存储帐户的应用程序的插图。 每个存储帐户都可通过唯一密钥访问。](../media/6-multiple-accounts.png)

## <a name="rest-api-endpoint"></a>REST API 终结点

除了访问存储帐户的身份验证密钥外, 您的应用程序还需要知道存储服务终结点才能发出 REST 请求。 

REST 终结点是存储帐户_名称_、数据类型和已知域的组合。 例如：

| 数据类型 | 示例终结点 |
|-----------|------------------|
| blob     | `https://[name].blob.core.windows.net/` |
| 队列    | `https://[name].queue.core.windows.net/` |
| Table     | `https://[name].table.core.windows.net/` |
| 附件     | `https://[name].file.core.windows.net/` |

如果你有一个自定义域绑定到 Azure, 则还可以为终结点创建自定义域 URL。

## <a name="connection-strings"></a>连接字符串

在应用程序中处理访问键和终结点 url 的最简单方法是使用**存储帐户连接字符串**。 连接字符串在单个文本字符串中提供所有需要的连接信息。

Azure 存储连接字符串看起来与以下示例类似, 但具有特定存储帐户的访问密钥和帐户名称:

```
DefaultEndpointsProtocol=https;AccountName={your-storage};
   AccountKey={your-access-key};
   EndpointSuffix=core.windows.net
```

## <a name="security"></a>安全性

访问密钥对于提供对存储帐户的访问至关重要, 因此不应将其提供给您不希望对您的存储帐户具有访问权限的任何系统或个人。 访问密钥等效于访问你的计算机的用户名和密码。

通常情况下, 存储帐户连接信息存储在环境变量、数据库或配置文件中。

> [!IMPORTANT]
> 请务必注意, 如果在源代码管理中包含该文件并将其存储在公共存储库中, 则将此信息存储在配置文件中可能会很危险。 这是一个常见错误, 它意味着任何人都可以浏览公用存储库中的源代码并查看您的存储帐户连接信息。

每个存储帐户有两个访问密钥。 这样做的原因是, 在使存储帐户保持安全的安全最佳做法的一部分时, 应定期对密钥进行轮换 (重新生成)。 可以从 azure 门户或 azure CLI/PowerShell 命令行工具执行此过程。

循环键会立即导致原始键值失效, 并将取消对任何未恰当获取密钥的用户的访问权限。 通过对两个密钥的支持, 您可以旋转键, 而不会导致使用它们的应用程序中出现停机。 您的应用程序可以在另一个密钥重新生成时切换到使用备用访问密钥。 如果您有多个使用此存储帐户的应用程序, 它们都应使用相同的密钥来支持此技术。 以下是基本想法:

1. 更新应用程序代码中的连接字符串以引用存储帐户的辅助访问密钥。
2. 使用 Azure 门户或命令行工具为你的存储帐户重新生成主访问密钥。
3. 更新代码中的连接字符串以引用新的主访问密钥。
4. 以相同方式重新生成辅助访问密钥。

> [!TIP]
> 强烈建议您定期旋转访问密钥, 以确保它们保持私密, 就像更改密码一样。 如果您使用的是服务器应用程序中的密钥, 则可以使用**Azure key Vault**存储访问密钥。 主要电子仓库包括支持直接与存储帐户同步并自动轮替密钥。 使用密钥存储库提供了额外的安全层, 因此您的应用程序永远不需要直接使用访问密钥。

### <a name="shared-access-signatures-sas"></a>共享访问签名 (SAS)

访问密钥是对存储帐户的访问进行身份验证的最简单方法。 但是, 它们提供对存储帐户中任何内容的完全访问权限, 类似于计算机上的根密码。

存储帐户提供了一种单独的身份验证机制, 称为_共享访问签名_, 在需要授予有限访问权限的方案中支持过期和受限权限。 你应在允许其他用户读取数据并将数据写入你的存储帐户时使用此方法。 关于本高级主题的文档, 请参阅本模块结尾部分的链接。
