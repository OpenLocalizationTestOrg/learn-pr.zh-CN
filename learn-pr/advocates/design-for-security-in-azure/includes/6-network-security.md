<span data-ttu-id="39276-101">保护网络免受攻击和未经授权的访问是任何体系结构的重要部分。</span><span class="sxs-lookup"><span data-stu-id="39276-101">Securing your network from attacks and unauthorized access is an important part of any architecture.</span></span> <span data-ttu-id="39276-102">在规划云迁移的过程中, Lamna 医疗保健需要花时间来规划自己的网络基础结构, 以确保 it 有适当的网络安全控制来保护其网络基础结构免遭攻击。</span><span class="sxs-lookup"><span data-stu-id="39276-102">As part of the planning for its cloud migration, Lamna Healthcare took the time to plan out its network infrastructure to ensure it had the proper network security controls in place to protect its network infrastructure from attack.</span></span> <span data-ttu-id="39276-103">在这里, 我们将了解网络安全的外观、如何将分层方法集成到您的体系结构中, 以及 Azure 如何帮助您为您的环境提供网络安全。</span><span class="sxs-lookup"><span data-stu-id="39276-103">Here, we'll take a look at what network security looks like, how to integrate a layered approach into your architecture, and how Azure can help you provide network security for your environment.</span></span>

## <a name="what-is-network-security"></a><span data-ttu-id="39276-104">什么是网络安全</span><span class="sxs-lookup"><span data-stu-id="39276-104">What is network security</span></span>

<span data-ttu-id="39276-105">网络安全保护在网络内部和外部的资源的通信。</span><span class="sxs-lookup"><span data-stu-id="39276-105">Network security is protecting the communication of resources within and outside of your network.</span></span> <span data-ttu-id="39276-106">目标是在您的服务和系统中限制网络层的暴露。</span><span class="sxs-lookup"><span data-stu-id="39276-106">The goal is to limit exposure at the network layer across your services and systems.</span></span> <span data-ttu-id="39276-107">通过限制这种公开程度, 可以降低资源受到攻击的可能性。</span><span class="sxs-lookup"><span data-stu-id="39276-107">By limiting this exposure, you decrease the likelihood that your resources can be attacked.</span></span> <span data-ttu-id="39276-108">在重点关注网络安全性的同时, 工作可以重点关注以下方面:</span><span class="sxs-lookup"><span data-stu-id="39276-108">In the focus on network security, efforts can be focused on the following areas:</span></span>

- <span data-ttu-id="39276-109">保护应用程序和 internet 之间的通信流</span><span class="sxs-lookup"><span data-stu-id="39276-109">Securing traffic flow between applications and the internet</span></span>
- <span data-ttu-id="39276-110">保护应用程序之间的通信流</span><span class="sxs-lookup"><span data-stu-id="39276-110">Securing traffic flow amongst applications</span></span>
- <span data-ttu-id="39276-111">保护用户与应用程序之间的通信流</span><span class="sxs-lookup"><span data-stu-id="39276-111">Securing traffic flow between users and the application</span></span>

<span data-ttu-id="39276-112">保护应用程序和 internet 之间的通信流的安全主要是限制网络外部的暴露。</span><span class="sxs-lookup"><span data-stu-id="39276-112">Securing traffic flow between applications and the internet focuses on limiting exposure outside your network.</span></span> <span data-ttu-id="39276-113">网络攻击通常会在网络外部启动, 因此, 通过限制 internet 暴露和保护外围环境, 可以降低受到攻击的风险。</span><span class="sxs-lookup"><span data-stu-id="39276-113">Network attacks will most frequently start outside your network, so by limiting the internet exposure and securing the perimeter, the risk of being attacked can be reduced.</span></span>

<span data-ttu-id="39276-114">确保应用程序之间的通信流侧重于应用程序和其层之间、不同环境之间以及网络中的其他服务之间的数据。</span><span class="sxs-lookup"><span data-stu-id="39276-114">Securing traffic flow amongst applications focuses on  data between applications and their tiers, between different environments, and in other services within your network.</span></span> <span data-ttu-id="39276-115">通过限制这些资源之间的暴露程度, 可以减少受损资源的影响。</span><span class="sxs-lookup"><span data-stu-id="39276-115">By limiting exposure between these resources, you reduce the effect a compromised resource can have.</span></span> <span data-ttu-id="39276-116">这有助于减少网络中的进一步传播。</span><span class="sxs-lookup"><span data-stu-id="39276-116">This can help reduce further propagation within a network.</span></span>

<span data-ttu-id="39276-117">保护用户和应用程序之间的通信流的安全, 重点在于保护最终用户的网络流量。</span><span class="sxs-lookup"><span data-stu-id="39276-117">Securing traffic flow between users and the application focuses on securing the network flow for your end users.</span></span> <span data-ttu-id="39276-118">这将限制您的资源对外部攻击的暴露程度, 并为用户提供使用您的资源的安全机制。</span><span class="sxs-lookup"><span data-stu-id="39276-118">This limits the exposure your resources have to outside attacks, and provides a secure mechanism for users to utilize your resources.</span></span> 

## <a name="a-layered-approach-to-network-security"></a><span data-ttu-id="39276-119">网络安全的分层方法</span><span class="sxs-lookup"><span data-stu-id="39276-119">A layered approach to network security</span></span>

<span data-ttu-id="39276-120">整个本模块中的公用线程都采用了分层方法来实现安全, 在网络层, 这种方法是没有区别的。</span><span class="sxs-lookup"><span data-stu-id="39276-120">A common thread throughout this module has been taking a layered approach to security, and this approach is no different at the network layer.</span></span> <span data-ttu-id="39276-121">仅专注于保护网络外围, 或将重点放在网络内的服务之间的网络安全上是不够的。</span><span class="sxs-lookup"><span data-stu-id="39276-121">It's not enough to just focus on securing the network perimeter, or focusing on the network security between services inside a network.</span></span> <span data-ttu-id="39276-122">分层方法提供了多个级别的保护, 因此, 如果攻击者通过一个层, 则有进一步的保护来限制进一步的攻击。</span><span class="sxs-lookup"><span data-stu-id="39276-122">A layered approach provides multiple levels of protection, so that if an attacker gets through one layer, there are further protections in place to limit further attack.</span></span>

<span data-ttu-id="39276-123">让我们来看看 Azure 如何为分层方法提供用于保护网络空间的工具。</span><span class="sxs-lookup"><span data-stu-id="39276-123">Let's take a look at how Azure can provide the tools for a layered approach to securing your network footprint.</span></span>

### <a name="internet-protection"></a><span data-ttu-id="39276-124">Internet 保护</span><span class="sxs-lookup"><span data-stu-id="39276-124">Internet protection</span></span>

<span data-ttu-id="39276-125">如果我们在网络外围启动, 我们将重点介绍如何限制和消除来自 internet 的攻击。</span><span class="sxs-lookup"><span data-stu-id="39276-125">If we start on the perimeter of the network, we're focused on limiting and eliminating attacks from the internet.</span></span> <span data-ttu-id="39276-126">开始时的首要位置是评估面向 internet 的资源, 并在必要时仅允许入站和出站通信。</span><span class="sxs-lookup"><span data-stu-id="39276-126">A great first place to start is to assess the resources that are internet-facing, and only allow inbound and outbound communication where necessary.</span></span> <span data-ttu-id="39276-127">确定允许任何类型的入站网络流量的所有资源, 并确保它们是必需的, 并且仅限于所需的端口/协议。</span><span class="sxs-lookup"><span data-stu-id="39276-127">Identify all resources that are allowing inbound network traffic of any type, and ensure they are necessary and restricted to only the ports/protocols required.</span></span> <span data-ttu-id="39276-128">Azure 安全中心是查找此信息的理想位置, 因为它将标识未与之关联的网络安全组 (NSG) 的面向 internet 的资源, 以及防火墙后面不受保护的资源。</span><span class="sxs-lookup"><span data-stu-id="39276-128">Azure Security Center is a great place to look for this information, as it will identify internet-facing resources that don't have network security groups (NSG) associated with them, as well as resources that are not secured behind a firewall.</span></span>

<span data-ttu-id="39276-129">若要在外围提供入站保护, 有几种方法可以实现此目的。</span><span class="sxs-lookup"><span data-stu-id="39276-129">To provide inbound protection at the perimeter, there are a couple of ways to do this.</span></span> <span data-ttu-id="39276-130">应用程序网关是第7层负载平衡器, 它还包含 web 应用程序防火墙 (WAF), 用于为您的基于 HTTP 的服务提供高级安全性。</span><span class="sxs-lookup"><span data-stu-id="39276-130">Application Gateway is a Layer 7 load balancer that also includes a web application firewall (WAF) to provide advanced security for your HTTP-based services.</span></span> <span data-ttu-id="39276-131">WAF 基于 OWASP 3.0 或2.2.9 核心规则集的规则, 并提供了针对常见漏洞 (如跨站点脚本和 SQL 注入) 的保护。</span><span class="sxs-lookup"><span data-stu-id="39276-131">The WAF is based on rules from the OWASP 3.0 or 2.2.9 core rule sets, and provides protection from commonly-known vulnerabilities such as cross-site scripting and SQL injection.</span></span>

![图中显示了单个应用程序网关筛选对位于两个不同站点的虚拟机发出的所有外部请求。](../media/appgw-waf.png)

<span data-ttu-id="39276-134">为了保护非基于 HTTP 的服务或提高自定义项, 可以使用网络虚拟设备 (NVA) 来保护网络资源。</span><span class="sxs-lookup"><span data-stu-id="39276-134">For protection of non-HTTP-based services or for increased customization, network virtual appliances (NVA) can be used to secure your network resources.</span></span> <span data-ttu-id="39276-135">NVAs 类似于在本地网络中可能会发现的防火墙装置, 并且可从许多最受欢迎的网络安全供应商处获得。</span><span class="sxs-lookup"><span data-stu-id="39276-135">NVAs are similar to firewall appliances you might find in on-premises networks, and are available from many of the most popular network security vendors.</span></span> <span data-ttu-id="39276-136">NVAs 可以为需要它的应用程序提供更好的安全性自定义, 但可能会增加复杂性, 因此建议您仔细考虑要求。</span><span class="sxs-lookup"><span data-stu-id="39276-136">NVAs can provide greater customization of security for those applications that require it, but can come with increased complexity, so careful consideration of requirements is advised.</span></span>

<span data-ttu-id="39276-137">向 internet 公开的任何资源都存在受到拒绝服务攻击的风险。</span><span class="sxs-lookup"><span data-stu-id="39276-137">Any resource exposed to the internet is at risk of being attacked by a denial-of-service attack.</span></span> <span data-ttu-id="39276-138">这些类型的攻击试图通过发送这么多请求资源变慢或不响应, 从而导致网络资源严重不足。</span><span class="sxs-lookup"><span data-stu-id="39276-138">These types of attacks attempt to overwhelm a network resource by sending so many requests that the resource becomes slow or unresponsive.</span></span> <span data-ttu-id="39276-139">为了缓解这些攻击, azure DDoS 提供了跨所有 Azure 服务的基本保护, 并增强了保护以进一步为你的资源自定义。</span><span class="sxs-lookup"><span data-stu-id="39276-139">To mitigate these attacks, Azure DDoS provides basic protection across all Azure services and enhanced protection for further customization for your resources.</span></span> <span data-ttu-id="39276-140">DDoS 保护会阻止攻击流量, 并将其余流量转发到其预期的目标。</span><span class="sxs-lookup"><span data-stu-id="39276-140">DDoS protection blocks attack traffic and forwards the remaining traffic to its intended destination.</span></span> <span data-ttu-id="39276-141">在几分钟的攻击检测中, 您会收到使用 Azure Monitor 指标的通知。</span><span class="sxs-lookup"><span data-stu-id="39276-141">Within a few minutes of attack detection, you are notified using Azure Monitor metrics.</span></span>

![显示在虚拟网络和外部用户请求之间安装了 Azure DDoS 保护的说明。](../media/ddos.png)

### <a name="virtual-network-security"></a><span data-ttu-id="39276-144">虚拟网络安全</span><span class="sxs-lookup"><span data-stu-id="39276-144">Virtual network security</span></span>

<span data-ttu-id="39276-145">在虚拟网络 (VNet) 中, 将资源之间的通信限制为仅需要的内容非常重要。</span><span class="sxs-lookup"><span data-stu-id="39276-145">Once inside a virtual network (VNet), it's important to limit communication between resources to only what is required.</span></span>

<span data-ttu-id="39276-146">对于虚拟机之间的通信, 网络安全组 (NSG) 是限制不必要的通信的关键部分。</span><span class="sxs-lookup"><span data-stu-id="39276-146">For communication between virtual machines, network security groups (NSG) are a critical piece to restrict unnecessary communication.</span></span> <span data-ttu-id="39276-147">NSGs 在层 3 & 4 处运行, 并提供与网络接口和子网之间允许和拒绝的通信的列表。</span><span class="sxs-lookup"><span data-stu-id="39276-147">NSGs operate at layers 3 & 4, and provide a list of allowed and denied communication to and from network interfaces and subnets.</span></span> <span data-ttu-id="39276-148">NSGs 可完全自定义, 并使您能够完全锁定与虚拟机之间的网络通信。</span><span class="sxs-lookup"><span data-stu-id="39276-148">NSGs are fully customizable, and give you the ability to fully lock down network communication to and from your virtual machines.</span></span> <span data-ttu-id="39276-149">通过使用 NSGs, 您可以在环境、层和服务之间隔离应用程序。</span><span class="sxs-lookup"><span data-stu-id="39276-149">By using NSGs, you can isolate applications between environments, tiers, and services.</span></span>

![<span data-ttu-id="39276-150">该图显示了网络安全组的使用情况, 以限制后端和中端与 Internet 的直接通信。</span><span class="sxs-lookup"><span data-stu-id="39276-150">An illustration showing usage of network security group to restrict backend and mid-tier from communicating directly with the Internet.</span></span> <span data-ttu-id="39276-151">Internet 请求由前端接收, 然后将其传递到中端。</span><span class="sxs-lookup"><span data-stu-id="39276-151">The Internet requests are received by the frontend, which then passes them to the mid-tier.</span></span> <span data-ttu-id="39276-152">中端与后端通信。</span><span class="sxs-lookup"><span data-stu-id="39276-152">The mid-tier communicates with the backend.</span></span> ](../media/azure-network-security.png)

<span data-ttu-id="39276-153">若要隔离 Azure 服务以仅允许来自虚拟网络的通信, 请使用 VNet 服务终结点。</span><span class="sxs-lookup"><span data-stu-id="39276-153">To isolate Azure services to only allow communication from virtual networks, use VNet service endpoints.</span></span> <span data-ttu-id="39276-154">使用服务终结点, 可以将 Azure 服务资源固定到虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="39276-154">With service endpoints, Azure service resources can be secured to your virtual network.</span></span> <span data-ttu-id="39276-155">通过将公用 internet 访问与虚拟网络保护, 使服务资源安全, 可通过完全删除对资源的公共 internet 访问来提高安全性, 并且仅允许来自你的虚拟网络的流量。</span><span class="sxs-lookup"><span data-stu-id="39276-155">Securing service resources to a virtual network provides improved security by fully removing public internet access to resources, and allowing traffic only from your virtual network.</span></span> <span data-ttu-id="39276-156">这样可以减少环境的攻击面, 降低限制 VNet 和 Azure 服务之间的通信所需的管理, 并为此通信提供最佳路由。</span><span class="sxs-lookup"><span data-stu-id="39276-156">This reduces the attack surface for your environment, reduces the administration required to limit communication between your VNet and Azure services, and provides optimal routing for this communication.</span></span>

### <a name="network-integration"></a><span data-ttu-id="39276-157">网络集成</span><span class="sxs-lookup"><span data-stu-id="39276-157">Network integration</span></span>

<span data-ttu-id="39276-158">通常情况下, 需要集成现有网络基础结构以提供来自本地网络的通信, 或者在 Azure 中提供服务之间的改进通信。</span><span class="sxs-lookup"><span data-stu-id="39276-158">It's common to have existing network infrastructure that needs to be integrated to provide communication from on-premises networks, or to provide improved communication between services in Azure.</span></span> <span data-ttu-id="39276-159">有几种主要方法可以处理这种集成并提高网络安全性。</span><span class="sxs-lookup"><span data-stu-id="39276-159">There are a few key ways to handle this integration and improve the security of your network.</span></span>

<span data-ttu-id="39276-160">虚拟专用网络 (VPN) 连接是在网络之间建立安全通信通道的一种常用方法, 在使用 Azure 上的虚拟网络时, 这是不相同的。</span><span class="sxs-lookup"><span data-stu-id="39276-160">Virtual private network (VPN) connections are a common way of establishing secure communication channels between networks, and this is no different when working with virtual networking on Azure.</span></span> <span data-ttu-id="39276-161">azure vnet 和本地 VPN 设备之间的连接是在网络和 Azure 上的虚拟机之间提供安全通信的绝佳方式。</span><span class="sxs-lookup"><span data-stu-id="39276-161">Connection between Azure VNets and an on-premises VPN device is a great way to provide secure communication between your network and your virtual machines on Azure.</span></span>

<span data-ttu-id="39276-162">若要在网络和 Azure 之间提供专用的专用连接, 可以使用 ExpressRoute。</span><span class="sxs-lookup"><span data-stu-id="39276-162">To provide a dedicated, private connection between your network and Azure, you can use ExpressRoute.</span></span> <span data-ttu-id="39276-163">ExpressRoute 允许你通过连接提供程序加速的专用连接将本地网络扩展到 Microsoft 云。</span><span class="sxs-lookup"><span data-stu-id="39276-163">ExpressRoute lets you extend your on-premises networks into the Microsoft cloud over a private connection facilitated by a connectivity provider.</span></span> <span data-ttu-id="39276-164">使用 ExpressRoute, 可以建立与 microsoft 云服务 (如 microsoft Azure、Office 365 和 Dynamics 365) 的连接。</span><span class="sxs-lookup"><span data-stu-id="39276-164">With ExpressRoute, you can establish connections to Microsoft cloud services, such as Microsoft Azure, Office 365, and Dynamics 365.</span></span> <span data-ttu-id="39276-165">这将通过使用专用线路而不是通过 internet 发送此流量来提高本地通信的安全性。</span><span class="sxs-lookup"><span data-stu-id="39276-165">This improves the security of your on-premises communication by sending this traffic over the private circuit instead of over the internet.</span></span> <span data-ttu-id="39276-166">您无需通过 internet 允许最终用户访问这些服务, 并且可以通过设备发送此流量以进行进一步的流量检查。</span><span class="sxs-lookup"><span data-stu-id="39276-166">You don't need to allow access to these services for your end users over the internet, and you can send this traffic through appliances for further traffic inspection.</span></span>

![显示与 Azure 资源连接客户网络的 ExpressRoute 电路的体系结构图。](../media/expressroute-connection-overview.png)

<span data-ttu-id="39276-168">为轻松地在 Azure 中集成多个 vnet, VNet 对等互连在指定的 vnet 之间建立直接连接。</span><span class="sxs-lookup"><span data-stu-id="39276-168">To easily integrate multiple VNets in Azure, VNet peering establishes a direct connection between designated VNets.</span></span> <span data-ttu-id="39276-169">建立后, 您可以使用 NSGs 在资源之间以与保证 VNet 中的资源相同的方式提供资源之间的隔离。</span><span class="sxs-lookup"><span data-stu-id="39276-169">Once established, you can use NSGs to provide isolation between resources in the same way you secure resources within a VNet.</span></span> <span data-ttu-id="39276-170">此集成使您能够在任何 peered vnet 中提供相同的基本安全层。</span><span class="sxs-lookup"><span data-stu-id="39276-170">This integration gives you the ability to provide the same fundamental layer of security across any peered VNets.</span></span> <span data-ttu-id="39276-171">仅允许直接连接的 vnet 之间的通信。</span><span class="sxs-lookup"><span data-stu-id="39276-171">Communication is only allowed between directly connected VNets.</span></span>

## <a name="network-security-at-lamna-healthcare"></a><span data-ttu-id="39276-172">Lamna 保健中的网络安全</span><span class="sxs-lookup"><span data-stu-id="39276-172">Network security at Lamna Healthcare</span></span>

<span data-ttu-id="39276-173">Lamna 保健利用了许多服务来构建安全的网络基础结构。</span><span class="sxs-lookup"><span data-stu-id="39276-173">Lamna Healthcare has taken advantage of many of these services to build out a secure network infrastructure.</span></span> <span data-ttu-id="39276-174">默认情况下拒绝资源之间的通信, 并且仅在需要时允许。</span><span class="sxs-lookup"><span data-stu-id="39276-174">Communication between resources is denied by default, and allowed only when required.</span></span> <span data-ttu-id="39276-175">仅对需要它的服务启用来自 internet 的入站连接;不允许 RDP 和 SSH 从 internet 终结点 (仅限来自受信任的内部资源)。</span><span class="sxs-lookup"><span data-stu-id="39276-175">Inbound connectivity from the internet is enabled only for services that require it; RDP and SSH are not permitted from internet endpoints, only from trusted internal resources.</span></span>

<span data-ttu-id="39276-176">为了保护其面向 internet 的 web 服务的安全, 它们将它们放在启用了 WAF 的应用程序网关后面。</span><span class="sxs-lookup"><span data-stu-id="39276-176">To secure their internet-facing web services, they place them behind Application Gateways with WAF enabled.</span></span> <span data-ttu-id="39276-177">对于在虚拟机上运行的服务以及应用服务, 这都是如此。</span><span class="sxs-lookup"><span data-stu-id="39276-177">This is true both for services running on virtual machines as well as on App Service.</span></span> <span data-ttu-id="39276-178">通过使用应用程序网关, 他们可以抵御许多常见漏洞的攻击。</span><span class="sxs-lookup"><span data-stu-id="39276-178">By using Application Gateways, they have protection from many of the common vulnerabilities.</span></span>

<span data-ttu-id="39276-179">它们启用了 DDoS 标准, 以针对其面向 internet 的终结点提供对拒绝服务攻击的保护。</span><span class="sxs-lookup"><span data-stu-id="39276-179">They have DDoS standard enabled, to provide protection for their internet-facing endpoints from denial-of-service attacks.</span></span>

<span data-ttu-id="39276-180">通过使用 NSGs, 它们可以完全隔离应用程序服务和环境之间的通信。</span><span class="sxs-lookup"><span data-stu-id="39276-180">Through the use of NSGs, they are able to fully isolate communication between application services and between environments.</span></span> <span data-ttu-id="39276-181">它们只允许在环境中的服务之间进行必要的通信, 并且不允许在生产和非生产环境之间进行任何访问。</span><span class="sxs-lookup"><span data-stu-id="39276-181">They only allow the necessary communication between services within an environment, and no access is allowed between production and non-production environments.</span></span>

<span data-ttu-id="39276-182">若要在 Azure 中的最终用户和应用程序之间提供专用连接, 他们已使用与本地网络的连接性预配的 ExpressRoute 电路。</span><span class="sxs-lookup"><span data-stu-id="39276-182">To provide dedicated connectivity between their end users and applications in Azure, they have provisioned an ExpressRoute circuit with connectivity to their on-premises network.</span></span> <span data-ttu-id="39276-183">这将使它们的流量保持与 internet 的 azure 断开, 并为 azure 中的服务提供专用连接, 以便与本地系统保持通信。</span><span class="sxs-lookup"><span data-stu-id="39276-183">This keeps their traffic to Azure off the internet and a private connection for their services in Azure to communicate with systems remaining on-premises.</span></span>

<span data-ttu-id="39276-184">通过此方法, Lamna 医疗保健已利用 Azure 服务在其网络基础结构的多个层提供安全性。</span><span class="sxs-lookup"><span data-stu-id="39276-184">With this approach, Lamna Healthcare has leveraged Azure services to provide security at multiple layers of their network infrastructure.</span></span>

## <a name="summary"></a><span data-ttu-id="39276-185">摘要</span><span class="sxs-lookup"><span data-stu-id="39276-185">Summary</span></span>

<span data-ttu-id="39276-186">网络安全的分层方法有助于降低通过基于网络的攻击暴露的风险。</span><span class="sxs-lookup"><span data-stu-id="39276-186">A layered approach to network security helps reduce your risk of exposure through network-based attacks.</span></span> <span data-ttu-id="39276-187">Azure 提供了多种服务和功能, 以保护面向 internet 的资源、内部资源和本地网络之间的通信。</span><span class="sxs-lookup"><span data-stu-id="39276-187">Azure provides several services and capabilities to secure your internet-facing resource, internal resources, and communication between on-premises networks.</span></span> <span data-ttu-id="39276-188">利用这些功能, 可以在 Azure 上创建安全解决方案。</span><span class="sxs-lookup"><span data-stu-id="39276-188">These features make it possible to create secure solutions on Azure.</span></span>