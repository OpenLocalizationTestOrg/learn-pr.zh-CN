数据是组织最有价值和不可替代的资产, 加密作为分层安全策略中的最新和最强的防御行为。 作为医疗保健提供商, Lamna 医疗保健存储大量敏感数据。 他们最近遇到一种泄露, 暴露了患者的未加密敏感数据, 现在完全意识到他们的数据保护功能存在缺口。 他们希望了解如何使用更好的加密来保护自己及其患者不受此类事件的攻击。 在这里, 我们将了解加密是什么、如何对数据加密以及哪些加密功能在 Azure 上可用。

## <a name="what-is-encryption"></a>什么是加密？

加密是将数据变为不可读和不可用的过程。 若要使用或读取加密的数据, 必须对其进行*解密*, 这需要使用密钥。 有两种顶级加密类型:**对称**和**非对称**。

对称加密使用相同的密钥来加密和解密数据。 考虑桌面密码管理器应用程序。 输入密码, 并使用你自己的个人密钥加密 (密钥通常是从你的主密码派生的)。 需要检索数据时, 将使用相同的密钥, 并对数据进行解密。

非对称加密使用公钥和私钥对。 这两个密钥都可以加密, 但不能解密其自己的加密数据。 若要进行解密, 您需要配对密钥。 不对称加密用于 TLS (在 https 中使用) 和数据签名等内容。

对称加密和非对称加密都在妥善保护数据方面发挥了作用。 

加密通常以两种方式进行: 静态加密和传输中的加密。

### <a name="encryption-at-rest"></a>静态加密

rest 上的数据是存储在物理介质上的数据。 它可以是存储在服务器磁盘上的数据、存储在数据库中的数据, 也可以是存储在存储帐户中的数据。 无论采用何种存储机制, 静态数据的加密都可确保在没有解密的密钥和机密的情况下无法读取存储的数据。 如果攻击者使用加密的数据获取硬盘, 并且没有对加密密钥的访问权限, 则攻击者将无法危害数据, 而不会带来极大的困难。 在这种情况下, 攻击者必须尝试对加密数据进行攻击, 这比在硬盘上访问未加密的数据要复杂得多, 并且资源消耗更多。

加密的实际数据在组织的内容、使用情况和重要性方面有所不同。 这可能是财务信息对业务、企业开发的知识产权、业务所存储的有关客户或员工的个人数据, 甚至是用于数据本身加密的密钥和机密.

![显示静态加密示例的插图。](../media/encryption-at-rest.png)

### <a name="encryption-in-transit"></a>传输中的加密

传输中的数据是主动从一个位置移动到另一个位置 (例如跨 internet 或通过专用网络) 的数据。 通过在网络中发送数据之前对数据进行加密, 或者设置安全通道以在两个系统之间传输未加密的数据, 可以处理安全传输。 在传输过程中加密数据保护来自外部观察器的数据, 并提供传输数据的机制, 同时限制暴露风险。 

![显示传输过程中加密示例的插图。 数据在传输之前进行加密。 在到达目标后, 再对数据进行解密。](../media/encryption-in-transit.png)

## <a name="identify-and-classify-data"></a>标识和分类数据

让我们重新讨论医疗保健试图解决的问题 Lamna。 它们以前有一个公开敏感数据的事件, 因此它们的加密方式与加密方式之间存在差距。 他们需要先确定和分类所存储的数据类型, 并将其与数据存储的业务和法规要求相一致。 对此数据进行分类的好处是, 因为它与组织、其客户或合作伙伴公开的影响有关。 下面是分类的示例:

|数据分类|说明|示例|
|---|---|---|
|受限|如果暴露、更改或删除, 被分类为受限制的数据会带来重大风险。 此数据需要强大的保护级别。 |包含社会保险号、信用卡号、个人健康记录的数据|
|Private| 如果公开、更改或删除, 归为私密的数据会带来中等风险。 此数据需要合理的保护级别。 未分类为 "受限" 或 "公共" 的数据将归为 "私人"。  |包含地址、电话号码、学术记录、客户购买记录等信息的个人记录|
|公| 分类为公共的数据在公开、更改或删除时不会带来任何风险。 此数据不需要任何保护。 |公共财务报告、公共策略、适用于客户的产品文档|

通过对所存储的数据类型编制清单, 可以更好地了解可能存储敏感数据的位置, 以及现有加密可能发生或不会发生的情况。

全面了解适用于组织存储数据的法规和业务要求也很重要。 组织必须遵守的法规要求通常会导致数据加密要求的大部分。 对于 Lamna 医疗保健, 它们存储的敏感数据位于健康保险便携性和责任法案 (HIPAA) 下, 其中包含有关如何处理和存储患者数据的要求。 其他行业可能属于不同的法规要求。 金融机构可以存储支付卡行业 (PCI) 标准范围内的帐户信息。 在欧盟开展生意的组织可能属于一般数据保护条例 (GDPR), 后者定义了对欧盟的个人数据的处理。 业务要求也可能规定, 任何可能会使组织面临包含竞争信息的财务风险的数据都需要加密。

一旦您定义了数据并定义了要求后, 就可以利用各种工具和技术在体系结构中实施和强制实施加密。

## <a name="encryption-on-azure"></a>Azure 上的加密

让我们看一下 Azure 允许您跨服务加密数据的一些方法。

### <a name="encrypting-raw-storage"></a>加密原始存储

静态数据的 Azure 存储服务加密可帮助您保护数据, 以满足组织的安全和合规性承诺。 使用此功能, azure 存储平台会在将数据保留到 azure 托管磁盘、azure Blob 存储、azure 文件或 azure 队列存储之前自动对数据进行加密, 并在检索之前对数据进行解密。 对使用服务的应用程序而言, 对加密、静态加密、解密和存储服务加密中的密钥管理的处理是透明的。

对于 Lamna 医疗保健, 这意味着, 无论用户何时使用支持存储服务加密的服务, 其数据都会在存储的物理媒体上进行加密。 在不太可能会获得对物理磁盘的访问权限的情况下, 数据将不可读, 因为它已加密为写入物理磁盘。

### <a name="encrypting-virtual-machines"></a>加密虚拟机

Storage Service encryption 为写入物理磁盘的数据提供低级别加密保护, 但如何保护虚拟机的虚拟硬盘 (VHD)？ 如果恶意攻击者获取了对你的 Azure 订阅的访问权限, 并泄露虚拟机的 vhd, 如何确保他们无法访问存储在 VHD 上的数据？

Azure 磁盘加密 (ADE) 是一种帮助您加密 Windows 和 Linux IaaS 虚拟机磁盘的功能。 ADE 利用 Windows 的行业标准 BitLocker 功能和 Linux 的 DM Crypt 功能为 OS 和数据磁盘提供卷加密。 此解决方案与 azure Key Vault 集成, 可帮助您控制和管理磁盘加密密钥和密码 (您可以使用 azure 服务的托管标识访问密钥存储库)。

 Lamna 医疗保健可以将 ADE 应用到其虚拟机, 以确保 vhd 上存储的任何数据都受其组织和合规性要求的保护。 由于启动磁盘也进行了加密, 因此可以控制和审核使用率。

### <a name="encrypting-databases"></a>加密数据库

Lamna 医疗保健中部署了多个存储需要额外保护的数据的数据库。 他们已将许多数据库移动到 Azure SQL 数据库, 并希望确保其数据在数据库中进行加密。 如果数据文件、日志文件或备份文件被盗, 他们希望确保无法在不访问加密密钥的情况下读取这些数据文件。

透明数据加密 (TDE) 可帮助保护 azure SQL 数据库和 azure 数据仓库不受恶意活动的威胁。 它对数据库执行实时加密和解密, 关联的备份和事务日志文件不需要对应用程序进行更改。 默认情况下, 将为所有新部署的 Azure SQL 数据库启用 TDE。

TDE 通过使用名为数据库加密密钥的对称密钥来加密整个数据库的存储。 默认情况下, Azure 会为每个逻辑 SQL Server 提供唯一的加密密钥, 并处理所有详细信息。 在 Azure key Vault 中存储的密钥也支持带-自己的密钥。

由于 TDE 在默认情况下处于启用状态, 因此 Lamna 保健可以确信他们已为存储在其数据库中的数据设置适当的保护。

### <a name="encrypting-secrets"></a>加密机密

我们已发现加密服务都使用密钥来加密和解密数据, 因此我们如何确保密钥本身是安全的？ Lamna 医疗保健可能还包含需要安全存储的密码、连接字符串或其他敏感信息片段。

Azure Key Vault 是一项云服务, 可用作安全的机密存储。 通过密钥存储库, 可以创建多个称为 "保管库" 的安全容器。 这些保管库由硬件安全模块 (hsm) 支持。 通过集中应用程序机密的存储, 保管库有助于降低意外丢失安全信息的机率。 主要电子仓库还控制并记录对存储在其中的任何内容的访问。 Azure Key Vault 可以处理请求和更新传输层安全性 (TLS) 证书, 从而提供强健的证书生命周期管理解决方案所需的功能。 密钥存储库旨在支持任何类型的机密。 这些机密可以是密码、数据库凭据、API 密钥和证书。

由于可以向 azure AD 标识授予使用 azure Key Vault 密码的访问权限, 因此使用 azure 服务的托管身份的应用程序可以自动并无缝地获取所需的密码。

Lamna 医疗保健可以使用关键保管库来存储其所有敏感的应用程序信息, 包括它们用于保护系统之间的通信的 TLS 证书。

## <a name="encryption-at-lamna-healthcare"></a>Lamna 保健中的加密

Lamna 医疗保健已完成其存储的所有数据的标识和分类过程。 他们已将这些分类与法规和业务要求相匹配, 并意识到它们拥有的数据远不止要加密。 他们已对存储敏感数据的所有虚拟机进行加密, 并对其存储在 blob 存储中的所有敏感患者信息进行加密。 在其所有数据库上启用 TDE, 因此它们的关系数据库满足其加密要求, 而不考虑分类。 它们在组织中也有效使用密钥存储库来存储应用程序可能需要进行操作的所有证书和凭据信息。

## <a name="summary"></a>摘要

加密通常是攻击者的最后一层防御, 是用于保护体系结构的一种重要的层次方法。 Azure 提供了内置功能和服务, 可对数据进行加密和保护以防意外暴露。 对存储在 Azure 服务中的客户数据的保护对于 Microsoft 来说是极其重要的, 并且应包括在任何体系结构设计中。 基础服务 (如 azure 存储、azure 虚拟机、azure SQL 数据库和 Azure Key Vault) 可以通过加密来保护环境。
