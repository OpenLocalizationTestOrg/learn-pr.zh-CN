应用程序可能需要将一系列数据更新组合在一起, 因为对一段数据所做的更改需要对另一数据片段进行更改。 使用事务可以对这些更新进行分组, 以便在一系列更新中的一个事件失败时, 可以回滚或撤消整个系列。 

例如, 作为在线零售商, 你可以使用交易记录进行订单和付款验证的放置。 对相关事件进行分组可确保在收到经批准的付款形式之前, 不会降低库存水平。

在这里, 你将了解有关事务以及它们是否是你的数据所必需的。

## <a name="what-is-a-transaction"></a>什么是事务？

事务是一组同时执行的数据库操作的逻辑组。

若要询问自己是否需要在您的应用程序中使用事务, 您需要了解以下问题: 对数据集中的一段数据的更改是否会影响其他数据？ 如果答案是肯定的, 则需要支持您的数据库服务中的事务。

事务通常由一组四个要求 (称为 "ACID 保证") 定义。 ACID 代表原子性、一致性、隔离和持续性:

- 原子性意味着执行事务中的所有操作, 或不执行任何操作。
- 一致性可确保在事务发生中途的情况下, 不会将部分数据留给更新。 在整个董事会中, 事务始终应用或根本不应用。
- 隔离可确保一个事务不受另一个事务的影响。
- 耐久性是指在系统中永久保存由于事务所做的更改。 已提交的数据由系统保存, 这样即使在发生故障和系统重启, 数据也能以正确的状态提供。

当数据库提供 ACID 保证时, 这些原则将以一致的方式应用于任何事务。

## <a name="oltp-vs-olap"></a>OLTP vs OLAP

事务性数据库通常称为 OLTP (联机事务处理) 系统。 OLTP 系统通常支持大量用户、快速响应时间和处理大量数据。 它们也具有高可用性 (这意味着它们的停机时间非常少), 通常处理小型事务或相对简单的事务。

相反, OLAP (联机分析处理) 系统通常支持较少的用户、响应时间较低, 并且通常会处理大型和复杂的事务。

术语 OLTP 和 OLAP 不会像过去那样频繁使用, 但了解它们可以更轻松地对应用程序的需求进行分类。 

现在, 你熟悉了事务、OLTP 和 OLAP, 我们来演练一下在线零售方案中的每个数据集, 并确定对交易记录的需求。

## <a name="product-catalog-data"></a>产品目录数据

产品目录数据应存储在事务性数据库中。 当用户下订单并验证付款时, 应更新该项目的库存。 同样, 如果客户的信用卡被拒绝, 应回滚订单, 并且库存不应更新。 这些关系都需要事务。

## <a name="photos-and-videos"></a>照片和视频

产品目录中的照片和视频不需要事务性支持。 仅当进行更新或添加新文件时, 才会更改这些文件。 尽管图像和实际产品数据之间存在关系, 但实际上并不是事务性的。

## <a name="business-data"></a>业务数据

对于业务数据, 因为所有数据都是历史记录且不变, 所以不需要事务性支持。 处理数据的业务分析员也有独特的需求, 因为它们通常需要在查询中处理聚合, 以便它们可以处理其他较小数据点的总数。

## <a name="summary"></a>摘要

确保您的数据处于正确状态并不总是简单的任务。 事务可以通过对数据强制实施数据完整性要求来进行帮助。 如果您的数据受益于 ACID 原则, 则选择支持事务的存储解决方案。