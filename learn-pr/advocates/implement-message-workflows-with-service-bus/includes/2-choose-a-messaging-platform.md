<span data-ttu-id="db039-101">有很多通信平台可帮助提高分布式应用程序的可靠性, 其中包括多个 Azure。</span><span class="sxs-lookup"><span data-stu-id="db039-101">There are many communications platforms that can help improve the reliability of a distributed application, including several within Azure.</span></span> <span data-ttu-id="db039-102">这些工具中的每一个都可用于不同的用途;让我们查看 Azure 中的每个工具以帮助选择正确的工具。</span><span class="sxs-lookup"><span data-stu-id="db039-102">Each of these tools serves a different purpose; let's review each tool in Azure to help choose the right one.</span></span>

<span data-ttu-id="db039-103">我们的比萨饼订购和跟踪应用程序的体系结构需要几个组件: 网站、数据存储、后端服务等。我们可以通过多种不同的方式将应用程序的组件组合在一起, 而单个应用程序可以利用多种技术。</span><span class="sxs-lookup"><span data-stu-id="db039-103">The architecture of our pizza ordering and tracking application requires several components: a website, data storage, back-end service, etc. We can bind the components of our application together in many different ways, and a single application can take advantage of multiple techniques.</span></span> 

<span data-ttu-id="db039-104">我们需要决定要在 Contoso 切片应用程序中使用的技术。</span><span class="sxs-lookup"><span data-stu-id="db039-104">We need to decide which techniques to use in the Contoso Slices application.</span></span> <span data-ttu-id="db039-105">第一步是评估多个部件之间存在通信的每个位置。</span><span class="sxs-lookup"><span data-stu-id="db039-105">The first step is to evaluate each place where there is communication between multiple parts.</span></span> <span data-ttu-id="db039-106">某些组件_必须_及时运行, 才能使应用程序完全执行作业。</span><span class="sxs-lookup"><span data-stu-id="db039-106">Some components _must_ run in a timely manner for our application to be doing its job at all.</span></span> <span data-ttu-id="db039-107">有些可能很重要, 但不是时间关键。</span><span class="sxs-lookup"><span data-stu-id="db039-107">Some may be important, but not time-critical.</span></span> <span data-ttu-id="db039-108">最后, 其他组件 (如我们的移动应用程序通知) 更是可选的。</span><span class="sxs-lookup"><span data-stu-id="db039-108">Finally, other components, like our mobile app notifications, are a bit more optional.</span></span>

<span data-ttu-id="db039-109">在这里, 你将了解 Azure 中提供的通信平台, 以便你可以在应用程序中为每个要求选择正确的平台。</span><span class="sxs-lookup"><span data-stu-id="db039-109">Here, you will learn about the communications platforms available in Azure so that you can choose the right one for each requirement in your application.</span></span>

## <a name="decide-between-messages-and-events"></a><span data-ttu-id="db039-110">在邮件和事件之间做出决定</span><span class="sxs-lookup"><span data-stu-id="db039-110">Decide between messages and events</span></span>

<span data-ttu-id="db039-111">消息和事件都是数据**报**: 从一个组件发送到另一个组件的数据包。</span><span class="sxs-lookup"><span data-stu-id="db039-111">Messages and events are both **datagrams**: packages of data sent from one component to another.</span></span> <span data-ttu-id="db039-112">它们在最初看起来不同的方式上是不同的, 但在构建应用程序的方式方面可能会产生显著的差异。</span><span class="sxs-lookup"><span data-stu-id="db039-112">They are different in ways that at first seem subtle, but can make significant differences in how you architect your application.</span></span>

### <a name="messages"></a><span data-ttu-id="db039-113">信息</span><span class="sxs-lookup"><span data-stu-id="db039-113">Messages</span></span>

<span data-ttu-id="db039-114">在分布式应用程序的术语中, 定义邮件的特征是应用程序的整体完整性可能依赖于接收的邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-114">In the terminology of distributed applications, the defining characteristic of a message is that the overall integrity of the application may rely on messages being received.</span></span> <span data-ttu-id="db039-115">您可以将邮件作为一个组件发送到一个组件, 将 baton 的工作流传递给另一个组件。</span><span class="sxs-lookup"><span data-stu-id="db039-115">You can think of sending a message as one component passing the baton of a workflow to a different component.</span></span> <span data-ttu-id="db039-116">整个工作流可能是一个重要的业务流程, 而邮件是将这些组件保持在一起的实体。</span><span class="sxs-lookup"><span data-stu-id="db039-116">The entire workflow may be a vital business process, and the message is the mortar that holds the components together.</span></span>

<span data-ttu-id="db039-117">消息通常包含数据本身, 而不仅仅是数据的引用 (如 ID 或 URL)。</span><span class="sxs-lookup"><span data-stu-id="db039-117">A message generally contains the data itself, not just a reference (like an ID or URL) to data.</span></span> <span data-ttu-id="db039-118">将数据作为数据报的一部分发送比发送引用的 brittle 少。</span><span class="sxs-lookup"><span data-stu-id="db039-118">Sending the data as part of the datagram is less brittle than sending a reference.</span></span> <span data-ttu-id="db039-119">邮件传递体系结构可确保邮件的传递, 并且, 由于不需要其他查找, 因此可可靠地处理邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-119">The messaging architecture guarantees delivery of the message, and because no additional lookups are required, the message is reliably handled.</span></span> <span data-ttu-id="db039-120">但是, 发送应用程序需要准确知道要包含的数据, 以避免发送过多的数据, 这需要接收组件执行不必要的工作。</span><span class="sxs-lookup"><span data-stu-id="db039-120">However, the sending application needs to know exactly what data to include to avoid sending too much data, which requires the receiving component to do unnecessary work.</span></span> <span data-ttu-id="db039-121">在这种意义上, 邮件的发件人和收件人通常由严格的数据合同结合使用。</span><span class="sxs-lookup"><span data-stu-id="db039-121">In this sense, the sender and receiver of a message are often coupled by a strict data contract.</span></span>

<span data-ttu-id="db039-122">在 Contoso 扇面的新体系结构中, 输入比萨饼订单时, 公司可能会使用邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-122">In Contoso Slices' new architecture, when a pizza order is entered, the company would likely use messages.</span></span> <span data-ttu-id="db039-123">web 前端或移动应用将向后端处理组件发送一条消息。</span><span class="sxs-lookup"><span data-stu-id="db039-123">The web front end or mobile app would send a message to the back-end processing components.</span></span> <span data-ttu-id="db039-124">在后端, 将在靠近客户和信用卡充电的步骤中进行路由。</span><span class="sxs-lookup"><span data-stu-id="db039-124">In the back end, steps like routing to the store near the customer and charging the credit card would take place.</span></span>

### <a name="events"></a><span data-ttu-id="db039-125">事件</span><span class="sxs-lookup"><span data-stu-id="db039-125">Events</span></span>

<span data-ttu-id="db039-126">事件触发通知, 告知发生了某个事件。</span><span class="sxs-lookup"><span data-stu-id="db039-126">An event triggers a notification that something has occurred.</span></span> <span data-ttu-id="db039-127">事件比邮件 "亮", 最常用于广播通信。</span><span class="sxs-lookup"><span data-stu-id="db039-127">Events are "lighter" than messages and are most often used for broadcast communications.</span></span>

<span data-ttu-id="db039-128">事件具有以下特征:</span><span class="sxs-lookup"><span data-stu-id="db039-128">Events have the following characteristics:</span></span>

* <span data-ttu-id="db039-129">该事件可能会发送到多个收件人, 或根本无法发送到任何收件人</span><span class="sxs-lookup"><span data-stu-id="db039-129">The event may be sent to multiple receivers, or to none at all</span></span>
* <span data-ttu-id="db039-130">事件通常用于 "扇出", 或者每个发布服务器具有大量订阅者</span><span class="sxs-lookup"><span data-stu-id="db039-130">Events are often intended to "fan out," or have a large number of subscribers for each publisher</span></span>
* <span data-ttu-id="db039-131">事件发布者没有预期接收组件所执行的操作</span><span class="sxs-lookup"><span data-stu-id="db039-131">The publisher of the event has no expectation about the action a receiving component takes</span></span>

<span data-ttu-id="db039-132">我们的比萨饼链可能会使用事件通知用户有关状态更改的通知。</span><span class="sxs-lookup"><span data-stu-id="db039-132">Our pizza chain would likely use events for notifications to users about status changes.</span></span> <span data-ttu-id="db039-133">可以将状态更改事件发送到 azure 事件网格, 然后发送到 azure 函数, 并将其发送到 azure 通知中心, 以获取完全_无服务器_解决方案。</span><span class="sxs-lookup"><span data-stu-id="db039-133">Status change events could be sent to Azure Event Grid, then on to Azure Functions, and to Azure Notification Hubs for a completely _serverless_ solution.</span></span>

<span data-ttu-id="db039-134">事件和邮件之间的差异很重要, 因为通信平台通常旨在处理其中的一个或另一个。</span><span class="sxs-lookup"><span data-stu-id="db039-134">This difference between events and messages is fundamental because communications platforms are generally designed to handle one or the other.</span></span> <span data-ttu-id="db039-135">服务总线旨在处理邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-135">Service Bus is designed to handle messages.</span></span> <span data-ttu-id="db039-136">如果要发送事件, 可能需要选择 "事件网格"。</span><span class="sxs-lookup"><span data-stu-id="db039-136">If you want to send events, you would likely choose Event Grid.</span></span>

<span data-ttu-id="db039-137">azure 也有 azure 事件中心, 但它通常用于用于分析的一种特定类型的通信数据流。</span><span class="sxs-lookup"><span data-stu-id="db039-137">Azure also has Azure Event Hubs, but it is most often used for a specific type of high-flow stream of communications used for analytics.</span></span> <span data-ttu-id="db039-138">例如, 如果我们的比萨饼微波炉上有网络传感器, 我们可以使用与 Azure Stream Analytics 结合使用的事件中心来监视温度变化中的模式, 这些变化可能表示意外的火灾或组件磨损。</span><span class="sxs-lookup"><span data-stu-id="db039-138">For example, if we had networked sensors on our pizza ovens, we could use Event Hubs coupled with Azure Stream Analytics to watch for patterns in the temperature changes that might indicate an unwanted fire or component wear.</span></span>

## <a name="service-bus-topics-queues-and-relays"></a><span data-ttu-id="db039-139">服务总线主题、队列和中继</span><span class="sxs-lookup"><span data-stu-id="db039-139">Service Bus topics, queues, and relays</span></span>

<span data-ttu-id="db039-140">Azure 服务总线可以通过以下三种不同的方式交换邮件: 队列、主题和中继。</span><span class="sxs-lookup"><span data-stu-id="db039-140">Azure Service Bus can exchange messages in three different ways: queues, topics, and relays.</span></span>

### <a name="what-is-a-queue"></a><span data-ttu-id="db039-141">什么是队列？</span><span class="sxs-lookup"><span data-stu-id="db039-141">What is a queue?</span></span>

<span data-ttu-id="db039-142">**队列**是邮件的简单临时存储位置。</span><span class="sxs-lookup"><span data-stu-id="db039-142">A **queue** is a simple temporary storage location for messages.</span></span> <span data-ttu-id="db039-143">发送组件向队列中添加一条消息。</span><span class="sxs-lookup"><span data-stu-id="db039-143">A sending component adds a message to the queue.</span></span> <span data-ttu-id="db039-144">目标组件用于选取队列前面的邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-144">A destination component picks up the message at the front of the queue.</span></span> <span data-ttu-id="db039-145">在一般情况下, 每封邮件仅由一个接收器接收。</span><span class="sxs-lookup"><span data-stu-id="db039-145">Under ordinary circumstances, each message is received by only one receiver.</span></span>

![该图显示了一个发件人将邮件发送到队列的示例邮件队列, 以及一个接收器从队列中逐个检索这些邮件。](../media/2-service-bus-queue.png)

<span data-ttu-id="db039-147">队列将源和目标组件分开, 以将目标组件与高需求隔离开来。</span><span class="sxs-lookup"><span data-stu-id="db039-147">Queues decouple the source and destination components to insulate destination components from high demand.</span></span> 

<span data-ttu-id="db039-148">在高峰时段, 邮件可能会比目标组件处理速度更快。</span><span class="sxs-lookup"><span data-stu-id="db039-148">During peak times, messages may come in faster than destination components can handle them.</span></span> <span data-ttu-id="db039-149">由于源组件与目标无直接连接, 因此源不会受到影响, 并且队列将增长。</span><span class="sxs-lookup"><span data-stu-id="db039-149">Because source components have no direct connection to the destination, the source is unaffected and the queue will grow.</span></span> <span data-ttu-id="db039-150">目标组件将从队列中删除邮件, 因为它们能够处理这些邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-150">Destination components will remove messages from the queue as they are able to handle them.</span></span> <span data-ttu-id="db039-151">当需求下降时, 目标组件可以追赶并缩短队列。</span><span class="sxs-lookup"><span data-stu-id="db039-151">When demand drops, destination components can catch up and the queue shortens.</span></span>

<span data-ttu-id="db039-152">队列在不需要向系统添加资源的情况下响应高要求 (如这样做)。</span><span class="sxs-lookup"><span data-stu-id="db039-152">A queue responds to high demand like this without needing to add resources to the system.</span></span> <span data-ttu-id="db039-153">但是, 对于需要相对快处理的邮件, 添加目标组件的其他实例可以允许它们共享负载。</span><span class="sxs-lookup"><span data-stu-id="db039-153">However, for messages that need to be handled relatively quickly, adding additional instances of your destination component can allow them to share the load.</span></span> <span data-ttu-id="db039-154">每封邮件只能由一个实例处理。</span><span class="sxs-lookup"><span data-stu-id="db039-154">Each message would be handled by only one instance.</span></span> <span data-ttu-id="db039-155">这是一种扩展整个应用程序的有效方法, 只是将资源添加到实际需要它的组件。</span><span class="sxs-lookup"><span data-stu-id="db039-155">This is an effective way to scale your entire application while only adding resources to the components that actually need it.</span></span>

### <a name="what-is-a-topic"></a><span data-ttu-id="db039-156">主题是什么？</span><span class="sxs-lookup"><span data-stu-id="db039-156">What is a topic?</span></span>

<span data-ttu-id="db039-157">**主题**类似于队列, 但可以具有多个订阅。</span><span class="sxs-lookup"><span data-stu-id="db039-157">A **topic** is similar to a queue but can have multiple subscriptions.</span></span> <span data-ttu-id="db039-158">这意味着多个目标组件可以订阅单个主题, 因此每封邮件都将传递给多个接收器。</span><span class="sxs-lookup"><span data-stu-id="db039-158">This means that multiple destination components can subscribe to a single topic, so each message is delivered to multiple receivers.</span></span> <span data-ttu-id="db039-159">订阅还可以筛选主题中的邮件, 以便仅接收相关的邮件。</span><span class="sxs-lookup"><span data-stu-id="db039-159">Subscriptions can also filter the messages in the topic to receive only messages that are relevant.</span></span> <span data-ttu-id="db039-160">订阅提供与队列相同的分离通信, 并以相同方式响应高要求。</span><span class="sxs-lookup"><span data-stu-id="db039-160">Subscriptions provide the same decoupled communications as queues and respond to high demand in the same way.</span></span> <span data-ttu-id="db039-161">如果您希望将每封邮件传递给多个目标组件, 请使用主题。</span><span class="sxs-lookup"><span data-stu-id="db039-161">Use a topic if you want each message to be delivered to more than one destination component.</span></span>

<span data-ttu-id="db039-162">基本定价层不支持的主题。</span><span class="sxs-lookup"><span data-stu-id="db039-162">Topics are not supported in the Basic pricing tier.</span></span>

![显示一个发件人通过包含三个订阅的主题向多个收件人发送邮件的图。](../media/2-service-bus-topic.png)

### <a name="what-is-a-relay"></a><span data-ttu-id="db039-165">什么是中继？</span><span class="sxs-lookup"><span data-stu-id="db039-165">What is a relay?</span></span>

<span data-ttu-id="db039-166">**中继**是在应用程序之间执行同步双向通信的对象。</span><span class="sxs-lookup"><span data-stu-id="db039-166">A **relay** is an object that performs synchronous, two-way communication between applications.</span></span> <span data-ttu-id="db039-167">与队列和主题不同的是, 它不是邮件的临时存储位置。</span><span class="sxs-lookup"><span data-stu-id="db039-167">Unlike queues and topics, it is not a temporary storage location for messages.</span></span> <span data-ttu-id="db039-168">相反, 它提供跨网络边界 (如防火墙) 的双向无缓冲连接。</span><span class="sxs-lookup"><span data-stu-id="db039-168">Instead, it provides bidirectional, unbuffered connections across network boundaries such as firewalls.</span></span> <span data-ttu-id="db039-169">当您想要在组件之间进行直接通信时使用中继, 就像它们位于同一网段上但由网络安全设备分开一样。</span><span class="sxs-lookup"><span data-stu-id="db039-169">Use a relay when you want direct communications between components as if they were located on the same network segment but separated by network security devices.</span></span>

> [!NOTE]
> <span data-ttu-id="db039-170">尽管中继是 Azure 服务总线的一部分, 但它们不会实现松散耦合邮件工作流, 也不会在本模块中进一步考虑。</span><span class="sxs-lookup"><span data-stu-id="db039-170">Although relays are part of Azure Service Bus, they do not implement loosely coupled messaging workflows and are not considered further in this module.</span></span>

## <a name="service-bus-queues-and-storage-queues"></a><span data-ttu-id="db039-171">服务总线队列和存储队列</span><span class="sxs-lookup"><span data-stu-id="db039-171">Service Bus queues and storage queues</span></span>

<span data-ttu-id="db039-172">有两个包含邮件队列的 Azure 功能: 服务总线和 Azure 存储帐户。</span><span class="sxs-lookup"><span data-stu-id="db039-172">There are two Azure features that include message queues: Service Bus and Azure Storage accounts.</span></span> <span data-ttu-id="db039-173">作为一般指南, 存储队列更易于使用, 但不如服务总线队列复杂且灵活。</span><span class="sxs-lookup"><span data-stu-id="db039-173">As a general guide, storage queues are simpler to use but are less sophisticated and flexible than Service Bus queues.</span></span>

<span data-ttu-id="db039-174">服务总线队列的主要优势包括:</span><span class="sxs-lookup"><span data-stu-id="db039-174">Key advantages of Service Bus queues include:</span></span>

* <span data-ttu-id="db039-175">支持较大的邮件大小 (每条消息为 256 kb, 而不是 64 kb)</span><span class="sxs-lookup"><span data-stu-id="db039-175">Supports larger messages size (256 KB per message versus 64 KB)</span></span>
* <span data-ttu-id="db039-176">同时支持最少一次和一次性传递-选择邮件丢失的可能性非常小, 或者一小部分处理两次</span><span class="sxs-lookup"><span data-stu-id="db039-176">Supports both at-least-once and at-most-once delivery - choose between a very small chance that a message is lost or a very small chance it is handled twice</span></span>
* <span data-ttu-id="db039-177">确保**先进先出 (FIFO)** 顺序消息按其添加顺序进行处理 (尽管 FIFO 是队列的正常运行, 但不能保证每条消息都有)</span><span class="sxs-lookup"><span data-stu-id="db039-177">Guarantees **first-in-first-out (FIFO)** order - messages are handled in the same order they are added (although FIFO is the normal operation of a queue, it is not guaranteed for every message)</span></span>
* <span data-ttu-id="db039-178">可以将多个邮件组合到一个事务中-如果事务中的一封邮件无法传递, 则将不会传递事务中的所有邮件</span><span class="sxs-lookup"><span data-stu-id="db039-178">Can group multiple messages into a transaction - if one message in the transaction fails to be delivered, all messages in the transaction will not be delivered</span></span>
* <span data-ttu-id="db039-179">支持基于角色的安全性</span><span class="sxs-lookup"><span data-stu-id="db039-179">Supports role-based security</span></span>
* <span data-ttu-id="db039-180">不需要目标组件连续轮询队列</span><span class="sxs-lookup"><span data-stu-id="db039-180">Does not require destination components to continuously poll the queue</span></span>

<span data-ttu-id="db039-181">存储队列的优势:</span><span class="sxs-lookup"><span data-stu-id="db039-181">Advantages of storage queues:</span></span>

* <span data-ttu-id="db039-182">支持无限队列大小 (相对于服务总线队列为 80 GB 的限制)</span><span class="sxs-lookup"><span data-stu-id="db039-182">Supports unlimited queue size (versus 80-GB limit for Service Bus queues)</span></span>
* <span data-ttu-id="db039-183">维护所有邮件的日志</span><span class="sxs-lookup"><span data-stu-id="db039-183">Maintains a log of all messages</span></span>

## <a name="how-to-choose-a-communications-technology"></a><span data-ttu-id="db039-184">如何选择通信技术</span><span class="sxs-lookup"><span data-stu-id="db039-184">How to choose a communications technology</span></span>

<span data-ttu-id="db039-185">我们已看到 Azure 提供的不同概念和实现。</span><span class="sxs-lookup"><span data-stu-id="db039-185">We've seen the different concepts and the implementations Azure provides.</span></span> <span data-ttu-id="db039-186">我们来讨论我们的决策过程应针对每个通信的外观。</span><span class="sxs-lookup"><span data-stu-id="db039-186">Let's discuss what our decision process should look like for each of our communications.</span></span>

#### <a name="consider-the-following-questions"></a><span data-ttu-id="db039-187">请考虑以下问题:</span><span class="sxs-lookup"><span data-stu-id="db039-187">Consider the following questions:</span></span>

1. <span data-ttu-id="db039-188">通信是否为事件？</span><span class="sxs-lookup"><span data-stu-id="db039-188">Is the communication an event?</span></span> <span data-ttu-id="db039-189">如果是这样, 请考虑使用事件网格或事件中心。</span><span class="sxs-lookup"><span data-stu-id="db039-189">If so, consider using Event Grid or Event Hubs.</span></span>

1. <span data-ttu-id="db039-190">是否应将单个邮件传递到多个目标？</span><span class="sxs-lookup"><span data-stu-id="db039-190">Should a single message be delivered to more than one destination?</span></span> <span data-ttu-id="db039-191">如果是这样, 请使用服务总线主题。</span><span class="sxs-lookup"><span data-stu-id="db039-191">If so, use a Service Bus topic.</span></span> <span data-ttu-id="db039-192">否则, 请使用队列。</span><span class="sxs-lookup"><span data-stu-id="db039-192">Otherwise, use a queue.</span></span>

<span data-ttu-id="db039-193">如果您决定需要队列:</span><span class="sxs-lookup"><span data-stu-id="db039-193">If you decide that you need a queue:</span></span>

#### <a name="choose-service-bus-queues-if"></a><span data-ttu-id="db039-194">在以下情况中选择服务总线队列:</span><span class="sxs-lookup"><span data-stu-id="db039-194">Choose Service Bus queues if:</span></span>

* <span data-ttu-id="db039-195">您需要一项最多的交付保证</span><span class="sxs-lookup"><span data-stu-id="db039-195">You need an at-most-once delivery guarantee</span></span>
* <span data-ttu-id="db039-196">您需要一个 FIFO 保证</span><span class="sxs-lookup"><span data-stu-id="db039-196">You need a FIFO guarantee</span></span>
* <span data-ttu-id="db039-197">您需要将邮件分组为事务</span><span class="sxs-lookup"><span data-stu-id="db039-197">You need to group messages into transactions</span></span>
* <span data-ttu-id="db039-198">您希望在不轮询队列的情况下接收邮件</span><span class="sxs-lookup"><span data-stu-id="db039-198">You want to receive messages without polling the queue</span></span>
* <span data-ttu-id="db039-199">您需要提供对队列的基于角色的访问</span><span class="sxs-lookup"><span data-stu-id="db039-199">You need to provide role-based access to the queues</span></span>
* <span data-ttu-id="db039-200">您需要处理大于 64 kb 但小于 256 kb 的邮件</span><span class="sxs-lookup"><span data-stu-id="db039-200">You need to handle messages larger than 64 KB but smaller than 256 KB</span></span>
* <span data-ttu-id="db039-201">您的队列大小不会增长大于 80 GB</span><span class="sxs-lookup"><span data-stu-id="db039-201">Your queue size will not grow larger than 80 GB</span></span>
* <span data-ttu-id="db039-202">你希望能够发布和使用批量邮件</span><span class="sxs-lookup"><span data-stu-id="db039-202">You would like to be able to publish and consume batches of messages</span></span>

#### <a name="choose-queue-storage-if"></a><span data-ttu-id="db039-203">在以下情况中选择队列存储:</span><span class="sxs-lookup"><span data-stu-id="db039-203">Choose queue storage if:</span></span>

* <span data-ttu-id="db039-204">您需要一个无特殊附加要求的简单队列</span><span class="sxs-lookup"><span data-stu-id="db039-204">You need a simple queue with no particular additional requirements</span></span>
* <span data-ttu-id="db039-205">您需要通过队列的所有邮件的审核跟踪</span><span class="sxs-lookup"><span data-stu-id="db039-205">You need an audit trail of all messages that pass through the queue</span></span>
* <span data-ttu-id="db039-206">您希望队列的大小超过 80 GB</span><span class="sxs-lookup"><span data-stu-id="db039-206">You expect the queue to exceed 80 GB in size</span></span>
* <span data-ttu-id="db039-207">您希望跟踪队列中的邮件处理进度</span><span class="sxs-lookup"><span data-stu-id="db039-207">You want to track progress for processing a message inside of the queue</span></span>

<span data-ttu-id="db039-208">尽管分布式应用程序的组件可以直接进行通信, 但通常可以通过使用中间通信平台 (如 azure 服务总线或 azure 事件网格) 提高该通信的可靠性。</span><span class="sxs-lookup"><span data-stu-id="db039-208">Although the components of a distributed application can communicate directly, you can often increase the reliability of that communication by using an intermediate communication platform such as Azure Service Bus or Azure Event Grid.</span></span>

<span data-ttu-id="db039-209">事件网格是为事件而设计的, 这将仅通知收件人一个事件, 而不包含与该事件关联的原始数据。</span><span class="sxs-lookup"><span data-stu-id="db039-209">Event Grid is designed for events, which notify recipients only of an event and do not contain the raw data associated with that event.</span></span> <span data-ttu-id="db039-210">Azure 事件中心是针对高流分析类型的事件而设计的。</span><span class="sxs-lookup"><span data-stu-id="db039-210">Azure Event Hubs is designed for high-flow analytics types of events.</span></span> <span data-ttu-id="db039-211">Azure 服务总线和存储队列适用于邮件, 可用于绑定任何应用程序工作流的核心部分。</span><span class="sxs-lookup"><span data-stu-id="db039-211">Azure Service Bus and storage queues are for messages, which can be used for binding the core pieces of any application workflow.</span></span>

<span data-ttu-id="db039-212">如果您的要求很简单, 如果想要将每封邮件仅发送到一个目标, 或者您希望尽快编写代码, 则存储队列可能是最佳选择。</span><span class="sxs-lookup"><span data-stu-id="db039-212">If your requirements are simple, if you want to send each message to only one destination, or if you want to write code as quickly as possible, a storage queue may be the best option.</span></span> <span data-ttu-id="db039-213">否则, 服务总线队列可提供更多的选项和灵活性。</span><span class="sxs-lookup"><span data-stu-id="db039-213">Otherwise, Service Bus queues provide many more options and flexibility.</span></span>

<span data-ttu-id="db039-214">如果要将邮件发送到多个订阅者, 请使用服务总线主题。</span><span class="sxs-lookup"><span data-stu-id="db039-214">If you want to send messages to multiple subscribers, use a Service Bus topic.</span></span>
