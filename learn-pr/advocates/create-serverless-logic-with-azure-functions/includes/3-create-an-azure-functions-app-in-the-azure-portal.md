<span data-ttu-id="c2789-101">现已准备好开始实施温度服务。</span><span class="sxs-lookup"><span data-stu-id="c2789-101">You are now ready to start implementing the temperature service.</span></span> <span data-ttu-id="c2789-102">在上一个单元中, 您确定一个无服务器解决方案最适合您的需求。</span><span class="sxs-lookup"><span data-stu-id="c2789-102">In the previous unit, you determined that a serverless solution would best fit your needs.</span></span> <span data-ttu-id="c2789-103">首先, 创建一个用于保存 Azure 函数的 function 应用程序。</span><span class="sxs-lookup"><span data-stu-id="c2789-103">Let's start by creating a function app to hold our Azure Function.</span></span>

[!include[](../../../includes/azure-sandbox-activate.md)]

## <a name="what-is-a-function-app"></a><span data-ttu-id="c2789-104">什么是函数应用？</span><span class="sxs-lookup"><span data-stu-id="c2789-104">What is a function app?</span></span>

<span data-ttu-id="c2789-105">函数托管在称为 "**函数应用**" 的执行上下文中。</span><span class="sxs-lookup"><span data-stu-id="c2789-105">Functions are hosted in an execution context called a **function app**.</span></span> <span data-ttu-id="c2789-106">您可以定义函数应用程序以逻辑方式分组和构造 Azure 中的函数和计算资源。</span><span class="sxs-lookup"><span data-stu-id="c2789-106">You define function apps to logically group and structure your functions and a compute resource in Azure.</span></span> <span data-ttu-id="c2789-107">在电梯内示例中, 您将创建一个函数应用程序来托管自动扶梯驱动器的齿轮温度服务。</span><span class="sxs-lookup"><span data-stu-id="c2789-107">In our elevator example, you would create a function app to host the escalator drive gear temperature service.</span></span> <span data-ttu-id="c2789-108">创建函数应用程序需要做出几个决策;您需要选择一个服务计划并选择一个兼容的存储帐户。</span><span class="sxs-lookup"><span data-stu-id="c2789-108">There are a few decisions that need to be made to create the function app; you need to choose a service plan and select a compatible storage account.</span></span>

### <a name="choosing-a-service-plan"></a><span data-ttu-id="c2789-109">选择服务计划</span><span class="sxs-lookup"><span data-stu-id="c2789-109">Choosing a service plan</span></span>

<span data-ttu-id="c2789-110">函数应用程序可以使用两种类型的服务计划之一。</span><span class="sxs-lookup"><span data-stu-id="c2789-110">Function apps may use one of two types of service plans.</span></span> <span data-ttu-id="c2789-111">第一个服务计划是 "**消费服务计划**"。</span><span class="sxs-lookup"><span data-stu-id="c2789-111">The first service plan is the **Consumption service plan**.</span></span> <span data-ttu-id="c2789-112">这是您在使用 Azure 无服务器应用程序平台时选择的计划。</span><span class="sxs-lookup"><span data-stu-id="c2789-112">This is the plan that you choose when using the Azure serverless application platform.</span></span> <span data-ttu-id="c2789-113">在运行函数时, 使用情况服务计划可提供自动缩放和帐单。</span><span class="sxs-lookup"><span data-stu-id="c2789-113">The Consumption service plan provides automatic scaling and bills you when your functions are running.</span></span> <span data-ttu-id="c2789-114">消耗量计划带有一个可配置的超时周期来执行函数。</span><span class="sxs-lookup"><span data-stu-id="c2789-114">The Consumption plan comes with a configurable timeout period for the execution of a function.</span></span> <span data-ttu-id="c2789-115">默认情况下, 它是5分钟, 但可能配置为长达10分钟的超时。</span><span class="sxs-lookup"><span data-stu-id="c2789-115">By default, it is 5 minutes, but may be configured to have a timeout as long as 10 minutes.</span></span>

<span data-ttu-id="c2789-116">第二个计划称为**Azure 应用服务计划**。</span><span class="sxs-lookup"><span data-stu-id="c2789-116">The second plan is called the **Azure App Service plan**.</span></span> <span data-ttu-id="c2789-117">通过此计划, 您可以通过在您定义的 VM 上连续运行您的函数来避免超时时间。</span><span class="sxs-lookup"><span data-stu-id="c2789-117">This plan allows you to avoid timeout periods by having your function run continuously on a VM that you define.</span></span> <span data-ttu-id="c2789-118">使用应用服务计划时, 您将负责管理运行该函数的应用资源, 因此这在技术上不是无服务器计划。</span><span class="sxs-lookup"><span data-stu-id="c2789-118">When using an App Service plan, you are responsible for managing the app resources the function runs on, so this is technically not a serverless plan.</span></span> <span data-ttu-id="c2789-119">但是, 如果您的函数持续使用, 或者您的函数需要的处理能力或执行时间超过了消耗计划可以提供的能力, 则可能是更好的选择。</span><span class="sxs-lookup"><span data-stu-id="c2789-119">However, it may be a better choice if your functions are used continuously or if your functions require more processing power or execution time than the Consumption plan can provide.</span></span>

### <a name="storage-account-requirements"></a><span data-ttu-id="c2789-120">存储帐户要求</span><span class="sxs-lookup"><span data-stu-id="c2789-120">Storage account requirements</span></span>

<span data-ttu-id="c2789-121">创建函数应用程序时, 它必须链接到存储帐户。</span><span class="sxs-lookup"><span data-stu-id="c2789-121">When you create a function app, it must be linked to a storage account.</span></span> <span data-ttu-id="c2789-122">您可以选择一个现有帐户或创建一个新帐户。</span><span class="sxs-lookup"><span data-stu-id="c2789-122">You can select an existing account or create a new one.</span></span> <span data-ttu-id="c2789-123">函数应用程序将此存储帐户用于内部操作, 如日志记录功能执行和管理执行触发器。</span><span class="sxs-lookup"><span data-stu-id="c2789-123">The function app uses this storage account for internal operations such as logging function executions and managing execution triggers.</span></span> <span data-ttu-id="c2789-124">在消费服务计划中, 它也是存储函数代码和配置文件的位置。</span><span class="sxs-lookup"><span data-stu-id="c2789-124">On the Consumption service plan, this is also where the function code and configuration file are stored.</span></span>

## <a name="create-a-function-app"></a><span data-ttu-id="c2789-125">创建函数应用程序</span><span class="sxs-lookup"><span data-stu-id="c2789-125">Create a function app</span></span>

<span data-ttu-id="c2789-126">让我们在 Azure 门户中创建一个函数应用程序。</span><span class="sxs-lookup"><span data-stu-id="c2789-126">Let's create a function app in the Azure portal.</span></span>

1. <span data-ttu-id="c2789-127">使用与激活沙盒时相同的帐户登录[Azure 门户](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true)。</span><span class="sxs-lookup"><span data-stu-id="c2789-127">Sign into the [Azure portal](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true) using the same account you activated the sandbox with.</span></span>

1. <span data-ttu-id="c2789-128">选择 "**创建资源**" 按钮 (位于 Azure 门户的左上角), 然后选择 "**获取已启动的 > 无服务器的函数应用程序**" 以打开 "函数应用*创建*" 边栏选项卡。</span><span class="sxs-lookup"><span data-stu-id="c2789-128">Select the **Create a resource** button found on the upper left-hand corner of the Azure portal, and then select **Get started > Serverless Function App** to open the Function App *Create* blade.</span></span> <span data-ttu-id="c2789-129">或者, 也可以使用**Compute > Function App**选项, 该选项将打开相同的刀片。</span><span class="sxs-lookup"><span data-stu-id="c2789-129">Alternatively, you can use the **Compute > Function App** option, which will open the same blade.</span></span>

  ![显示 "使用计算" 部分创建资源边栏和 "函数" 应用程序的 Azure 门户屏幕截图。](../media/3-create-function-app-blade.png)

1. <span data-ttu-id="c2789-131">选择全局唯一的应用程序名称。</span><span class="sxs-lookup"><span data-stu-id="c2789-131">Choose a globally unique app name.</span></span> <span data-ttu-id="c2789-132">这将用作服务的基 URL。</span><span class="sxs-lookup"><span data-stu-id="c2789-132">This will serve as the base URL of your service.</span></span> <span data-ttu-id="c2789-133">例如, 可以将 xxxxxxx 命名为 "自动**扶梯-功能**", 其中, 可以将 x 替换为您的缩写和出生年份。</span><span class="sxs-lookup"><span data-stu-id="c2789-133">For example, you can name it **escalator-functions-xxxxxxx**, where the x's can be replaced with your initials and your birth year.</span></span> <span data-ttu-id="c2789-134">如果这不是全局唯一的, 则可以尝试其他任何组合。</span><span class="sxs-lookup"><span data-stu-id="c2789-134">If this isn't globally unique, you can try any other combination.</span></span> <span data-ttu-id="c2789-135">有效字符为 a-z、0-9 和-。</span><span class="sxs-lookup"><span data-stu-id="c2789-135">Valid characters are a-z, 0-9 and -.</span></span>

1. <span data-ttu-id="c2789-136">选择您希望在其中托管函数应用程序的 Azure 订阅。</span><span class="sxs-lookup"><span data-stu-id="c2789-136">Select the Azure subscription where you would like the function app hosted.</span></span>

1. <span data-ttu-id="c2789-137">选择名为 "**<rgn>[沙盒资源组名称]</rgn>**" 的现有资源组。</span><span class="sxs-lookup"><span data-stu-id="c2789-137">Select the existing resource group called "**<rgn>[sandbox resource group name]</rgn>**".</span></span>

1. <span data-ttu-id="c2789-138">选择 "操作系统**Windows** "。</span><span class="sxs-lookup"><span data-stu-id="c2789-138">Select **Windows** for OS.</span></span>

1. <span data-ttu-id="c2789-139">对于 "**托管计划**", 选择 "**消耗计划**", 即 "无服务器托管" 选项。</span><span class="sxs-lookup"><span data-stu-id="c2789-139">For **Hosting Plan**, select **Consumption Plan**, which is the serverless hosting option.</span></span>

1. <span data-ttu-id="c2789-140">从下面的列表中选择离你最近的地理位置。</span><span class="sxs-lookup"><span data-stu-id="c2789-140">Select the geographical location closest to you from the list below.</span></span> <span data-ttu-id="c2789-141">在生产系统中, 您可能要选择靠近客户或功能使用者的位置。</span><span class="sxs-lookup"><span data-stu-id="c2789-141">In a production system, you would want to select a location near your customers or consumers of the function.</span></span>

    [!include[](../../../includes/azure-sandbox-regions-first-mention-note-friendly.md)]

1. <span data-ttu-id="c2789-142">对于**运行时堆栈**, 从下拉列表中选择 "JavaScript", 这是我们在本练习中实现函数示例所采用的语言。</span><span class="sxs-lookup"><span data-stu-id="c2789-142">For **Runtime Stack**, select JavaScript from the dropdown, which is the language in which we implement the function examples in this exercise.</span></span>

1. <span data-ttu-id="c2789-143">创建新的存储帐户。</span><span class="sxs-lookup"><span data-stu-id="c2789-143">Create a new storage account.</span></span> <span data-ttu-id="c2789-144">Azure 将根据应用名称为其指定名称。</span><span class="sxs-lookup"><span data-stu-id="c2789-144">Azure will give it a name based on the app name.</span></span> <span data-ttu-id="c2789-145">您可以根据需要更改它, 但它还必须是唯一的。</span><span class="sxs-lookup"><span data-stu-id="c2789-145">You can change it if you like, but it must also be unique.</span></span>

1. <span data-ttu-id="c2789-146">确保 Azure application Insights 已**打开**, 并选择最接近你 (或你的客户) 的区域。</span><span class="sxs-lookup"><span data-stu-id="c2789-146">Make sure that Azure Application Insights is **On** and select the region closest to you (or your customers).</span></span>

1. <span data-ttu-id="c2789-147">选择 "**创建**";部署需要几分钟时间。</span><span class="sxs-lookup"><span data-stu-id="c2789-147">Select **Create**; deployment will take a few minutes.</span></span> <span data-ttu-id="c2789-148">完成后, 你将收到通知。</span><span class="sxs-lookup"><span data-stu-id="c2789-148">You'll receive a notification once it's complete.</span></span>

## <a name="verify-your-azure-function-app"></a><span data-ttu-id="c2789-149">验证 Azure 函数应用</span><span class="sxs-lookup"><span data-stu-id="c2789-149">Verify your Azure function app</span></span>

1. <span data-ttu-id="c2789-150">从 Azure 门户左侧菜单中, 选择 "**资源组**"。</span><span class="sxs-lookup"><span data-stu-id="c2789-150">From the Azure portal left-hand menu, select **Resource groups**.</span></span> <span data-ttu-id="c2789-151">然后, 您应该会在可用组列表中看到一个名为**<rgn>[沙盒资源组名称]</rgn>** 的资源组。</span><span class="sxs-lookup"><span data-stu-id="c2789-151">You should then see a resource group named **<rgn>[sandbox resource group name]</rgn>** in the list of available groups.</span></span>

    ![显示具有 "资源组" 菜单项和 <rgn> [沙盒资源组名称] </rgn> 列表项突出显示的资源组边栏的 Azure 门户的屏幕截图。](../media/3-resource-group.png)

1. <span data-ttu-id="c2789-153">选择 "资源组**<rgn>[沙盒资源组名称]</rgn>**"。</span><span class="sxs-lookup"><span data-stu-id="c2789-153">Select the resource group **<rgn>[sandbox resource group name]</rgn>**.</span></span> <span data-ttu-id="c2789-154">然后, 您应该会看到如下列表所示的资源列表。</span><span class="sxs-lookup"><span data-stu-id="c2789-154">You should then see a resource list like the following list.</span></span>

    ![显示 <rgn> [沙盒资源组名称] </rgn> 组中的所有资源的 Azure 门户屏幕截图, 其中包括应用服务计划、存储帐户、application Insights 资源和应用服务的条目。](../media/3-resource-list.png)

<span data-ttu-id="c2789-156">带有闪电形函数图标 (作为应用服务列出) 的项是新的函数应用程序。</span><span class="sxs-lookup"><span data-stu-id="c2789-156">The item with the lightning bolt Function icon, listed as an App Service, is your new function app.</span></span> <span data-ttu-id="c2789-157">您可以单击它打开有关新函数的详细信息-它已分配了一个公用 URL, 如果您在浏览器中打开该功能, 则应获取一个指示您的函数应用程序正在运行的默认网页。</span><span class="sxs-lookup"><span data-stu-id="c2789-157">You can click on it to open the details about the new function - it has a public URL assigned to it, if you open that in a browser, you should get a default web page that indicates your Function App is running.</span></span>
