让我们的文本分析知识能够在切实可行的解决方案中发挥作用。 我们的解决方案将重点介绍文本文档的看法分析。 让我们通过描述要解决的问题来设置上下文。

## <a name="manage-customer-feedback-more-efficiently"></a>更有效地管理客户反馈

社交媒体在谈论贵公司的产品时处于活动状态。 您的反馈电子邮件别名也是主动与客户共同分享自己的产品的意见。

与任何新的启动一样, 你随时都可以通过 mantra 收听客户来激活。 不过, 你的产品成功使这一承诺更易于说出。 这是一个很棒的问题, 但都是相同的问题。

团队无法再跟上反馈的数量。 他们需要帮助对反馈进行排序, 以便能够尽可能高效地管理问题。 作为组织的开发人员主管, 您需要构建解决方案。

我们来看一些高级别的要求:

|要求  | 详细信息  |
|---------|---------|
|对反馈进行分类, 以便我们能够对其做出响应。     |   并非所有反馈都是相等的。 有些是发光 testimony。 其他反馈是来自失望客户的 scathing criticism。 或许你无法在其他情况下知道客户需要什么。 <br/><br/>至少, 有一个指示反馈的看法或语气将有助于我们对其进行分类。     |
|解决方案应向上或向下扩展以满足需求。    |   我们是启动。 固定成本难以论证, 并且我们尚未确定反馈流量的确切模式。 我们需要一个可在静音期间解决突发活动的解决方案, 但尽可能少的成本的解决方案。 <br/><br/> 在这种情况下, 在消耗计划上计费的无服务器体系结构是一个很好的候选人。     |
| 生成最低可行的产品 (MVP), 但使解决方案具有适应性。    | 今天, 我们想要对反馈进行分类, 以便我们可以将有限的资源应用于重要的反馈。 如果客户感到失望, 我们希望立即了解并开始与他们聊天。 将来, 我们将增强此解决方案以执行更多操作。 新功能的一个想法是, 在反馈中检查关键短语, 以检测痛点, 然后再与我们的客户进行紧急质量。 另一种方法是将响应自动返回给处于积极或非特定形式的客户。 尽管他们喜欢我们, 但我们希望他们知道我们仍在倾听自己的反馈。 <br/><br/>提供即插即用体系结构的解决方案在这里非常适合。 例如, 我们可以使用队列作为一种形式的工厂行。 您执行一项任务, 然后将结果放入队列中的下一个系统部件以进行选取并处理。   |
|快速提供。     |   我们的所有人都听说过此! 请记住, 此解决方案是 MVP, 我们希望快速使用我们的方案对其进行测试。 若要以较低的速度交付, 且质量较高, 则需要编写更少的代码 <br/><br/> 利用文本分析 API 意味着我们不必培训模型来检测看法。 通过以声明方式使用 Azure 函数和绑定到队列, 可以减少必须编写的代码量。 无服务器解决方案也意味着我们无需担心服务器管理。   |

对于上表中的每个要求, 我们建议的解决方案简要介绍了如何将要求映射到解决方案。 现在, 我们来看看什么解决方案可能是基于 Azure 的。

## <a name="a-solution-based-on-azure-functions-azure-queue-storage-and-text-analytics-api"></a>基于 azure 函数、azure 队列存储和文本分析 API 的解决方案

下图是解决方案的设计建议。 它使用 azure 的三个核心组件: azure 队列存储、azure 函数和 azure 认知服务。

![反馈排序体系结构的概念图。](../media/proposed-solution.PNG)

建议将包含用户反馈的文本文档放在前面的图表中已命名为 "*新反馈-q* " 的队列中。 包含文本文档的邮件到达队列中将触发或启动函数执行。 函数将从输入队列中读取包含新文档的邮件, 并将其发送到文本分析 API 的分析。 根据 API 返回的结果, 将包含该文档的新邮件放入输出队列以供进一步处理。

我们为每个文档返回的结果是一个看法分数。 输出队列用于存储反馈, 这些反馈排列为正数、中性和负数。 但愿负队列将始终为空! :-)一旦将每个传入的反馈已存储到基于看法的输出队列中, 您可以设想添加逻辑, 以对每个队列中的邮件执行操作。

我们来看看下一个流程图, 了解函数逻辑需要执行的操作。

![Azure 函数中的逻辑流程图, 用于通过看法将文本文档排序到输出队列中。](../media/flow.PNG)

我们的逻辑类似于路由器。 它接受文本输入, 并根据文本的看法分数将其路由到输出队列。 我们对文本分析 API 有依赖性。 虽然逻辑看起来不简单, 但此功能将不再需要团队中的人员手动分析反馈。

## <a name="steps-to-implement-our-solution"></a>实施我们的解决方案的步骤

若要实现此单元中所述的解决方案, 我们需要完成以下步骤。

1. 创建函数应用程序以承载我们的解决方案。

1. 使用文本分析 API 在传入反馈邮件中查找看法。 我们将从前面的练习中使用我们的访问密钥, 并编写一些代码以发送请求。

1. 发布反馈, 以根据看法处理队列。

让我们继续创建我们的函数应用程序。