<span data-ttu-id="0270f-101">让我们的文本分析知识能够在切实可行的解决方案中发挥作用。</span><span class="sxs-lookup"><span data-stu-id="0270f-101">Let's put our knowledge of Text Analytics to work in a practical solution.</span></span> <span data-ttu-id="0270f-102">我们的解决方案将重点介绍文本文档的看法分析。</span><span class="sxs-lookup"><span data-stu-id="0270f-102">Our solution will focus on Sentiment Analysis of text documents.</span></span> <span data-ttu-id="0270f-103">让我们通过描述要解决的问题来设置上下文。</span><span class="sxs-lookup"><span data-stu-id="0270f-103">Let's set the context by describing the problem we want to tackle.</span></span>

## <a name="manage-customer-feedback-more-efficiently"></a><span data-ttu-id="0270f-104">更有效地管理客户反馈</span><span class="sxs-lookup"><span data-stu-id="0270f-104">Manage customer feedback more efficiently</span></span>

<span data-ttu-id="0270f-105">社交媒体在谈论贵公司的产品时处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="0270f-105">Social media is active with talk of your company's product.</span></span> <span data-ttu-id="0270f-106">您的反馈电子邮件别名也是主动与客户共同分享自己的产品的意见。</span><span class="sxs-lookup"><span data-stu-id="0270f-106">Your feedback email alias is also active with customers eager to share their opinion of your product.</span></span>

<span data-ttu-id="0270f-107">与任何新的启动一样, 你随时都可以通过 mantra 收听客户来激活。</span><span class="sxs-lookup"><span data-stu-id="0270f-107">As is the case with any new startup, you live by the mantra of listening to your customers.</span></span> <span data-ttu-id="0270f-108">不过, 你的产品成功使这一承诺更易于说出。</span><span class="sxs-lookup"><span data-stu-id="0270f-108">However, the success of your product has made keeping this promise easier said than done.</span></span> <span data-ttu-id="0270f-109">这是一个很棒的问题, 但都是相同的问题。</span><span class="sxs-lookup"><span data-stu-id="0270f-109">It's a good problem but a problem all the same.</span></span>

<span data-ttu-id="0270f-110">团队无法再跟上反馈的数量。</span><span class="sxs-lookup"><span data-stu-id="0270f-110">The team can't keep up with the volume of feedback anymore.</span></span> <span data-ttu-id="0270f-111">他们需要帮助对反馈进行排序, 以便能够尽可能高效地管理问题。</span><span class="sxs-lookup"><span data-stu-id="0270f-111">They need help sorting the feedback so that issues can be managed as efficiently as possible.</span></span> <span data-ttu-id="0270f-112">作为组织的开发人员主管, 您需要构建解决方案。</span><span class="sxs-lookup"><span data-stu-id="0270f-112">As the lead developer in the organization, you have been asked to build a solution.</span></span>

<span data-ttu-id="0270f-113">我们来看一些高级别的要求:</span><span class="sxs-lookup"><span data-stu-id="0270f-113">Let's look at some high-level requirements:</span></span>

|<span data-ttu-id="0270f-114">要求</span><span class="sxs-lookup"><span data-stu-id="0270f-114">Requirement</span></span>  | <span data-ttu-id="0270f-115">详细信息</span><span class="sxs-lookup"><span data-stu-id="0270f-115">Details</span></span>  |
|---------|---------|
|<span data-ttu-id="0270f-116">对反馈进行分类, 以便我们能够对其做出响应。</span><span class="sxs-lookup"><span data-stu-id="0270f-116">Categorize feedback so we can react to it.</span></span>     |   <span data-ttu-id="0270f-117">并非所有反馈都是相等的。</span><span class="sxs-lookup"><span data-stu-id="0270f-117">Not all feedback is equal.</span></span> <span data-ttu-id="0270f-118">有些是发光 testimony。</span><span class="sxs-lookup"><span data-stu-id="0270f-118">Some is glowing testimony.</span></span> <span data-ttu-id="0270f-119">其他反馈是来自失望客户的 scathing criticism。</span><span class="sxs-lookup"><span data-stu-id="0270f-119">Other feedback is scathing criticism from a frustrated customer.</span></span> <span data-ttu-id="0270f-120">或许你无法在其他情况下知道客户需要什么。</span><span class="sxs-lookup"><span data-stu-id="0270f-120">Perhaps you can't tell what the customer wants in other cases.</span></span> <br/><br/><span data-ttu-id="0270f-121">至少, 有一个指示反馈的看法或语气将有助于我们对其进行分类。</span><span class="sxs-lookup"><span data-stu-id="0270f-121">At a minimum, having an indication of the sentiment, or tone, of feedback would help us categorize it.</span></span>     |
|<span data-ttu-id="0270f-122">解决方案应向上或向下扩展以满足需求。</span><span class="sxs-lookup"><span data-stu-id="0270f-122">The solution should scale up or down to meet demand.</span></span>    |   <span data-ttu-id="0270f-123">我们是启动。</span><span class="sxs-lookup"><span data-stu-id="0270f-123">We're a startup.</span></span> <span data-ttu-id="0270f-124">固定成本难以论证, 并且我们尚未确定反馈流量的确切模式。</span><span class="sxs-lookup"><span data-stu-id="0270f-124">Fixed costs are difficult to justify, and we haven't figured out the exact pattern of feedback traffic.</span></span> <span data-ttu-id="0270f-125">我们需要一个可在静音期间解决突发活动的解决方案, 但尽可能少的成本的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0270f-125">We'll need a solution that can tackle bursts of activity, but cost as little as possible during quiet times.</span></span> <br/><br/> <span data-ttu-id="0270f-126">在这种情况下, 在消耗计划上计费的无服务器体系结构是一个很好的候选人。</span><span class="sxs-lookup"><span data-stu-id="0270f-126">A serverless architecture billed on a consumption plan is a good candidate in this case.</span></span>     |
| <span data-ttu-id="0270f-127">生成最低可行的产品 (MVP), 但使解决方案具有适应性。</span><span class="sxs-lookup"><span data-stu-id="0270f-127">Produce a Minimal Viable Product (MVP), but make the solution adaptable.</span></span>    | <span data-ttu-id="0270f-128">今天, 我们想要对反馈进行分类, 以便我们可以将有限的资源应用于重要的反馈。</span><span class="sxs-lookup"><span data-stu-id="0270f-128">Today, we want to categorize feedback so we can apply our limited resources to the feedback that matters.</span></span> <span data-ttu-id="0270f-129">如果客户感到失望, 我们希望立即了解并开始与他们聊天。</span><span class="sxs-lookup"><span data-stu-id="0270f-129">If a customer is frustrated, we want to know immediately and start chatting with them.</span></span> <span data-ttu-id="0270f-130">将来, 我们将增强此解决方案以执行更多操作。</span><span class="sxs-lookup"><span data-stu-id="0270f-130">In the future, we'll enhance this solution to do more.</span></span> <span data-ttu-id="0270f-131">新功能的一个想法是, 在反馈中检查关键短语, 以检测痛点, 然后再与我们的客户进行紧急质量。</span><span class="sxs-lookup"><span data-stu-id="0270f-131">One idea for a new feature is to examine key phrases in feedback to detect pain points before they reach critical mass with our customers.</span></span> <span data-ttu-id="0270f-132">另一种方法是将响应自动返回给处于积极或非特定形式的客户。</span><span class="sxs-lookup"><span data-stu-id="0270f-132">Another idea is to automate responses back to customers who are either positive or neutral.</span></span> <span data-ttu-id="0270f-133">尽管他们喜欢我们, 但我们希望他们知道我们仍在倾听自己的反馈。</span><span class="sxs-lookup"><span data-stu-id="0270f-133">Even though they love us, we want them to know we are still listening to their feedback.</span></span> <br/><br/><span data-ttu-id="0270f-134">提供即插即用体系结构的解决方案在这里非常适合。</span><span class="sxs-lookup"><span data-stu-id="0270f-134">A solution that offers a plug-and-play architecture is a good fit here.</span></span> <span data-ttu-id="0270f-135">例如, 我们可以使用队列作为一种形式的工厂行。</span><span class="sxs-lookup"><span data-stu-id="0270f-135">We could, for example, use queues as a form of factory line.</span></span> <span data-ttu-id="0270f-136">您执行一项任务, 然后将结果放入队列中的下一个系统部件以进行选取并处理。</span><span class="sxs-lookup"><span data-stu-id="0270f-136">You perform one task, then place the result into a queue for the next part of the system to pick it up and process.</span></span>   |
|<span data-ttu-id="0270f-137">快速提供。</span><span class="sxs-lookup"><span data-stu-id="0270f-137">Deliver quickly.</span></span>     |   <span data-ttu-id="0270f-138">我们的所有人都听说过此!</span><span class="sxs-lookup"><span data-stu-id="0270f-138">We've all heard this one before!</span></span> <span data-ttu-id="0270f-139">请记住, 此解决方案是 MVP, 我们希望快速使用我们的方案对其进行测试。</span><span class="sxs-lookup"><span data-stu-id="0270f-139">Remember, this solution is an MVP, and we want to test it with our scenario quickly.</span></span> <span data-ttu-id="0270f-140">若要以较低的速度交付, 且质量较高, 则需要编写更少的代码</span><span class="sxs-lookup"><span data-stu-id="0270f-140">To deliver at speed and with quality will mean writing less code.</span></span> <br/><br/> <span data-ttu-id="0270f-141">利用文本分析 API 意味着我们不必培训模型来检测看法。</span><span class="sxs-lookup"><span data-stu-id="0270f-141">Taking advantage of the Text Analytics API means we don't have to train a model to detect sentiment.</span></span> <span data-ttu-id="0270f-142">通过以声明方式使用 Azure 函数和绑定到队列, 可以减少必须编写的代码量。</span><span class="sxs-lookup"><span data-stu-id="0270f-142">Using Azure Functions and binding to queues declaratively reduces the amount of code we have to write.</span></span> <span data-ttu-id="0270f-143">无服务器解决方案也意味着我们无需担心服务器管理。</span><span class="sxs-lookup"><span data-stu-id="0270f-143">A serverless solution also means we don't have to worry about server management.</span></span>   |

<span data-ttu-id="0270f-144">对于上表中的每个要求, 我们建议的解决方案简要介绍了如何将要求映射到解决方案。</span><span class="sxs-lookup"><span data-stu-id="0270f-144">Our proposed solution for each requirement in the preceding table offers a glimpse into how to map requirements to solutions.</span></span> <span data-ttu-id="0270f-145">现在, 我们来看看什么解决方案可能是基于 Azure 的。</span><span class="sxs-lookup"><span data-stu-id="0270f-145">Let's now see what a solution might look like based on Azure.</span></span>

## <a name="a-solution-based-on-azure-functions-azure-queue-storage-and-text-analytics-api"></a><span data-ttu-id="0270f-146">基于 azure 函数、azure 队列存储和文本分析 API 的解决方案</span><span class="sxs-lookup"><span data-stu-id="0270f-146">A solution based on Azure Functions, Azure Queue Storage, and Text Analytics API</span></span>

<span data-ttu-id="0270f-147">下图是解决方案的设计建议。</span><span class="sxs-lookup"><span data-stu-id="0270f-147">The following diagram is a design proposal for a solution.</span></span> <span data-ttu-id="0270f-148">它使用 azure 的三个核心组件: azure 队列存储、azure 函数和 azure 认知服务。</span><span class="sxs-lookup"><span data-stu-id="0270f-148">It uses three core components of Azure: Azure Queue Storage, Azure Functions, and Azure Cognitive Services.</span></span>

![反馈排序体系结构的概念图。](../media/proposed-solution.PNG)

<span data-ttu-id="0270f-150">建议将包含用户反馈的文本文档放在前面的图表中已命名为 "*新反馈-q* " 的队列中。</span><span class="sxs-lookup"><span data-stu-id="0270f-150">The idea is that text documents containing user feedback are placed into a queue that we've named *new-feedback-q* in the preceding diagram.</span></span> <span data-ttu-id="0270f-151">包含文本文档的邮件到达队列中将触发或启动函数执行。</span><span class="sxs-lookup"><span data-stu-id="0270f-151">The arrival of a message containing the text document into the queue will trigger, or start, function execution.</span></span> <span data-ttu-id="0270f-152">函数将从输入队列中读取包含新文档的邮件, 并将其发送到文本分析 API 的分析。</span><span class="sxs-lookup"><span data-stu-id="0270f-152">The function reads messages containing new documents from the input queue and sends them for analysis to the Text Analytics API.</span></span> <span data-ttu-id="0270f-153">根据 API 返回的结果, 将包含该文档的新邮件放入输出队列以供进一步处理。</span><span class="sxs-lookup"><span data-stu-id="0270f-153">Based on the results that the API returns, a new message containing the document is placed into an output queue for further processing.</span></span>

<span data-ttu-id="0270f-154">我们为每个文档返回的结果是一个看法分数。</span><span class="sxs-lookup"><span data-stu-id="0270f-154">The result we get back for each document is a sentiment score.</span></span> <span data-ttu-id="0270f-155">输出队列用于存储反馈, 这些反馈排列为正数、中性和负数。</span><span class="sxs-lookup"><span data-stu-id="0270f-155">The output queues are used to store feedback sorted into positive, neutral, and negative.</span></span> <span data-ttu-id="0270f-156">但愿负队列将始终为空!</span><span class="sxs-lookup"><span data-stu-id="0270f-156">Hopefully, the negative queue will always be empty!</span></span> <span data-ttu-id="0270f-157">:-)一旦将每个传入的反馈已存储到基于看法的输出队列中, 您可以设想添加逻辑, 以对每个队列中的邮件执行操作。</span><span class="sxs-lookup"><span data-stu-id="0270f-157">:-) Once we've bucketed each incoming piece of feedback into an output queue based on sentiment, you can imagine adding logic to take action on the messages in each queue.</span></span>

<span data-ttu-id="0270f-158">我们来看看下一个流程图, 了解函数逻辑需要执行的操作。</span><span class="sxs-lookup"><span data-stu-id="0270f-158">Let's look at a flowchart next to see what the function logic needs to do.</span></span>

![Azure 函数中的逻辑流程图, 用于通过看法将文本文档排序到输出队列中。](../media/flow.PNG)

<span data-ttu-id="0270f-160">我们的逻辑类似于路由器。</span><span class="sxs-lookup"><span data-stu-id="0270f-160">Our logic is like a router.</span></span> <span data-ttu-id="0270f-161">它接受文本输入, 并根据文本的看法分数将其路由到输出队列。</span><span class="sxs-lookup"><span data-stu-id="0270f-161">It takes text input and routes it to an output queue based on the sentiment score of the text.</span></span> <span data-ttu-id="0270f-162">我们对文本分析 API 有依赖性。</span><span class="sxs-lookup"><span data-stu-id="0270f-162">We have a dependency on Text Analytics API.</span></span> <span data-ttu-id="0270f-163">虽然逻辑看起来不简单, 但此功能将不再需要团队中的人员手动分析反馈。</span><span class="sxs-lookup"><span data-stu-id="0270f-163">While the logic seems trivial, this function will remove the need for people on the team to analyze feedback manually.</span></span>

## <a name="steps-to-implement-our-solution"></a><span data-ttu-id="0270f-164">实施我们的解决方案的步骤</span><span class="sxs-lookup"><span data-stu-id="0270f-164">Steps to implement our solution</span></span>

<span data-ttu-id="0270f-165">若要实现此单元中所述的解决方案, 我们需要完成以下步骤。</span><span class="sxs-lookup"><span data-stu-id="0270f-165">To implement the solution described in this unit, we'll need to complete the following steps.</span></span>

1. <span data-ttu-id="0270f-166">创建函数应用程序以承载我们的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0270f-166">Create a function app to host our solution.</span></span>

1. <span data-ttu-id="0270f-167">使用文本分析 API 在传入反馈邮件中查找看法。</span><span class="sxs-lookup"><span data-stu-id="0270f-167">Look for sentiment in incoming feedback messages using the Text Analytics API.</span></span> <span data-ttu-id="0270f-168">我们将从前面的练习中使用我们的访问密钥, 并编写一些代码以发送请求。</span><span class="sxs-lookup"><span data-stu-id="0270f-168">We'll use our access key from the preceding exercise and write some code to send the requests.</span></span>

1. <span data-ttu-id="0270f-169">发布反馈, 以根据看法处理队列。</span><span class="sxs-lookup"><span data-stu-id="0270f-169">Post feedback to processing queues based on sentiment.</span></span>

<span data-ttu-id="0270f-170">让我们继续创建我们的函数应用程序。</span><span class="sxs-lookup"><span data-stu-id="0270f-170">Let's move on to creating our function app.</span></span>