 <span data-ttu-id="27997-101">函数应用程序提供用于管理和执行函数的上下文。</span><span class="sxs-lookup"><span data-stu-id="27997-101">A function app provides a context for managing and executing your functions.</span></span> <span data-ttu-id="27997-102">让我们创建一个函数应用程序, 然后向其添加函数。</span><span class="sxs-lookup"><span data-stu-id="27997-102">Let's create a function app and then add a function to it.</span></span>

## <a name="create-a-function-app-to-host-our-function"></a><span data-ttu-id="27997-103">创建函数应用程序以承载我们的函数</span><span class="sxs-lookup"><span data-stu-id="27997-103">Create a Function App to host our function</span></span>

1. <span data-ttu-id="27997-104">使用与激活沙盒时相同的帐户登录[Azure 门户](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true)。</span><span class="sxs-lookup"><span data-stu-id="27997-104">Sign into the [Azure portal](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true) using the same account you activated the sandbox with.</span></span>

1. <span data-ttu-id="27997-105">选择 "**创建资源**" 按钮 (位于 Azure 门户的左上角), 然后选择 "**计算** > **无服务器函数应用**"。</span><span class="sxs-lookup"><span data-stu-id="27997-105">Select the **Create a resource** button found on the upper left-hand corner of the Azure portal, and then select **Compute** > **Serverless Function App**.</span></span>

1. <span data-ttu-id="27997-106">输入下表中指定的 "函数应用设置"。</span><span class="sxs-lookup"><span data-stu-id="27997-106">Enter the function app settings as specified in the following table.</span></span>

    | <span data-ttu-id="27997-107">设置</span><span class="sxs-lookup"><span data-stu-id="27997-107">Setting</span></span>      | <span data-ttu-id="27997-108">值</span><span class="sxs-lookup"><span data-stu-id="27997-108">Value</span></span>  | <span data-ttu-id="27997-109">说明</span><span class="sxs-lookup"><span data-stu-id="27997-109">Description</span></span>                                        |
    | ------------ |  ------- | -------------------------------------------------- |
    | <span data-ttu-id="27997-110">**应用名称**</span><span class="sxs-lookup"><span data-stu-id="27997-110">**App name**</span></span> | <span data-ttu-id="27997-111">全局唯一名称</span><span class="sxs-lookup"><span data-stu-id="27997-111">Globally unique name</span></span> | <span data-ttu-id="27997-112">标识新的函数应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="27997-112">Name that identifies your new function app.</span></span> <span data-ttu-id="27997-113">有效的字符`a-z`为`0-9`、和`-`。</span><span class="sxs-lookup"><span data-stu-id="27997-113">Valid characters are `a-z`, `0-9`, and `-`.</span></span>  |
    | <span data-ttu-id="27997-114">**订购**</span><span class="sxs-lookup"><span data-stu-id="27997-114">**Subscription**</span></span> | <span data-ttu-id="27997-115">**Concierge 订阅**</span><span class="sxs-lookup"><span data-stu-id="27997-115">**Concierge Subscription**</span></span> | <span data-ttu-id="27997-116">在其下创建此新的函数应用程序的订阅。</span><span class="sxs-lookup"><span data-stu-id="27997-116">The subscription under which this new function app is created.</span></span> |
    | <span data-ttu-id="27997-117">**资源组**</span><span class="sxs-lookup"><span data-stu-id="27997-117">**Resource group**</span></span>|  <span data-ttu-id="27997-118">**<rgn>[沙盒资源组名称]</rgn>**</span><span class="sxs-lookup"><span data-stu-id="27997-118">**<rgn>[sandbox resource group name]</rgn>**</span></span> | <span data-ttu-id="27997-119">要在其中创建函数应用程序的资源组的名称。</span><span class="sxs-lookup"><span data-stu-id="27997-119">Name for the resource group in which to create your function app.</span></span><br/><br/><span data-ttu-id="27997-120">请确保选择 "**使用现有**", 并使用上一个练习中的资源组。</span><span class="sxs-lookup"><span data-stu-id="27997-120">Make sure to select **Use existing** and use the resource group from the last exercise.</span></span> <span data-ttu-id="27997-121">这样, 我们在此模块中进行的所有资源都将保留在一起。</span><span class="sxs-lookup"><span data-stu-id="27997-121">That way, all the resources we make in this module are kept together.</span></span> |
    | <span data-ttu-id="27997-122">**OS**</span><span class="sxs-lookup"><span data-stu-id="27997-122">**OS**</span></span> | <span data-ttu-id="27997-123">Windows</span><span class="sxs-lookup"><span data-stu-id="27997-123">Windows</span></span> | <span data-ttu-id="27997-124">承载函数应用程序的操作系统。</span><span class="sxs-lookup"><span data-stu-id="27997-124">The operating system that hosts the function app.</span></span>  |
    | <span data-ttu-id="27997-125">**托管计划**</span><span class="sxs-lookup"><span data-stu-id="27997-125">**Hosting Plan**</span></span> |   <span data-ttu-id="27997-126">消耗量计划</span><span class="sxs-lookup"><span data-stu-id="27997-126">Consumption plan</span></span> | <span data-ttu-id="27997-127">定义如何将资源分配给函数应用程序的托管计划。</span><span class="sxs-lookup"><span data-stu-id="27997-127">Hosting plan that defines how resources are allocated to your function app.</span></span> <span data-ttu-id="27997-128">在默认**消耗计划**中, 资源是根据所需的函数动态添加的。</span><span class="sxs-lookup"><span data-stu-id="27997-128">In the default **Consumption Plan**, resources are added dynamically as required by your functions.</span></span> <span data-ttu-id="27997-129">在此[无服务器](https://azure.microsoft.com/overview/serverless-computing/)托管中, 只需支付函数运行时间。</span><span class="sxs-lookup"><span data-stu-id="27997-129">In this [serverless](https://azure.microsoft.com/overview/serverless-computing/) hosting, you only pay for the time your functions run.</span></span>   |
    | <span data-ttu-id="27997-130">**Location**</span><span class="sxs-lookup"><span data-stu-id="27997-130">**Location**</span></span> | <span data-ttu-id="27997-131">选择以前使用过的相同位置。</span><span class="sxs-lookup"><span data-stu-id="27997-131">Select the same location you used earlier.</span></span> | <span data-ttu-id="27997-132">在你或附近的其他服务中选择你的函数访问权限附近或附近的区域。</span><span class="sxs-lookup"><span data-stu-id="27997-132">Choose a region near you or near other services your functions access.</span></span><br/><br/><span data-ttu-id="27997-133">选择在上一练习中创建文本分析 API 帐户时使用的相同区域。</span><span class="sxs-lookup"><span data-stu-id="27997-133">Select the same region that you used when creating the Text Analytics API account in the last exercise.</span></span> |
    | <span data-ttu-id="27997-134">**运行时堆栈**</span><span class="sxs-lookup"><span data-stu-id="27997-134">**Runtime Stack**</span></span> | <span data-ttu-id="27997-135">JavaScript</span><span class="sxs-lookup"><span data-stu-id="27997-135">JavaScript</span></span> | <span data-ttu-id="27997-136">此模块中的示例代码是用 JavaScript 编写的。</span><span class="sxs-lookup"><span data-stu-id="27997-136">The sample code in this module is written in JavaScript.</span></span>  |
    | <span data-ttu-id="27997-137">**Storage**</span><span class="sxs-lookup"><span data-stu-id="27997-137">**Storage**</span></span> |  <span data-ttu-id="27997-138">全局唯一名称</span><span class="sxs-lookup"><span data-stu-id="27997-138">Globally unique name</span></span> |  <span data-ttu-id="27997-139">您的函数应用程序使用的新存储帐户的名称。</span><span class="sxs-lookup"><span data-stu-id="27997-139">Name of the new storage account used by your function app.</span></span> <span data-ttu-id="27997-140">存储帐户名称的长度必须介于3到24个字符之间, 并且可以仅包含数字和小写字母。</span><span class="sxs-lookup"><span data-stu-id="27997-140">Storage account names must be between 3 and 24 characters in length and may contain numbers and lowercase letters only.</span></span> <span data-ttu-id="27997-141">此对话框使用唯一名称填充字段, 该名称派生自您赋予应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="27997-141">This dialog populates the field with a unique name that is derived from the name you gave the app.</span></span> <span data-ttu-id="27997-142">但是, 可以随意使用其他名称, 甚至可以使用现有帐户。</span><span class="sxs-lookup"><span data-stu-id="27997-142">However, feel free to use a different name or even an existing account.</span></span> |

1. <span data-ttu-id="27997-143">选择 "**创建**" 以设置和部署函数应用。</span><span class="sxs-lookup"><span data-stu-id="27997-143">Select **Create** to provision and deploy the function app.</span></span>

1. <span data-ttu-id="27997-144">选择门户右上角的通知图标, 并查看**正在进行的部署**消息。</span><span class="sxs-lookup"><span data-stu-id="27997-144">Select the Notification icon in the upper-right corner of the portal, and watch for a **Deployment in progress** message.</span></span>

1. <span data-ttu-id="27997-145">部署可能需要一些时间。</span><span class="sxs-lookup"><span data-stu-id="27997-145">Deployment can take some time.</span></span> <span data-ttu-id="27997-146">因此, 请停留在通知中心并观看 "**部署成功**" 消息。</span><span class="sxs-lookup"><span data-stu-id="27997-146">So, stay in the notification hub and  watch for a **Deployment succeeded** message.</span></span>

1. <span data-ttu-id="27997-147">部署函数应用后, 请转到门户中的**所有资源**。</span><span class="sxs-lookup"><span data-stu-id="27997-147">Once the function app is deployed, go to **All resources** in the portal.</span></span> <span data-ttu-id="27997-148">将使用 type **app Service**列出函数应用程序, 并为其赋予名称。</span><span class="sxs-lookup"><span data-stu-id="27997-148">The function app will be listed with type **App Service** and has the name you gave it.</span></span> <span data-ttu-id="27997-149">在列表中选择函数应用程序以将其打开。</span><span class="sxs-lookup"><span data-stu-id="27997-149">Select the function app in the list, to open it.</span></span>

    <span data-ttu-id="27997-150">!!</span><span class="sxs-lookup"><span data-stu-id="27997-150">Congratulations!</span></span> <span data-ttu-id="27997-151">您已创建并部署了函数应用程序。</span><span class="sxs-lookup"><span data-stu-id="27997-151">You've created and deployed your function app.</span></span>

> [!TIP]
> <span data-ttu-id="27997-152">在门户中查找您的函数应用程序时遇到问题？</span><span class="sxs-lookup"><span data-stu-id="27997-152">Having trouble finding your function apps in the portal?</span></span> <span data-ttu-id="27997-153">尝试[将 Function 应用添加到 Azure 门户中的收藏夹](https://docs.microsoft.com/azure/azure-functions/functions-how-to-use-azure-function-app-settings#favorite)。</span><span class="sxs-lookup"><span data-stu-id="27997-153">Try [adding Function Apps to your favorites in the Azure portal](https://docs.microsoft.com/azure/azure-functions/functions-how-to-use-azure-function-app-settings#favorite).</span></span>

## <a name="create-a-function-to-execute-our-logic"></a><span data-ttu-id="27997-154">创建用于执行逻辑的函数</span><span class="sxs-lookup"><span data-stu-id="27997-154">Create a function to execute our logic</span></span>

<span data-ttu-id="27997-155">现在我们有了函数应用程序, 现在是时候创建函数了。</span><span class="sxs-lookup"><span data-stu-id="27997-155">Now that we have a function app, it's time to create a function.</span></span> <span data-ttu-id="27997-156">通过触发器激活函数。</span><span class="sxs-lookup"><span data-stu-id="27997-156">A function is activated through a trigger.</span></span> <span data-ttu-id="27997-157">在本模块中, 我们将使用队列触发器。</span><span class="sxs-lookup"><span data-stu-id="27997-157">In this module, we'll use a Queue trigger.</span></span> <span data-ttu-id="27997-158">运行时将轮询队列, 并启动此函数以处理新邮件。</span><span class="sxs-lookup"><span data-stu-id="27997-158">The runtime will poll a queue and start this function to process a new message.</span></span>

1. <span data-ttu-id="27997-159">选择 "函数"**+** 旁边的 "添加\*\*\*\*" () 按钮。</span><span class="sxs-lookup"><span data-stu-id="27997-159">Select the Add (**+**) button next to **Functions**.</span></span> <span data-ttu-id="27997-160">此操作将启动函数创建过程。</span><span class="sxs-lookup"><span data-stu-id="27997-160">This action starts the function creation process.</span></span>

1. <span data-ttu-id="27997-161">在 "**适用于 JavaScript 的 Azure 函数-入门**" 页上, 选择 "**在门户中**", 然后选择 "**继续**"。</span><span class="sxs-lookup"><span data-stu-id="27997-161">On the **Azure Functions for JavaScript - getting started** page, select **In-portal** and then select **continue**.</span></span>

1. <span data-ttu-id="27997-162">在 "**创建函数**" 步骤中, 选择 "**更多模板 ...** ", 然后选择 "完成", 然后单击 "**查看模板**"。</span><span class="sxs-lookup"><span data-stu-id="27997-162">In the **Create a function** step, select **More templates...** and then select **Finish and view templates**.</span></span>

1. <span data-ttu-id="27997-163">在可用于此函数应用程序的所有模板的列表中, 选择 "**队列触发器**"。</span><span class="sxs-lookup"><span data-stu-id="27997-163">In the list of all templates available to this function app, select **Queue trigger** .</span></span>

1. <span data-ttu-id="27997-164">如果您看到一条消息, 指出**未安装扩展**, 请选择 "**安装**"。</span><span class="sxs-lookup"><span data-stu-id="27997-164">If you see a message saying  **Extensions not installed**, select **Install**.</span></span> <span data-ttu-id="27997-165">依赖项安装可能需要几分钟时间, 因此请耐心等待。</span><span class="sxs-lookup"><span data-stu-id="27997-165">Dependency installation can take a couple of minutes, so please be patient.</span></span> <span data-ttu-id="27997-166">等待安装完成, 然后再继续。</span><span class="sxs-lookup"><span data-stu-id="27997-166">Wait until the installation completes before continuing.</span></span>

1. <span data-ttu-id="27997-167">在出现的 "**新建函数**" 对话框中, 输入以下值。</span><span class="sxs-lookup"><span data-stu-id="27997-167">In the **New Function** dialog that appears, enter the following values.</span></span>

    |<span data-ttu-id="27997-168">属性</span><span class="sxs-lookup"><span data-stu-id="27997-168">Property</span></span>  |<span data-ttu-id="27997-169">值</span><span class="sxs-lookup"><span data-stu-id="27997-169">Value</span></span>  |
    |---------|---------|
    |<span data-ttu-id="27997-170">名称</span><span class="sxs-lookup"><span data-stu-id="27997-170">Name</span></span>     |   <span data-ttu-id="27997-171">**发现-看法-函数**</span><span class="sxs-lookup"><span data-stu-id="27997-171">**discover-sentiment-function**</span></span>      |
    |<span data-ttu-id="27997-172">队列名称</span><span class="sxs-lookup"><span data-stu-id="27997-172">Queue name</span></span>     |   <span data-ttu-id="27997-173">**新-反馈-q**</span><span class="sxs-lookup"><span data-stu-id="27997-173">**new-feedback-q**</span></span>      |
    |<span data-ttu-id="27997-174">存储帐户连接</span><span class="sxs-lookup"><span data-stu-id="27997-174">Storage account connection</span></span>        |  <span data-ttu-id="27997-175">**AzureWebJobsStorage**</span><span class="sxs-lookup"><span data-stu-id="27997-175">**AzureWebJobsStorage**</span></span>       |

1. <span data-ttu-id="27997-176">选择 "**创建**" 以开始函数创建过程。</span><span class="sxs-lookup"><span data-stu-id="27997-176">Select **Create** to begin the function creation process.</span></span>

1. <span data-ttu-id="27997-177">使用队列触发器函数模板, 以所选的语言创建函数。</span><span class="sxs-lookup"><span data-stu-id="27997-177">A function is created in your chosen language using the Queue Trigger function template.</span></span> <span data-ttu-id="27997-178">虽然我们将在本模块的 JavaScript 中实施函数, 但你可以使用任何支持的[语言](https://docs.microsoft.com/azure/azure-functions/supported-languages)创建函数。</span><span class="sxs-lookup"><span data-stu-id="27997-178">While we'll implement the function in JavaScript in this module, you can create a function in any [supported language](https://docs.microsoft.com/azure/azure-functions/supported-languages).</span></span>

<span data-ttu-id="27997-179">创建过程完成后, 代码编辑器将在门户中打开并加载*索引 .js*页。</span><span class="sxs-lookup"><span data-stu-id="27997-179">When the create process is complete, the code editor opens in the portal and loads the *index.js* page.</span></span> <span data-ttu-id="27997-180">此文件是编写函数逻辑的代码文件。</span><span class="sxs-lookup"><span data-stu-id="27997-180">This file is the code file where we write our function logic.</span></span>

## <a name="try-it-out"></a><span data-ttu-id="27997-181">试用</span><span class="sxs-lookup"><span data-stu-id="27997-181">Try it out</span></span>

<span data-ttu-id="27997-182">让我们测试到目前为止的内容。</span><span class="sxs-lookup"><span data-stu-id="27997-182">Let's test what we have so far.</span></span> <span data-ttu-id="27997-183">我们尚未编写任何代码, 因此此测试可确保运行我们目前配置的内容。</span><span class="sxs-lookup"><span data-stu-id="27997-183">We haven't written any code yet, so this test is to make sure what we've configured so far, runs.</span></span>

1. <span data-ttu-id="27997-184">在代码编辑器的顶部, 单击 "**运行**"。</span><span class="sxs-lookup"><span data-stu-id="27997-184">Click **Run** at the top of the code editor.</span></span>

1. <span data-ttu-id="27997-185">查看屏幕底部打开的 "**日志**" 选项卡。</span><span class="sxs-lookup"><span data-stu-id="27997-185">Observe the **Logs** tab that opens at the bottom of the screen.</span></span> <span data-ttu-id="27997-186">如果一切按计划工作, 您将看到类似于以下消息的消息。</span><span class="sxs-lookup"><span data-stu-id="27997-186">If everything works as planned, you'll see a message similar to the following message.</span></span>
    <span data-ttu-id="27997-187">![对我们的函数的成功调用的响应消息的屏幕截图。](../media/func-default-run.PNG)</span><span class="sxs-lookup"><span data-stu-id="27997-187">![Screenshot of response message of a successful call to our function.](../media/func-default-run.PNG)</span></span>

    <span data-ttu-id="27997-188">"**运行**" 按钮启动了函数并传递了*示例队列数据*, "**测试**请求" 窗口中的默认文本为函数。</span><span class="sxs-lookup"><span data-stu-id="27997-188">The **Run** button started our function and passed *sample queue data*, the default text from the **Test** request window to our function.</span></span>

<span data-ttu-id="27997-189">工作愉快!</span><span class="sxs-lookup"><span data-stu-id="27997-189">Nice work!</span></span> <span data-ttu-id="27997-190">您已成功向您的函数应用程序添加了队列触发的函数并进行了测试, 以确保它按预期工作!</span><span class="sxs-lookup"><span data-stu-id="27997-190">You've successfully added a Queue-triggered function to your function app and tested to make sure it's working as expected!</span></span> <span data-ttu-id="27997-191">在下一个练习中, 我们将向函数中添加更多功能。</span><span class="sxs-lookup"><span data-stu-id="27997-191">We'll add more functionality to the function in the next exercise.</span></span>

<span data-ttu-id="27997-192">让我们简单了解一下函数的其他文件 (即*函数 json*配置文件)。</span><span class="sxs-lookup"><span data-stu-id="27997-192">Let's look briefly at the function's other file, the *function.json* config file.</span></span> <span data-ttu-id="27997-193">此文件中的配置数据显示在以下 JSON 列表中。</span><span class="sxs-lookup"><span data-stu-id="27997-193">The configuration data from this file is shown in the following JSON listing.</span></span>

```json
{
  "bindings": [
    {
      "name": "myQueueItem",
      "type": "queueTrigger",
      "direction": "in",
      "queueName": "new-feedback-q",
      "connection": "AzureWebJobsDashboard"
    }
  ],
  "disabled": false
}
```

<span data-ttu-id="27997-194">您可以看到, 此函数具有一个名为**myQueueItem**的触发器绑定`queueTrigger`。</span><span class="sxs-lookup"><span data-stu-id="27997-194">As you can see, this function has a trigger binding named **myQueueItem** of type `queueTrigger`.</span></span> <span data-ttu-id="27997-195">当新邮件到达队列时, 我们已命名为 "**新反馈-q**", 我们的函数称为 "我们的函数"。</span><span class="sxs-lookup"><span data-stu-id="27997-195">When a new message arrives in the queue we've named **new-feedback-q**, our function is called.</span></span> <span data-ttu-id="27997-196">我们通过 myQueueItem 绑定参数引用新邮件。</span><span class="sxs-lookup"><span data-stu-id="27997-196">We reference the new message through the myQueueItem binding parameter.</span></span> <span data-ttu-id="27997-197">绑定实际上确实会为我们解决一些繁重的情况!</span><span class="sxs-lookup"><span data-stu-id="27997-197">Bindings really do take care of some of the heavy lifting for us!</span></span>

<span data-ttu-id="27997-198">在下一步中, 我们将添加代码以调用文本分析 API 服务。</span><span class="sxs-lookup"><span data-stu-id="27997-198">In the next step, we'll add code to call the Text Analytics API service.</span></span>

> [!TIP]
> <span data-ttu-id="27997-199">通过展开 Azure 门户中 "函数" 面板右侧的 "**查看文件**" 菜单, 可以看到 index .js 和函数 json。</span><span class="sxs-lookup"><span data-stu-id="27997-199">You can see index.js and function.json by expanding the **View Files** menu on the right of the function panel in the Azure portal.</span></span>

<span data-ttu-id="27997-200">此练习的功能是, 将我们的 Azure 函数基础结构设置到位。</span><span class="sxs-lookup"><span data-stu-id="27997-200">This exercise was all about getting our Azure Functions infrastructure in place.</span></span> <span data-ttu-id="27997-201">我们有一个在函数应用程序中托管的工作函数, 在新邮件到达我们已命名[!INCLUDE [input-q](./q-name-input.md)]的队列中时运行。</span><span class="sxs-lookup"><span data-stu-id="27997-201">We have a working function hosted in a function app that runs when a new message arrives in our queue that we've named [!INCLUDE [input-q](./q-name-input.md)].</span></span> <span data-ttu-id="27997-202">当我们添加代码以调用 Azure 认知服务进行看法分析时, 我们将从下一个练习开始使用真正的趣味。</span><span class="sxs-lookup"><span data-stu-id="27997-202">The real fun begins in the next exercise when we add code to call an Azure Cognitive Service to do sentiment analysis.</span></span>