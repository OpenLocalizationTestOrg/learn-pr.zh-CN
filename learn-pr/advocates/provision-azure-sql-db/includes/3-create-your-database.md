您的运输公司想要将其设置为与其他公司分开, 但不会损坏银行。 您必须有一个很好的句柄来设置数据库, 以提供最佳服务, 同时控制成本。

[!include[](../../../includes/azure-sandbox-activate.md)]

在这里, 你将了解:

- 创建 Azure SQL 数据库时需要考虑的注意事项, 其中包括:
  - 逻辑服务器如何充当数据库的管理容器。
  - 采购模型之间的差异。
  - 弹性池如何使您能够在数据库之间共享处理能力。
  - 排序规则如何影响数据的比较和排序方式。
- 如何从门户中引入 Azure SQL 数据库。
- 如何添加防火墙规则, 以便仅可从受信任的源访问数据库。

让我们快速看一下创建 Azure SQL 数据库时需要考虑的一些事项。

## <a name="one-server-many-databases"></a>一台服务器, 多个数据库

当您创建第一个 azure sql 数据库时, 还会创建一个_azure sql 逻辑服务器_。 将逻辑服务器视为数据库的管理容器。 您可以通过逻辑服务器控制登录、防火墙规则和安全策略。 您还可以在逻辑服务器中的每个数据库上覆盖这些策略。

目前, 只需要一个数据库。 但逻辑服务器使您能够在更高的更高版本中添加更多和优化所有数据库的性能。

## <a name="choose-performance-dtus-versus-vcores"></a>选择性能: dtu 和 vCores

Azure SQL 数据库有两个购买模型: DTU 和 vCore。

### <a name="what-are-dtus"></a>什么是 dtu？

DTU 代表数据库事务单元, 是计算、存储和 IO 资源的组合指标。 将 DTU 模型视为一个简单的预配置的 "购买" 选项。

由于您的逻辑服务器可以包含多个数据库, 因此也有 eDTUs 或弹性数据库事务单元的概念。 此选项使您能够选择一个价格, 但允许池中的每个数据库消耗较少或更多的资源, 具体取决于当前负载。

### <a name="what-are-vcores"></a>什么是 vCores？

vCore 使您可以更好地控制您为其创建和支付的计算和存储资源。

当 DTU 模型提供计算、存储和 IO 资源的固定组合时, vCore 模型使您能够单独配置资源。 例如, 使用 vCore 模型, 可以增加存储容量, 但可以保留现有的计算量和 IO 吞吐量。

您的运输和物流原型只需要一个 Azure SQL 数据库实例。 你可以决定使用 DTU 选项, 因为它能为计算、存储和 IO 性能提供很好的平衡, 并且入门成本较低。

## <a name="what-are-sql-elastic-pools"></a>什么是 SQL 弹性池？

创建 Azure sql 数据库时, 可以创建_SQL 弹性池_。

SQL 弹性池与 eDTUs 相关。 它们使您能够购买在池中的所有数据库之间共享的一组计算和存储资源。 每个数据库都可以使用所需的资源, 在设置的限制内, 具体取决于当前负载。

对于原型, 不需要 sql 弹性池, 因为只需要一个 sql 数据库。

## <a name="what-is-collation"></a>排序规则是什么？

排序规则是指对数据进行排序和比较的规则。 当区分大小写、重音标记和其他语言特征很重要时, 排序规则可帮助您定义排序规则。

现在, 我们来思考一下默认的排序规则 ( **SQL_Latin1_General_CP1_CI_AS**) 的含义。

- **Latin1_General**是指西方欧洲语言系列。
- **CP1**是指代码页 1252, 即拉丁字母的常见字符编码。
- **CI**意味着比较不区分大小写。 例如, "hello" 与 "hello" 比较相等。
- **这**意味着比较区分重音。 例如, "简历" 不会平均比较为 "resume"。

由于在如何对数据进行排序和比较方面没有具体的要求, 因此, 您可以选择默认的排序规则。

## <a name="create-your-azure-sql-database"></a>创建 Azure SQL 数据库

在这里, 你将设置数据库, 其中包括创建逻辑服务器。 您将选择支持您的运输物流应用程序的设置。 在实践中, 您将选择支持您正在构建的应用程序类型的设置。

随着时间的推移, 如果您意识到需要额外的计算能力来满足需求, 则可以调整性能选项, 甚至可以在 DTU 和 vCore 性能模型之间进行切换。

1. 使用与激活沙盒时相同的帐户登录[Azure 门户](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true)。

1. 从门户中, 单击 "从左上角**创建资源**"。 选择 "**数据库**", 然后选择 " **SQL 数据库**"。

   ![显示 "创建具有所选数据库的资源边栏" 部分并突出显示 "创建资源"、"数据库" 和 "SQL 数据库" 按钮的 Azure 门户屏幕截图。](../media/3-create-db.png)

1. 在 "**服务器**" 下, 单击 "**配置必需设置**", 填写表单, 然后单击 "**选择**"。 以下是有关如何填写表单的详细信息:

    | 设置      | 值 |
    | ------------ | ----- |
    | **服务器名称** | 一个全局唯一的[服务器名称](https://docs.microsoft.com/azure/architecture/best-practices/naming-conventions)。 |
    | **服务器管理员登录** | 充当主管理员登录名的[数据库标识符](https://docs.microsoft.com/sql/relational-databases/databases/database-identifiers)。 |
    | **Password** | 至少包含八个字符并包含三个类别中的字符的任何有效密码: 大写字符、小写字符、数字和非字母数字字符。 |
    | **Location** | 下面可用列表中的任何有效位置。 |

    [!include[](../../../includes/azure-sandbox-regions-first-mention-note-friendly.md)]

1. 单击 "**定价层**" 以指定服务层。 选择 "**基本**服务层", 然后单击 "**应用**"。

1. 使用这些值来填写表单的其余部分。

    | 设置      | 值 |
    | ------------ | ----- |
    | **数据库名称** | **事务** |
    | **订购** | 你的订阅 |
    | **资源组** |  使用现有组<rgn>[沙盒资源组名称]</rgn> |
    | **选择源** | **空数据库** |
    | **想要使用 SQL 弹性池吗？** | **不是现在** |
    | **排序** | **SQL_Latin1_General_CP1_CI_AS** |

1. 单击 "**创建**" 以创建 Azure SQL 数据库。

    > [!IMPORTANT]
    > 稍后请记住您的服务器名称、管理员登录名和密码。

1. 在工具栏上, 单击 "**通知**" 以监视部署过程。

在此过程完成后, 单击 "**固定到仪表板**" 将数据库服务器固定到仪表板, 以便您可以在以后需要时快速访问。

   ![显示 "通知" 菜单的 Azure 门户屏幕截图, 其中突出显示了最近一次部署成功消息中的 "Pin 到仪表板" 按钮。](../media/3-notifications-complete.png)

## <a name="set-the-server-firewall"></a>设置服务器防火墙

你的 Azure SQL 数据库现已启动并正在运行。 您可以通过多种方式来进一步配置、保护、监视和排除新数据库的故障。

您还可以指定哪些系统可以通过防火墙访问您的数据库。 最初, 防火墙会阻止从 Azure 外部访问您的数据库服务器。

对于原型, 只需从便携式计算机访问数据库即可。 稍后, 您可以对其他系统 (如移动应用程序) 进行白名单。

让你的开发计算机立即通过防火墙访问数据库。

1. 转到后勤数据库的概述边栏。 如果先前已固定数据库, 则可以单击仪表板上的**物流**磁贴以转到此处。

1. 单击 "**设置服务器防火墙**"。

    ![显示 SQL 数据库概述刀片的 Azure 门户屏幕截图, 其中突出显示了 "设置服务器防火墙" 按钮。](../media/3-set-server-firewall.png)

1. 单击 "**添加客户端 IP**"。

    ![显示 SQL 数据库防火墙设置刀片的 Azure 门户屏幕截图, 其中突出显示了 "添加客户端 IP" 按钮。](../media/3-add-client-ip.png)

1. 单击"保存"。

在下一部分中, 你将通过新数据库和 Azure 云命令行管理程序实现一些实际操作实践。 您将连接到数据库, 创建一个表, 添加一些示例数据, 并执行几个 SQL 语句。