有些应用程序对数据存储的要求比其他应用程序更多。 诸如 Dynamics CRM、Exchange Server、SAP Business Suite、SQL Server、Oracle 和 SharePoint 等应用程序需要持续较高的性能和低延迟才能正常运行。

创建虚拟机或添加新磁盘时, 有几种选择会对磁盘性能产生显著影响, 这从所选的存储_类型_开始。

## <a name="types-of-disks"></a>磁盘类型 
Azure 磁盘旨在实现 99.999% 的可用性。 

在创建磁盘时, 可以从以下三个存储层进行选择:--高级 SSD 磁盘、标准硬盘存储和标准 SSD。 根据 VM 大小, 可以混合和匹配这些磁盘类型。

### <a name="premium-ssd-disks"></a>高级 SSD 磁盘 

高级 SSD 磁盘通过固态驱动器 (ssd) 进行支持, 并为运行 i/o 密集型工作负载的 vm 提供高性能、低延迟磁盘支持。 由于这些驱动器没有移动部件, 因此这些驱动器的可靠性往往更高。 读取或写入头不必移动到磁盘上的正确位置即可查找请求的数据。 

您可以使用具有 VM 大小的高级 SSD 磁盘, 其中包含系列名称中的 "s"。 例如, 有**Dv3 系列**和**Dsv3 系列**, 则可以将**Dsv3 系列**用于高级 SSD 磁盘。

### <a name="standard-hdd-storage"></a>标准硬盘存储

标准 HDD 磁盘由传统硬盘 (hdd) 支持。 以比高级磁盘更低的速率对标准 HDD 磁盘进行记帐。 标准 HDD 磁盘可用于任何 VM 大小。

### <a name="standard-ssd"></a>标准 SSD

高级存储限制为特定的 VM 大小-因此创建的 VM 类型将影响存储功能: 大小、最大容量和存储类型。 如果你有一个低端 VM, 但需要 SSD 存储以实现 i/o 性能, 该怎么办？ 这就是标准 ssd 的用途。 标准的 ssd 介于标准 hdd 和 premium ssd 之间, 从性能和成本角度来看。

您可以使用具有任何 VM 大小的标准 ssd, 包括不支持高级存储的 vm 大小。 使用标准 ssd 是将 ssd 与这些虚拟机结合使用的唯一方法。 此磁盘类型仅在特定区域中可用, 且仅在_托管磁盘_上可用。

### <a name="unmanaged-versus-managed-disks"></a>非托管磁盘和托管磁盘

创建虚拟机或 vhd 时, 可以选择使用**非托管**磁盘或**托管**磁盘。

对于非托管磁盘, 您负责处理用于保存与您的 VM 磁盘对应的 vhd 的存储帐户。 您为所使用的空间量支付存储帐户费率。 一个存储帐户的速率限制为每秒20000个 i/o 操作数。这意味着单个存储帐户能够在完全限制的情况支持40标准虚拟硬盘。 如果需要向外扩展, 则需要多个存储帐户, 这可能会变得复杂。

托管磁盘是较新的**推荐磁盘存储模型**。 它们通过将管理存储帐户的负担放到 Azure 上来解决此复杂性。 elegantly 您可以指定磁盘类型, 磁盘和 Azure 的大小将创建并管理它使用的磁盘_和_存储。 您无需担心存储帐户限制, 这样就可以更轻松地向外扩展。下面是您通过旧的非托管磁盘获取的一些好处:

- **增强了可靠性**: azure 可确保与高可靠性虚拟机相关联的 vhd 放置在 Azure 存储的不同部分, 以提供类似的恢复级别。
- **更好的安全性**: 托管磁盘是资源组中的托管资源。 这意味着他们可以使用基于角色的访问控制来限制可处理 VHD 数据的人员。
- **快照支持**: 快照可用于创建 VHD 的只读副本。 您必须关闭拥有的 VM, 但创建快照只需几秒钟。 完成后, 您可以打开 vm 并使用快照创建一个重复的 vm 来解决生产问题, 或将 vm 回滚到拍摄快照的时间点。
- **备份支持**: 可以将托管磁盘自动备份到不同区域以使用 Azure 备份进行灾难恢复, 而不会影响 VM 的服务。

在所有其他优点 (包括有保证的性能特征) 中, 应始终为新的虚拟机选择托管磁盘。

### <a name="disk-comparison"></a>磁盘比较
下表提供了标准 HDD、标准 SSD 和高级 SSD 的比较, 以帮助您决定要使用的内容。

|    | Azure Premium 磁盘 |Azure 标准 SSD 磁盘 (预览)| Azure Standard HDD 磁盘 
|--- | ------------------ | ------------------------------- | ----------------------- 
| **磁盘类型** | 固态硬盘 (SSD) | 固态硬盘 (SSD) | 硬盘 (HDD)  
| **概述**  | 针对运行 IO 密集型工作负载或承载关键任务生产环境的 vm 的基于 SSD 的高性能、低延迟磁盘支持 |比 HDD 更一致的性能和可靠性。 针对低 IOPS 工作负载进行了优化| 基于 HDD 的经济高效磁盘, 用于不常用的访问
| **方案**  | 生产和性能敏感工作负载 |Web 服务器、使用频繁的企业应用程序和开发/测试| 备份、非关键、不常用的访问 
| **磁盘大小** | 32-4095 GiB | 128-4095 GiB | 32-4095 GiB 
| **每个磁盘的最大吞吐量** | 250 MiB/秒 | 最多 60 MiB/s | 最多 60 MiB/s 
| **每个磁盘的最大 IOPS** | 7500 IOPS | 最高达 500 IOPS | 最高达 500 IOPS 

下面提供了有关磁盘性能的更多详细信息。

## <a name="data-replication"></a>数据复制

将始终复制 Microsoft Azure 存储帐户中的数据, 以确保持久性和高可用性。 Azure 存储复制可复制你的数据, 以防止发生暂时硬件故障、网络或电源中断、自然灾害等的计划内和计划外事件。 您可以选择在同一个数据中心中复制数据, 在同一区域内的多个区域性数据中心之间进行复制, 甚至跨区域复制数据。 有四种类型的复制:

- **本地冗余存储 (LRS)** -azure 将数据复制到同一 azure 数据中心内。 如果节点出现故障, 数据仍然可用。 但是, 如果整个数据中心出现故障, 则数据可能不可用。
- **地域冗余存储 (GRS)** -Azure 将您的数据复制到距离主区域的几百英里之外的第二个区域。 如果你的存储帐户已启用 GRS, 则即使存在完整的区域中断或灾难 (主要区域不可恢复), 你的数据也是持久的。
- **读访问地域冗余存储 (RA-GRS)** -Azure 提供对辅助位置中的数据的只读访问, 以及跨两个区域的地域复制。 如果数据中心出现故障, 数据将保持可读但不能修改。
- **区域冗余存储 (ZRS)** -Azure 在单个区域中跨三个存储群集同步复制数据。 每个存储群集都与其他群集分开, 并驻留在其自己的可用性区域 (AZ) 中。 使用此类型的复制, 您仍可以在区域变得不可用时访问和管理数据。

标准存储帐户支持所有复制类型, 但高级存储帐户仅支持本地冗余存储 (LRS)。 由于 vm 本身在单个区域中运行, 因此此限制通常不是 VHD 存储的问题。

## <a name="disk-performance"></a>磁盘性能

磁盘的性能取决于所选磁盘的类型。 每个磁盘的每秒 i/o 操作数或 IOPS (明显为 "目视") 评定为一种特定的 i/o 操作数数。 此外, 每个驱动器都有吞吐量评级, 这决定了可以在一秒钟内读取或写入的数据量。 这两个组合决定了磁盘的速度。

使用标准存储, 每个磁盘最多可获得**500 IOPS 和 60 MB/秒**吞吐量 (甚至在 ssd 上)。 使用 "高级存储", IOPS 取决于所选的高级磁盘和 VM 大小。

|  | P4 | P6 | P10 | P20 | P30 | P40 | P50 |
|--|----|----|-----|-----|-----|-----|-----|
| **磁盘大小** | 32 GiB | 64 GiB | 128 GiB | 512 GiB | 1 TiB | 2 TiB | 4 TiB |
| **每个磁盘的最大 IOPS** | 120 | 240 | 500 | 2300 | 5000 | 7500 | 7500 |
| **每个磁盘的最大吞吐量** | 25 MB/秒 | 每秒 50 MB | 每秒 100 MB | 每秒 200 MB | 每秒 250 MB | 每秒 250 MB |

正如你所看到的, 你可以从**25 mb/s**和**120 iops**到**250 MB/秒**和**7500 IOPS**。