以下是我们将在本练习中构建的内容的高级别说明。

![显示 http 请求和响应以及各自的请求和反应绑定参数的默认 http 触发器的说明](../media/3-default-http-trigger-visual-small.PNG)

我们将创建一个函数, 该函数将在收到 HTTP 请求时启动, 并通过发送回邮件来响应每个请求。 参数`req` , 分别`res`是触发器绑定和输出绑定。

[!include[](../../../includes/azure-sandbox-activate.md)]

## <a name="create-a-function-app"></a>创建函数应用程序

我们来创建一个函数应用程序, 我们将在整个模块中使用它。 使用函数应用程序, 您可以将函数分组为逻辑单元, 以便更轻松地管理、部署和共享资源。

1. 使用与激活沙盒时相同的帐户登录[Azure 门户](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true)。

1. 选择 "**创建资源**" 按钮 (位于 Azure 门户的左上角), 然后选择 "**计算** > **函数应用**"。

1. 按如下所示设置 function app 属性:

    | 属性     | 建议值  | 说明  |
    |--------------|------------------|--------------|
    | **应用名称** | 全局唯一名称 | 标识新的函数应用程序的名称。 有效的字符`a-z`为`0-9`、和`-`。  |
    | **订购** | 你的订阅 | 在其下创建此新的函数应用程序的订阅。 |
    | **资源组**|  选择 "**使用现有**" 并选择 " _<rgn>[沙盒资源组名称]</rgn>_ " | 要在其中创建函数应用程序的资源组的名称。 |
    | **OS** | Windows | 承载函数应用程序的操作系统。  |
    | **托管计划** |   消耗量计划 | 定义如何将资源分配给函数应用程序的托管计划。 在默认**消耗计划**中, 资源是根据所需的函数动态添加的。 在此无服务器托管模型中, 只需支付函数运行时间。   |
    | **Location** | 从列表中选择 | 选择最接近的一个, 也可以是下面列出的允许的*沙盒区域*之一。 |
    | **运行时堆栈** | JavaScript | 此模块中的示例代码是用 JavaScript 编写的。  |
    | **Storage** |  全局唯一名称 |  您的函数应用程序使用的新存储帐户的名称。 存储帐户名称的长度必须介于3到24个字符之间, 并且可以仅包含数字和小写字母。 此对话框使用唯一名称填充字段, 该名称派生自您赋予应用程序的名称。 但是, 可以随意使用其他名称, 甚至可以使用现有帐户。 |

    ### <a name="sandbox-regions"></a>沙盒区域
    [!include[](../../../includes/azure-sandbox-regions-first-mention-note-friendly.md)]

1. 选择 "**创建**" 以设置和部署函数应用。

1. 选择门户右上角的通知图标, 并监视**正在进行**的、类似于以下消息的部署消息。

    ![正在进行函数应用部署的通知](../media/3-func-app-deploy-progress-small.PNG)

1. 部署可能需要一些时间。 因此, 请停留在通知中心并监视 "**部署已成功**" 消息 (类似于以下消息)。

    ![函数应用部署已完成的通知](../media/3-func-app-deploy-success-small.PNG)

 1. 部署函数应用后, 请转到门户中的**所有资源**。 将使用 type **app Service**列出函数应用程序, 并为其赋予名称。 从列表中选择函数应用程序以将其打开。

    >[!TIP]
    >如果在门户中查找函数应用程序时遇到问题, 请了解如何[将 function 应用程序添加到门户中的收藏夹中](https://docs.microsoft.com/azure/azure-functions/functions-how-to-use-azure-function-app-settings#favorite)。

## <a name="create-a-function"></a>创建函数

现在我们有了函数应用程序, 现在是时候创建函数了。 通过触发器激活函数。 在本模块中, 我们将使用 HTTP 触发器。

1. 选择 "函数"**+** 旁边的 "添加****" () 按钮。 此操作将启动函数创建过程。

1. 在 "**适用于 JavaScript 的 Azure 函数-入门**" 页上, 选择 "**在门户中**", 然后选择 "**继续**"。

1. 在 "**创建函数**" 步骤中, 选择 "**更多模板 ...** ", 然后选择 "完成", 然后单击 "**查看模板**"。

1. 在可用于此函数应用程序的所有模板的列表中, 选择 " **HTTP 触发器**"。

1. 在 "**新建函数**" 屏幕上, 更改名称 (如果需要), 将 "**授权级别**" 保留为 "_函数_", 然后单击 "**创建**"。

1. 在您的新函数中, 单击右上角的 " **</> Get 函数 URL** " 链接, 选择 " **default (功能键)**", 然后选择 "**复制**"。

1. 将复制的函数 URL 粘贴到浏览器的新选项卡的地址栏中。

1. 将查询字符串值`&name=Azure`添加到此 URL 的末尾, 然后按键盘上的 enter 键以执行请求。 您应该会看到类似于浏览器中显示的函数返回的以下响应。

    ```output
    <string xmlns="http://schemas.microsoft.com/2003/10/Serialization/">Hello Azure</string>
    ```

正如您在此练习中可以看到的, 在创建函数时, 您必须选择触发器类型。 每个函数都有一个且只有一个触发器。 在此示例中, 我们使用的是 http 触发器, 这意味着我们的函数将在收到 HTTP 请求时启动。 默认实现 (如 JavaScript 中的以下屏幕截图所示) 使用在请求的查询字符串或正文中收到的参数*名称*的值做出响应。 如果未提供任何字符串, 则函数将使用一条消息进行响应, 该消息会询问负责提供名称值的人的电话。

![HTTP 触发 Azure 函数的默认 JavaScript 实现](../media/3-default-http-trigger-implementation-small.PNG)

所有这些代码都位于此函数的文件夹中的**node.js**文件中。 让我们简单了解一下函数的其他文件 (即**函数 json**配置文件)。 以下 JSON 列表中显示了此配置数据。

```json
{
    "bindings": [
    {
        "authLevel": "function",
        "type": "httpTrigger",
        "direction": "in",
        "name": "req",
        "methods": [
        "get",
        "post"
        ]
    },
    {
        "type": "http",
        "direction": "out",
        "name": "res"
    }
    ],
    "disabled": false
}
```

正如您所看到的, 此函数具有一个名**** 为 "必需`httpTrigger` " 类型的触发器绑定和名为`HTTP`"类型" **res**的输出绑定。 在我们的函数的上述代码中, 我们看到我们如何通过我们的请求参数访问传入 HTTP 请求**** 的有效负载。 同样, 我们仅通过设置**res**参数发送了一个 HTTP 响应。 绑定实际上确实会为我们做一些繁重的提升。

>[!TIP]
>您可以通过展开 "**查看文件**" 菜单来查看**index .js**和**函数 json**文件, 当您选择了函数时, 将在屏幕右侧看到该菜单。 您可能需要向右滚动才能看到此菜单。

### <a name="explore-binding-types"></a>浏览绑定类型

1. 请注意, 在函数条目下有一组菜单项, 如以下屏幕截图所示。

    ![显示函数应用程序边栏中的函数下的菜单项的屏幕截图。](../media/3-func-menu-small.PNG)

1. 选择 "**集成**" 菜单项, 打开函数的 "集成" 选项卡。 如果你已与此设备一起关注, "集成" 选项卡应类似于以下屏幕截图。

    ![显示集成 UI 或选项卡的屏幕截图。](../media/3-func-integrate-tab-small.PNG)

    > [!NOTE]
    > 我们已经定义了触发器和输出绑定, 如屏幕截图中所示。 您可以看到, 我们无法添加多个__ 触发器。 事实上, 若要更改函数的触发器, 我们必须先删除触发器并创建一个新触发器。 但是, 此 UI 的**输入**和**输出**部分显示一个加号 (+) 以添加更多绑定, 因此我们可以接受多个输入值并发出多个输出值。

1. 在 "**输入**" 列下选择 " **+ 新建输入**"。 将显示所有可能的输入绑定类型的列表, 如下面的屏幕截图中所示。

    ![显示可能的输入绑定列表的屏幕截图。](../media/3-func-input-bindings-selector-small.PNG)

   请花点时间考虑一下每个输入绑定以及如何在解决方案中使用它们。 有很多可供选择。 此列表甚至可能在你阅读此模块时已发生更改, 因为我们继续支持更多数据源。

1. 我们将返回稍后在模块中添加输入绑定, 但现在, 请选择 "**取消**" 关闭此列表。

1. 在 "**输出**" 列下选择 " **+ 新输出**"。 将显示所有可能的输出绑定类型的列表, 如下面的屏幕截图中所示。

    ![显示可能的输出绑定列表的屏幕截图。](../media/3-func-output-bindings-selector-small.PNG)

   正如您所看到的, 有几种输出绑定类型可供您处置。 我们将返回稍后在模块中添加输出绑定, 但现在, 请选择 "**取消**" 关闭此列表。

到目前为止, 我们已经学习了如何创建函数应用程序并向其添加函数。 我们在操作中看到了一个简单的函数, 即在向其发出 HTTP 请求时运行的函数。 我们还探索了 Azure 门户 UI 以及可用于我们的函数的输入和输出绑定的类型。 在下一个单元中, 我们将使用输入绑定从数据库中读取文本。