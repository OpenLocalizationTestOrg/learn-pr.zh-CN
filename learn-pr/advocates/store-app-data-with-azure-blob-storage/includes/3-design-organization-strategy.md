<span data-ttu-id="9ab3a-101">在设计需要存储数据的应用程序时, 请务必考虑应用如何跨存储帐户、容器和 blob 组织数据。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-101">When designing an app that needs to store data, it's important to think about how the app is going to organize data across storage accounts, containers, and blobs.</span></span>

## <a name="storage-accounts"></a><span data-ttu-id="9ab3a-102">存储帐户</span><span class="sxs-lookup"><span data-stu-id="9ab3a-102">Storage accounts</span></span>

<span data-ttu-id="9ab3a-103">一个存储帐户非常灵活, 可以按自己的方式组织你的 blob, 但应根据需要使用其他存储帐户以逻辑方式区分成本并控制对数据的访问。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-103">A single storage account is flexible enough to organize your blobs however you like, but you should use additional storage accounts as necessary to logically separate costs and control access to data.</span></span>

## <a name="containers-and-blobs"></a><span data-ttu-id="9ab3a-104">容器和 blob</span><span class="sxs-lookup"><span data-stu-id="9ab3a-104">Containers and blobs</span></span>

<span data-ttu-id="9ab3a-105">应用程序的性质以及它存储的数据应驱动您命名和组织容器和 blob 的策略。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-105">The nature of your application and the data that it stores should drive your strategy for naming and organizing containers and blobs.</span></span>

<span data-ttu-id="9ab3a-106">使用 blob 作为包含数据库的存储方案的一部分的应用程序通常不需要很大程度上依赖组织、命名或元数据来指示有关其数据的任何信息。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-106">Apps using blobs as part of a storage scheme that includes a database often don't need to rely heavily on organization, naming, or metadata to indicate anything about their data.</span></span> <span data-ttu-id="9ab3a-107">此类应用通常将 guid (如 guid) 用作 blob 名称, 并在数据库记录中引用这些标识符。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-107">Such apps commonly use identifiers like GUIDs as blob names and reference these identifiers in database records.</span></span> <span data-ttu-id="9ab3a-108">应用程序将使用数据库来确定存储 blob 的位置以及它们所包含的数据类型。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-108">The app will use the database to determine where blobs are stored and the kind of data they contain.</span></span>

<span data-ttu-id="9ab3a-109">其他应用程序可能会像个人文件系统那样使用 Azure Blob 存储, 其中容器和 Blob 名称用于指示含义和结构。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-109">Other apps may use Azure Blob storage more like a personal file system, where container and blob names are used to indicate meaning and structure.</span></span> <span data-ttu-id="9ab3a-110">这些类型的应用程序中的 Blob 名称通常看起来像传统的文件名, 并包括文件`.jpg`扩展名 (如指明它们包含的数据类型)。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-110">Blob names in these kinds of apps will often look like traditional file names and include file name extensions like `.jpg` to indicate what kind of data they contain.</span></span> <span data-ttu-id="9ab3a-111">他们将使用虚拟目录 (如下所示) 来组织 blob, 并经常使用元数据标记存储 blob 和容器的相关信息。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-111">They'll use virtual directories (see below) to organize blobs and will frequently use metadata tags to store information about blobs and containers.</span></span>

<span data-ttu-id="9ab3a-112">在决定如何组织和存储 blob 和容器时, 需要考虑几个关键因素。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-112">There are a few key things to consider when deciding how to organize and store blobs and containers.</span></span>

### <a name="naming-limitations"></a><span data-ttu-id="9ab3a-113">命名限制</span><span class="sxs-lookup"><span data-stu-id="9ab3a-113">Naming limitations</span></span>

<span data-ttu-id="9ab3a-114">容器和 blob 名称必须符合一组规则, 包括长度限制和字符限制。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-114">Container and blob names must conform to a set of rules, including length limitations and character restrictions.</span></span> <span data-ttu-id="9ab3a-115">有关命名规则的更多具体信息, 请参阅本模块结尾部分的 "阅读" 部分。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-115">See the Further Reading section at the end of this module for more specific information about naming rules.</span></span>

### <a name="public-access-and-containers-as-security-boundaries"></a><span data-ttu-id="9ab3a-116">公共访问和容器作为安全边界</span><span class="sxs-lookup"><span data-stu-id="9ab3a-116">Public access and containers as security boundaries</span></span>

<span data-ttu-id="9ab3a-117">默认情况下, 所有 blob 都需要进行身份验证才能访问。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-117">By default, all blobs require authentication to access.</span></span> <span data-ttu-id="9ab3a-118">但是, 可以将各个容器配置为允许在不进行身份验证的情况下公共下载它们的 blob。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-118">However, individual containers can be configured to allow public downloading of their blobs without authentication.</span></span> <span data-ttu-id="9ab3a-119">此功能支持多种用例, 如托管静态网站资产和共享文件。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-119">This feature supports many use cases, such as hosting static website assets and sharing files.</span></span> <span data-ttu-id="9ab3a-120">这是因为下载 blob 内容的方式与通过 web 读取任何其他类型的数据的工作方式相同: 只需指向可在 blob URL 上发出 GET 请求的浏览器或任何内容。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-120">This is because downloading blob contents works the same way as reading any other kind of data over the web: you just point a browser or anything that can make a GET request at the blob URL.</span></span>

<span data-ttu-id="9ab3a-121">启用公共访问对于可伸缩性来说非常重要, 因为直接从 Blob 存储下载的数据不会在服务器端应用中生成任何流量。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-121">Enabling public access is important for scalability because data downloaded directly from Blob storage doesn't generate any traffic in your server-side app.</span></span> <span data-ttu-id="9ab3a-122">即使您不立即利用公共访问权限, 或者您将使用数据库来控制您的应用程序的数据访问, 也要计划对要公开提供的数据使用单独的容器。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-122">Even if you don't immediately take advantage of public access or if you will use a database to control data access via your application, plan on using separate containers for data you want to be publicly available.</span></span>

> [!CAUTION]
> <span data-ttu-id="9ab3a-123">为公共访问配置的容器中的 blob 可在不进行任何类型的身份验证或审核的情况下下载, 任何人都知道其存储 url。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-123">Blobs in a container configured for public access can be downloaded without any kind of authentication or auditing by anyone who knows their storage URLs.</span></span> <span data-ttu-id="9ab3a-124">从不将 blob 数据放在不打算公开共享的公共容器中。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-124">Never put blob data in a public container that you don't intend to share publicly.</span></span>

<span data-ttu-id="9ab3a-125">除了公共访问权限之外, Azure 还提供共享访问签名功能, 允许对容器进行细化权限控制。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-125">In addition to public access, Azure has a shared access signature feature that allows fine-grained permissions control on containers.</span></span> <span data-ttu-id="9ab3a-126">精度访问控制支持进一步提高可伸缩性的方案, 因此, 通常将容器视为安全边界是一项非常有用的指南。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-126">Precision access control enables scenarios that further improve scalability, so thinking about containers as security boundaries in general is a helpful guideline.</span></span>

### <a name="blob-name-prefixes-virtual-directories"></a><span data-ttu-id="9ab3a-127">Blob 名称前缀 (虚拟目录)</span><span class="sxs-lookup"><span data-stu-id="9ab3a-127">Blob name prefixes (virtual directories)</span></span>

<span data-ttu-id="9ab3a-128">从技术上讲, 容器是 "平面" 的, 不支持任何类型的嵌套或层次结构。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-128">Technically, containers are "flat" and do not support any kind of nesting or hierarchy.</span></span> <span data-ttu-id="9ab3a-129">但是, 如果您提供类似于文件路径 (如`finance/budgets/2017/q1.xls`) 的 blob 层次结构名称, 则 API 的列表操作可以将结果筛选为特定的前缀。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-129">But if you give your blobs hierarchical names that look like file paths (such as `finance/budgets/2017/q1.xls`), the API's listing operation can filter results to specific prefixes.</span></span> <span data-ttu-id="9ab3a-130">这使您可以像在文件和文件夹的分层系统中一样导航列表。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-130">This allows you to navigate the list as if it was a hierarchical system of files and folders.</span></span>

<span data-ttu-id="9ab3a-131">此功能通常称为 "*虚拟目录*", 因为某些工具和客户端库使用它来可视化和导航 Blob 存储, 就像它是一个文件系统一样。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-131">This feature is often called *virtual directories* because some tools and client libraries use it to visualize and navigate Blob storage as if it was a file system.</span></span> <span data-ttu-id="9ab3a-132">每个文件夹导航都会触发单独的调用, 以列出该文件夹中的 blob。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-132">Each folder navigation triggers a separate call to list the blobs in that folder.</span></span>

<span data-ttu-id="9ab3a-133">使用与 blob 的文件名类似的名称是组织和导航复杂 blob 数据的常用技术。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-133">Using names that are like file names for blobs is a common technique for organizing and navigating complex blob data.</span></span>

### <a name="blob-types"></a><span data-ttu-id="9ab3a-134">Blob 类型</span><span class="sxs-lookup"><span data-stu-id="9ab3a-134">Blob types</span></span>

<span data-ttu-id="9ab3a-135">可以将数据存储在三种不同类型的 blob 中:</span><span class="sxs-lookup"><span data-stu-id="9ab3a-135">There are three different kinds of blobs you can store data in:</span></span>

- <span data-ttu-id="9ab3a-136">**块 blob**由可独立和并行上载的不同大小的块组成。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-136">**Block blobs** are composed of blocks of different sizes that can be uploaded independently and in parallel.</span></span> <span data-ttu-id="9ab3a-137">对块 blob 的写入涉及到将数据上载到块并将其提交到 blob。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-137">Writing to a block blob involves uploading data to blocks and committing them to the blob.</span></span>
- <span data-ttu-id="9ab3a-138">**Append blob**是仅支持追加新数据 (不更新或删除现有数据) 的专用块 blob, 但它们的效率非常高。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-138">**Append blobs** are specialized block blobs that support only appending new data (not updating or deleting existing data), but they're very efficient at it.</span></span> <span data-ttu-id="9ab3a-139">Append blob 非常适合于存储日志或写入流式数据等方案。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-139">Append blobs are great for scenarios like storing logs or writing streamed data.</span></span>
- <span data-ttu-id="9ab3a-140">**页面 blob**专为涉及随机访问读取和写入的方案而设计。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-140">**Page blobs** are designed for scenarios that involve random-access reads and writes.</span></span> <span data-ttu-id="9ab3a-141">页面 blob 用于存储 Azure 虚拟机使用的虚拟硬盘 (VHD) 文件, 但它们非常适合涉及随机访问的任何场景。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-141">Page blobs are used to store the virtual hard disk (VHD) files used by Azure Virtual Machines, but they're great for any scenario that involves random access.</span></span>

<span data-ttu-id="9ab3a-142">对于大多数不专门调用 append 或 page blob 的方案, 块 blob 是最佳选择。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-142">Block blobs are the best choice for most scenarios that don't specifically call for append or page blobs.</span></span> <span data-ttu-id="9ab3a-143">其基于块的结构支持非常快的上载和下载, 并能够高效访问 blob 的各个片段。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-143">Their block-based structure supports very fast uploads and downloads and efficient access to individual pieces of a blob.</span></span> <span data-ttu-id="9ab3a-144">管理和提交块的过程是由大多数客户端库自动处理的, 而有些则还会处理并行上载和下载以最大限度地提高性能。</span><span class="sxs-lookup"><span data-stu-id="9ab3a-144">The process of managing and committing blocks is automatically handled by most client libraries, and some will also handle parallel uploads and downloads to maximize performance.</span></span>