在设计需要存储数据的应用程序时, 请务必考虑应用如何跨存储帐户、容器和 blob 组织数据。

## <a name="storage-accounts"></a>存储帐户

一个存储帐户非常灵活, 可以按自己的方式组织你的 blob, 但应根据需要使用其他存储帐户以逻辑方式区分成本并控制对数据的访问。

## <a name="containers-and-blobs"></a>容器和 blob

应用程序的性质以及它存储的数据应驱动您命名和组织容器和 blob 的策略。

使用 blob 作为包含数据库的存储方案的一部分的应用程序通常不需要很大程度上依赖组织、命名或元数据来指示有关其数据的任何信息。 此类应用通常将 guid (如 guid) 用作 blob 名称, 并在数据库记录中引用这些标识符。 应用程序将使用数据库来确定存储 blob 的位置以及它们所包含的数据类型。

其他应用程序可能会像个人文件系统那样使用 Azure Blob 存储, 其中容器和 Blob 名称用于指示含义和结构。 这些类型的应用程序中的 Blob 名称通常看起来像传统的文件名, 并包括文件`.jpg`扩展名 (如指明它们包含的数据类型)。 他们将使用虚拟目录 (如下所示) 来组织 blob, 并经常使用元数据标记存储 blob 和容器的相关信息。

在决定如何组织和存储 blob 和容器时, 需要考虑几个关键因素。

### <a name="naming-limitations"></a>命名限制

容器和 blob 名称必须符合一组规则, 包括长度限制和字符限制。 有关命名规则的更多具体信息, 请参阅本模块结尾部分的 "阅读" 部分。

### <a name="public-access-and-containers-as-security-boundaries"></a>公共访问和容器作为安全边界

默认情况下, 所有 blob 都需要进行身份验证才能访问。 但是, 可以将各个容器配置为允许在不进行身份验证的情况下公共下载它们的 blob。 此功能支持多种用例, 如托管静态网站资产和共享文件。 这是因为下载 blob 内容的方式与通过 web 读取任何其他类型的数据的工作方式相同: 只需指向可在 blob URL 上发出 GET 请求的浏览器或任何内容。

启用公共访问对于可伸缩性来说非常重要, 因为直接从 Blob 存储下载的数据不会在服务器端应用中生成任何流量。 即使您不立即利用公共访问权限, 或者您将使用数据库来控制您的应用程序的数据访问, 也要计划对要公开提供的数据使用单独的容器。

> [!CAUTION]
> 为公共访问配置的容器中的 blob 可在不进行任何类型的身份验证或审核的情况下下载, 任何人都知道其存储 url。 从不将 blob 数据放在不打算公开共享的公共容器中。

除了公共访问权限之外, Azure 还提供共享访问签名功能, 允许对容器进行细化权限控制。 精度访问控制支持进一步提高可伸缩性的方案, 因此, 通常将容器视为安全边界是一项非常有用的指南。

### <a name="blob-name-prefixes-virtual-directories"></a>Blob 名称前缀 (虚拟目录)

从技术上讲, 容器是 "平面" 的, 不支持任何类型的嵌套或层次结构。 但是, 如果您提供类似于文件路径 (如`finance/budgets/2017/q1.xls`) 的 blob 层次结构名称, 则 API 的列表操作可以将结果筛选为特定的前缀。 这使您可以像在文件和文件夹的分层系统中一样导航列表。

此功能通常称为 "*虚拟目录*", 因为某些工具和客户端库使用它来可视化和导航 Blob 存储, 就像它是一个文件系统一样。 每个文件夹导航都会触发单独的调用, 以列出该文件夹中的 blob。

使用与 blob 的文件名类似的名称是组织和导航复杂 blob 数据的常用技术。

### <a name="blob-types"></a>Blob 类型

可以将数据存储在三种不同类型的 blob 中:

- **块 blob**由可独立和并行上载的不同大小的块组成。 对块 blob 的写入涉及到将数据上载到块并将其提交到 blob。
- **Append blob**是仅支持追加新数据 (不更新或删除现有数据) 的专用块 blob, 但它们的效率非常高。 Append blob 非常适合于存储日志或写入流式数据等方案。
- **页面 blob**专为涉及随机访问读取和写入的方案而设计。 页面 blob 用于存储 Azure 虚拟机使用的虚拟硬盘 (VHD) 文件, 但它们非常适合涉及随机访问的任何场景。

对于大多数不专门调用 append 或 page blob 的方案, 块 blob 是最佳选择。 其基于块的结构支持非常快的上载和下载, 并能够高效访问 blob 的各个片段。 管理和提交块的过程是由大多数客户端库自动处理的, 而有些则还会处理并行上载和下载以最大限度地提高性能。