<span data-ttu-id="09070-101">在将本地服务器迁移到 Azure 时, 需要进行规划和维护。</span><span class="sxs-lookup"><span data-stu-id="09070-101">Performing a migration of on-premises servers to Azure requires planning and care.</span></span> <span data-ttu-id="09070-102">您可以一次移动所有内容, 或者更可能的是小批量甚至单独移动。</span><span class="sxs-lookup"><span data-stu-id="09070-102">You can move them all at once, or more likely, in small batches or even individually.</span></span> <span data-ttu-id="09070-103">在创建单个 VM 之前, 您应该坐下来, 草拟出您的当前基础结构模型, 并查看它如何映射到云。</span><span class="sxs-lookup"><span data-stu-id="09070-103">Before you create a single VM, you should sit down and sketch out your current infrastructure model and see how it might map to the cloud.</span></span>

#### <a name="required-resources-for-iaas-virtual-machines"></a><span data-ttu-id="09070-104">IaaS 虚拟机所需的资源</span><span class="sxs-lookup"><span data-stu-id="09070-104">Required resources for IaaS Virtual Machines</span></span>

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RWjVUg]

<span data-ttu-id="09070-105">我们来演练一下要考虑的事项清单。</span><span class="sxs-lookup"><span data-stu-id="09070-105">Let's walk through a checklist of things to think about.</span></span>

- <span data-ttu-id="09070-106">从网络开始</span><span class="sxs-lookup"><span data-stu-id="09070-106">Start with the network</span></span>
- <span data-ttu-id="09070-107">命名虚拟机</span><span class="sxs-lookup"><span data-stu-id="09070-107">Name the VM</span></span>
- <span data-ttu-id="09070-108">确定虚拟机的位置</span><span class="sxs-lookup"><span data-stu-id="09070-108">Decide the location for the VM</span></span>
- <span data-ttu-id="09070-109">确定虚拟机的大小</span><span class="sxs-lookup"><span data-stu-id="09070-109">Determine the size of the VM</span></span>
- <span data-ttu-id="09070-110">了解定价模型</span><span class="sxs-lookup"><span data-stu-id="09070-110">Understanding the pricing model</span></span>
- <span data-ttu-id="09070-111">虚拟机的存储</span><span class="sxs-lookup"><span data-stu-id="09070-111">Storage for the VM</span></span>
- <span data-ttu-id="09070-112">选择操作系统</span><span class="sxs-lookup"><span data-stu-id="09070-112">Select an operating system</span></span>

## <a name="start-with-the-network"></a><span data-ttu-id="09070-113">从网络开始</span><span class="sxs-lookup"><span data-stu-id="09070-113">Start with the network</span></span>

<span data-ttu-id="09070-114">您应考虑的第一件事是, 虚拟机不是虚拟机的网络。</span><span class="sxs-lookup"><span data-stu-id="09070-114">The first thing you should think about isn't the virtual machine at all - it's the network.</span></span>

<span data-ttu-id="09070-115">虚拟网络 (vnet) 在 azure 中用于提供 azure 虚拟机和其他 azure 服务之间的专用连接。</span><span class="sxs-lookup"><span data-stu-id="09070-115">Virtual networks (VNets) are used in Azure to provide private connectivity between Azure Virtual Machines and other Azure services.</span></span> <span data-ttu-id="09070-116">属于同一虚拟网络的 vm 和服务可以访问另一个虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="09070-116">VMs and services that are part of the same virtual network can access one another.</span></span> <span data-ttu-id="09070-117">默认情况下, 虚拟网络外部的服务无法连接到虚拟网络中的服务。</span><span class="sxs-lookup"><span data-stu-id="09070-117">By default, services outside the virtual network cannot connect to services within the virtual network.</span></span> <span data-ttu-id="09070-118">但是, 可以将网络配置为允许访问外部服务, 包括本地服务器。</span><span class="sxs-lookup"><span data-stu-id="09070-118">You can, however, configure the network to allow access to the external service, including your on-premises servers.</span></span>

<span data-ttu-id="09070-119">这一点是为什么你应花一些时间思考你的网络配置的原因。</span><span class="sxs-lookup"><span data-stu-id="09070-119">This latter point is why you should spend some time thinking about your network configuration.</span></span> <span data-ttu-id="09070-120">一旦设置了网络地址和子网并将其设置为将专用公司网络连接到 Azure 服务, 则需要确保在将任何 vm 放置到位之前考虑拓扑。</span><span class="sxs-lookup"><span data-stu-id="09070-120">Network addresses and subnets are not trivial to change once you have them set up, and if you plan to connect your private company network to the Azure services, you will want to make sure you consider the topology before putting any VMs into place.</span></span>

<span data-ttu-id="09070-121">设置虚拟网络时, 请指定可用的地址空间、子网和安全性。</span><span class="sxs-lookup"><span data-stu-id="09070-121">When you set up a virtual network, you specify the available address spaces, subnets, and security.</span></span> <span data-ttu-id="09070-122">如果 VNet 将连接到其他 vnet, 则必须选择不重叠的地址范围。</span><span class="sxs-lookup"><span data-stu-id="09070-122">If the VNet will be connected to other VNets, you must select address ranges that are not overlapping.</span></span> <span data-ttu-id="09070-123">这是你的网络中的虚拟机和服务可以使用的专用地址范围。</span><span class="sxs-lookup"><span data-stu-id="09070-123">This is the range of private addresses that the VMs and services in your network can use.</span></span> <span data-ttu-id="09070-124">您可以使用 unrouteable IP 地址 (如 10.0.0.0/8、172.16.0.0/12 或 192.168.0.0/16) 或定义自己的范围。</span><span class="sxs-lookup"><span data-stu-id="09070-124">You can use unrouteable IP addresses such as 10.0.0.0/8, 172.16.0.0/12, or 192.168.0.0/16, or define your own range.</span></span> <span data-ttu-id="09070-125">如果仅在 VNet、相互连接的 vnet 和内部部署位置中可访问任何地址范围, 则 Azure 会将其视为专用 VNet IP 地址空间的一部分。</span><span class="sxs-lookup"><span data-stu-id="09070-125">Azure will treat any address range as part of the private VNet IP address space if it is only reachable within the VNet, within interconnected VNets, and from your on-premises location.</span></span> <span data-ttu-id="09070-126">如果其他人负责内部网络, 则应在选择地址空间之前与此人合作, 以确保没有重叠, 并让他们知道要使用的空间, 以便它们不会尝试使用相同范围的 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="09070-126">If someone else is responsible for the internal networks, you should work with that person before selecting your address space to make sure there is no overlap and to let them know what space you want to use, so they don’t try to use the same range of IP addresses.</span></span>

### <a name="segregate-your-network"></a><span data-ttu-id="09070-127">隔离网络</span><span class="sxs-lookup"><span data-stu-id="09070-127">Segregate your network</span></span>

<span data-ttu-id="09070-128">在确定虚拟网络地址空间之后, 可以为虚拟网络创建一个或多个子网。</span><span class="sxs-lookup"><span data-stu-id="09070-128">After deciding the virtual network address space(s), you can create one or more subnets for your virtual network.</span></span> <span data-ttu-id="09070-129">这样做是为了将网络分成更易于管理的部分。</span><span class="sxs-lookup"><span data-stu-id="09070-129">You do this to break up your network into more manageable sections.</span></span> <span data-ttu-id="09070-130">例如, 您可以将10.1.0.0 分配给 vm、10.2.0.0 到后端服务和10.3.0.0 到 SQL Server 虚拟机。</span><span class="sxs-lookup"><span data-stu-id="09070-130">For example, you might assign 10.1.0.0 to VMs, 10.2.0.0 to back-end services, and 10.3.0.0 to SQL Server VMs.</span></span>

> [!NOTE]
> <span data-ttu-id="09070-131">Azure 在每个子网中保留前四个地址和最后一个地址供其使用。</span><span class="sxs-lookup"><span data-stu-id="09070-131">Azure reserves the first four addresses and the last address in each subnet for its use.</span></span>

### <a name="secure-the-network"></a><span data-ttu-id="09070-132">保护网络</span><span class="sxs-lookup"><span data-stu-id="09070-132">Secure the network</span></span>

<span data-ttu-id="09070-133">默认情况下, 子网之间没有安全边界, 因此这些子网中的每个子网中的服务可以相互对话。</span><span class="sxs-lookup"><span data-stu-id="09070-133">By default, there is no security boundary between subnets, so services in each of these subnets can talk to one another.</span></span> <span data-ttu-id="09070-134">但是, 您可以设置网络安全组 (NSGs), 以便控制进出子网以及从 vm 到之间的通信流。</span><span class="sxs-lookup"><span data-stu-id="09070-134">However, you can set up Network Security Groups (NSGs), which allow you to control the traffic flow to and from subnets and to and from VMs.</span></span> <span data-ttu-id="09070-135">NSGs 充当软件防火墙, 将自定义规则应用于网络接口和子网级别的每个入站或出站请求。</span><span class="sxs-lookup"><span data-stu-id="09070-135">NSGs act as software firewalls, applying custom rules to each inbound or outbound request at the network interface and subnet level.</span></span> <span data-ttu-id="09070-136">这使您可以完全控制传入或传出 VM 的每个网络请求。</span><span class="sxs-lookup"><span data-stu-id="09070-136">This allows you to fully control every network request coming in or out of the VM.</span></span>

## <a name="plan-each-vm-deployment"></a><span data-ttu-id="09070-137">规划每个 VM 部署</span><span class="sxs-lookup"><span data-stu-id="09070-137">Plan each VM deployment</span></span>

<span data-ttu-id="09070-138">一旦您映射了通信和网络要求, 就可以开始考虑要创建的虚拟机。</span><span class="sxs-lookup"><span data-stu-id="09070-138">Once you have mapped out your communication and network requirements, you can start thinking about the VMs you want to create.</span></span> <span data-ttu-id="09070-139">一个理想的计划是选择服务器并进行清点:</span><span class="sxs-lookup"><span data-stu-id="09070-139">A good plan is to select a server and take an inventory:</span></span>

- <span data-ttu-id="09070-140">服务器与之通信的是什么？</span><span class="sxs-lookup"><span data-stu-id="09070-140">What does the server communicate with?</span></span>
- <span data-ttu-id="09070-141">哪些端口是打开的？</span><span class="sxs-lookup"><span data-stu-id="09070-141">Which ports are open?</span></span>
- <span data-ttu-id="09070-142">使用哪种 OS？</span><span class="sxs-lookup"><span data-stu-id="09070-142">Which OS is used?</span></span>
- <span data-ttu-id="09070-143">使用了多少磁盘空间？</span><span class="sxs-lookup"><span data-stu-id="09070-143">How much disk space is in use?</span></span>
- <span data-ttu-id="09070-144">这将使用哪种类型的数据？</span><span class="sxs-lookup"><span data-stu-id="09070-144">What kind of data does this use?</span></span> <span data-ttu-id="09070-145">在内部部署中是否有限制 (法律或其他) 限制？</span><span class="sxs-lookup"><span data-stu-id="09070-145">Are there restrictions (legal or otherwise) with not having it on-premises?</span></span>
- <span data-ttu-id="09070-146">服务器有什么类型的 CPU、内存和磁盘 i/o 负载？</span><span class="sxs-lookup"><span data-stu-id="09070-146">What sort of CPU, memory, and disk I/O load does the server have?</span></span> <span data-ttu-id="09070-147">是否有要考虑的突发流量流量？</span><span class="sxs-lookup"><span data-stu-id="09070-147">Is there burst traffic to account for?</span></span>

<span data-ttu-id="09070-148">接下来, 我们可以开始回答 Azure 将为新的虚拟机提供的一些问题。</span><span class="sxs-lookup"><span data-stu-id="09070-148">We can then start to answer some of the questions Azure will have for a new virtual machine.</span></span>

### <a name="name-the-vm"></a><span data-ttu-id="09070-149">命名虚拟机</span><span class="sxs-lookup"><span data-stu-id="09070-149">Name the VM</span></span>

<span data-ttu-id="09070-150">一件信息人员通常不会将大量想法放入虚拟机的**名称**。</span><span class="sxs-lookup"><span data-stu-id="09070-150">One piece of information people often don't put much thought into is the **name** of the VM.</span></span> <span data-ttu-id="09070-151">虚拟机名称将用作计算机名称, 该名称被配置为操作系统的一部分。</span><span class="sxs-lookup"><span data-stu-id="09070-151">The VM name is used as the computer name, which is configured as part of the operating system.</span></span> <span data-ttu-id="09070-152">您可以在 Linux vm 上的 Windows vm 和64字符上指定最长为15个字符的名称。</span><span class="sxs-lookup"><span data-stu-id="09070-152">You can specify a name of up to 15 characters on a Windows VM and 64 characters on a Linux VM.</span></span>

<span data-ttu-id="09070-153">此名称还定义了一个可管理的**Azure 资源**, 在以后更改时并不容易这样做。</span><span class="sxs-lookup"><span data-stu-id="09070-153">This name also defines a manageable **Azure resource**, and it's not trivial to change later.</span></span> <span data-ttu-id="09070-154">这意味着您应选择有意义且一致的名称, 这样您就可以轻松地识别 VM 的功能。</span><span class="sxs-lookup"><span data-stu-id="09070-154">That means you should choose names that are meaningful and consistent, so you can easily identify what the VM does.</span></span> <span data-ttu-id="09070-155">一个很棒的约定是在名称中包含以下信息:</span><span class="sxs-lookup"><span data-stu-id="09070-155">A good convention is to include the following information in the name:</span></span>

| <span data-ttu-id="09070-156">元素</span><span class="sxs-lookup"><span data-stu-id="09070-156">Element</span></span> | <span data-ttu-id="09070-157">示例</span><span class="sxs-lookup"><span data-stu-id="09070-157">Example</span></span> | <span data-ttu-id="09070-158">Notes</span><span class="sxs-lookup"><span data-stu-id="09070-158">Notes</span></span> |
| --- | --- | --- |
| <span data-ttu-id="09070-159">环境</span><span class="sxs-lookup"><span data-stu-id="09070-159">Environment</span></span> |<span data-ttu-id="09070-160">开发、生产、QA</span><span class="sxs-lookup"><span data-stu-id="09070-160">dev, prod, QA</span></span> |<span data-ttu-id="09070-161">标识资源的环境</span><span class="sxs-lookup"><span data-stu-id="09070-161">Identifies the environment for the resource</span></span> |
| <span data-ttu-id="09070-162">位置</span><span class="sxs-lookup"><span data-stu-id="09070-162">Location</span></span> |<span data-ttu-id="09070-163">uw (美国西部), ue (美国东部)</span><span class="sxs-lookup"><span data-stu-id="09070-163">uw (US West), ue (US East)</span></span> |<span data-ttu-id="09070-164">标识资源的部署区域</span><span class="sxs-lookup"><span data-stu-id="09070-164">Identifies the region into which the resource is deployed</span></span> |
| <span data-ttu-id="09070-165">情况</span><span class="sxs-lookup"><span data-stu-id="09070-165">Instance</span></span> |<span data-ttu-id="09070-166">01, 02</span><span class="sxs-lookup"><span data-stu-id="09070-166">01, 02</span></span> |<span data-ttu-id="09070-167">对于具有多个命名实例 (web 服务器等) 的资源</span><span class="sxs-lookup"><span data-stu-id="09070-167">For resources that have more than one named instance (web servers, etc.)</span></span> |
| <span data-ttu-id="09070-168">产品或服务</span><span class="sxs-lookup"><span data-stu-id="09070-168">Product or Service</span></span> |<span data-ttu-id="09070-169">服务台</span><span class="sxs-lookup"><span data-stu-id="09070-169">service</span></span> |<span data-ttu-id="09070-170">标识资源支持的产品、应用程序或服务</span><span class="sxs-lookup"><span data-stu-id="09070-170">Identifies the product, application, or service that the resource supports</span></span> |
| <span data-ttu-id="09070-171">Role</span><span class="sxs-lookup"><span data-stu-id="09070-171">Role</span></span> |<span data-ttu-id="09070-172">sql、web、消息传递</span><span class="sxs-lookup"><span data-stu-id="09070-172">sql, web, messaging</span></span> |<span data-ttu-id="09070-173">标识关联资源的角色</span><span class="sxs-lookup"><span data-stu-id="09070-173">Identifies the role of the associated resource</span></span> | 

<span data-ttu-id="09070-174">例如, `devusc-webvm01`可能表示第一个开发 web 服务器托管在美国南部的中央位置。</span><span class="sxs-lookup"><span data-stu-id="09070-174">For example, `devusc-webvm01` might represent the first development web server hosted in the US South Central location.</span></span> 

#### <a name="what-is-an-azure-resource"></a><span data-ttu-id="09070-175">什么是 Azure 资源？</span><span class="sxs-lookup"><span data-stu-id="09070-175">What is an Azure resource?</span></span>

<span data-ttu-id="09070-176">**azure 资源**是 azure 中可管理的项。</span><span class="sxs-lookup"><span data-stu-id="09070-176">An **Azure resource** is a manageable item in Azure.</span></span> <span data-ttu-id="09070-177">就像您的数据中心中的物理计算机一样, vm 具有完成其工作所需的多个元素:</span><span class="sxs-lookup"><span data-stu-id="09070-177">Just like a physical computer in your datacenter, VMs have several elements that are needed to do their job:</span></span>

- <span data-ttu-id="09070-178">VM 本身</span><span class="sxs-lookup"><span data-stu-id="09070-178">The VM itself</span></span>
- <span data-ttu-id="09070-179">磁盘的存储帐户</span><span class="sxs-lookup"><span data-stu-id="09070-179">Storage account for the disks</span></span>
- <span data-ttu-id="09070-180">虚拟网络 (与其他 vm 和服务共享)</span><span class="sxs-lookup"><span data-stu-id="09070-180">Virtual network (shared with other VMs and services)</span></span>
- <span data-ttu-id="09070-181">网络上进行通信的网络接口</span><span class="sxs-lookup"><span data-stu-id="09070-181">Network interface to communicate on the network</span></span>
- <span data-ttu-id="09070-182">用于保护网络流量的网络安全组</span><span class="sxs-lookup"><span data-stu-id="09070-182">Network Security Group(s) to secure the network traffic</span></span>
- <span data-ttu-id="09070-183">公共 Internet 地址 (可选)</span><span class="sxs-lookup"><span data-stu-id="09070-183">Public Internet address (optional)</span></span>

<span data-ttu-id="09070-184">Azure 将创建所有这些资源 (如有必要), 也可以将现有资源作为部署过程的一部分提供。</span><span class="sxs-lookup"><span data-stu-id="09070-184">Azure will create all of these resources if necessary, or you can supply existing ones as part of the deployment process.</span></span> <span data-ttu-id="09070-185">每个资源都需要一个将用于标识它的名称。</span><span class="sxs-lookup"><span data-stu-id="09070-185">Each resource needs a name that will be used to identify it.</span></span> <span data-ttu-id="09070-186">如果 Azure 创建资源, 它将使用 VM 名称生成资源名称-与你的 VM 名称非常一致的另一个理由!</span><span class="sxs-lookup"><span data-stu-id="09070-186">If Azure creates the resource, it will use the VM name to generate a resource name - another reason to be very consistent with your VM names!</span></span>

### <a name="decide-the-location-for-the-vm"></a><span data-ttu-id="09070-187">确定虚拟机的位置</span><span class="sxs-lookup"><span data-stu-id="09070-187">Decide the location for the VM</span></span>

<span data-ttu-id="09070-188">Azure 在世界各地的数据中心都充满了服务器和磁盘。</span><span class="sxs-lookup"><span data-stu-id="09070-188">Azure has datacenters all over the world filled with servers and disks.</span></span> <span data-ttu-id="09070-189">这些数据中心分为地理_区域_("West US"、"北欧"、"东南部亚洲" 等), 以提供冗余和可用性。</span><span class="sxs-lookup"><span data-stu-id="09070-189">These datacenters are grouped into geographic _regions_ ('West US', 'North Europe', 'Southeast Asia', etc.) to provide redundancy and availability.</span></span>

<span data-ttu-id="09070-190">在创建和部署虚拟机时, 必须选择要分配资源 (CPU、存储等) 的区域。</span><span class="sxs-lookup"><span data-stu-id="09070-190">When you create and deploy a virtual machine, you must select a region where you want the resources (CPU, storage, etc.) to be allocated.</span></span> <span data-ttu-id="09070-191">这样, 你就可以将 vm 尽可能地接近你的用户, 以提高性能并满足任何法律、合规性或税款要求。</span><span class="sxs-lookup"><span data-stu-id="09070-191">This lets you place your VMs as close as possible to your users to improve performance and to meet any legal, compliance, or tax requirements.</span></span>

<span data-ttu-id="09070-192">有关位置选择, 需要考虑的两个问题。</span><span class="sxs-lookup"><span data-stu-id="09070-192">Two other things to think about regarding the location choice.</span></span> <span data-ttu-id="09070-193">首先, 位置可以限制可用的选项。</span><span class="sxs-lookup"><span data-stu-id="09070-193">First, the location can limit your available options.</span></span> <span data-ttu-id="09070-194">每个区域都有不同的可用硬件, 并且某些配置在所有区域中均不可用。</span><span class="sxs-lookup"><span data-stu-id="09070-194">Each region has different hardware available and some configurations are not available in all regions.</span></span> <span data-ttu-id="09070-195">其次, 位置之间存在价格差异。</span><span class="sxs-lookup"><span data-stu-id="09070-195">Second, there are price differences between locations.</span></span> <span data-ttu-id="09070-196">如果工作负载未绑定到特定位置, 则在多个区域中检查所需的配置以找出最低价格可能会非常经济高效。</span><span class="sxs-lookup"><span data-stu-id="09070-196">If your workload isn't bound to a specific location, it can be very cost effective to check your required configuration in multiple regions to find the lowest price.</span></span>

### <a name="determine-the-size-of-the-vm"></a><span data-ttu-id="09070-197">确定虚拟机的大小</span><span class="sxs-lookup"><span data-stu-id="09070-197">Determine the size of the VM</span></span>

<span data-ttu-id="09070-198">一旦设置了名称和位置, 您需要决定 VM 的大小。</span><span class="sxs-lookup"><span data-stu-id="09070-198">Once you have the name and location set, you need to decide on the size of your VM.</span></span> <span data-ttu-id="09070-199">Azure 提供了不同的_VM 大小_, 而不是单独指定处理能力、内存和存储容量, 而是以不同大小提供这些元素的变体。</span><span class="sxs-lookup"><span data-stu-id="09070-199">Rather than specify processing power, memory, and storage capacity independently, Azure provides different _VM sizes_ that offer variations of these elements in different sizes.</span></span> <span data-ttu-id="09070-200">Azure 提供了多种 VM 大小选项, 使您可以为您要执行的操作选择适当的计算、内存和存储组合。</span><span class="sxs-lookup"><span data-stu-id="09070-200">Azure provides a wide range of VM size options allowing you to select the appropriate mix of compute, memory, and storage for what you want to do.</span></span>

<span data-ttu-id="09070-201">确定合适的 vm 大小的最佳方法是考虑 vm 需要运行的工作负荷类型。</span><span class="sxs-lookup"><span data-stu-id="09070-201">The best way to determine the appropriate VM size is to consider the type of workload your VM needs to run.</span></span> <span data-ttu-id="09070-202">根据工作负载, 你可以从可用 VM 大小的子集中进行选择。</span><span class="sxs-lookup"><span data-stu-id="09070-202">Based on the workload, you're able to choose from a subset of available VM sizes.</span></span> <span data-ttu-id="09070-203">工作负荷选项在 Azure 上分为以下几种:</span><span class="sxs-lookup"><span data-stu-id="09070-203">Workload options are classified as follows on Azure:</span></span>

| <span data-ttu-id="09070-204">可选</span><span class="sxs-lookup"><span data-stu-id="09070-204">Option</span></span>              | <span data-ttu-id="09070-205">说明</span><span class="sxs-lookup"><span data-stu-id="09070-205">Description</span></span> |
|---------------------|-------------|
| <span data-ttu-id="09070-206">**常规用途**</span><span class="sxs-lookup"><span data-stu-id="09070-206">**General purpose**</span></span> | <span data-ttu-id="09070-207">通用虚拟机旨在实现平衡 CPU 与内存的比率。</span><span class="sxs-lookup"><span data-stu-id="09070-207">General-purpose VMs are designed to have a balanced CPU-to-memory ratio.</span></span> <span data-ttu-id="09070-208">是测试和开发的理想选择、中小型数据库和低到中型流量的 web 服务器。</span><span class="sxs-lookup"><span data-stu-id="09070-208">Ideal for testing and development, small to medium databases, and low to medium traffic web servers.</span></span> |
| <span data-ttu-id="09070-209">**计算优化**</span><span class="sxs-lookup"><span data-stu-id="09070-209">**Compute optimized**</span></span> | <span data-ttu-id="09070-210">计算优化的虚拟机旨在使 CPU 与内存的比率较高。</span><span class="sxs-lookup"><span data-stu-id="09070-210">Compute optimized VMs are designed to have a high CPU-to-memory ratio.</span></span> <span data-ttu-id="09070-211">适用于中型流量 web 服务器、网络设备、批处理过程和应用程序服务器。</span><span class="sxs-lookup"><span data-stu-id="09070-211">Suitable for medium traffic web servers, network appliances, batch processes, and application servers.</span></span> |
| <span data-ttu-id="09070-212">**内存优化**</span><span class="sxs-lookup"><span data-stu-id="09070-212">**Memory optimized**</span></span> | <span data-ttu-id="09070-213">内存优化的虚拟机旨在实现高内存到 CPU 的比率。</span><span class="sxs-lookup"><span data-stu-id="09070-213">Memory optimized VMs are designed to have a high memory-to-CPU ratio.</span></span> <span data-ttu-id="09070-214">非常适合于关系数据库服务器、大中型缓存和内存中的分析。</span><span class="sxs-lookup"><span data-stu-id="09070-214">Great for relational database servers, medium to large caches, and in-memory analytics.</span></span> |
| <span data-ttu-id="09070-215">**存储优化**</span><span class="sxs-lookup"><span data-stu-id="09070-215">**Storage optimized**</span></span> | <span data-ttu-id="09070-216">存储优化的虚拟机旨在实现高磁盘吞吐量和 IO。</span><span class="sxs-lookup"><span data-stu-id="09070-216">Storage optimized VMs are designed to have high disk throughput and IO.</span></span> <span data-ttu-id="09070-217">是运行数据库的虚拟机的理想选择。</span><span class="sxs-lookup"><span data-stu-id="09070-217">Ideal for VMs running databases.</span></span> |
| <span data-ttu-id="09070-218">**GPU**</span><span class="sxs-lookup"><span data-stu-id="09070-218">**GPU**</span></span> | <span data-ttu-id="09070-219">GPU 虚拟机是专门针对较重的图形呈现和视频编辑的专用虚拟机。</span><span class="sxs-lookup"><span data-stu-id="09070-219">GPU VMs are specialized virtual machines targeted for heavy graphics rendering and video editing.</span></span> <span data-ttu-id="09070-220">这些虚拟机是使用深入学习的模型培训和 inferencing 的理想选项。</span><span class="sxs-lookup"><span data-stu-id="09070-220">These VMs are ideal options for model training and inferencing with deep learning.</span></span> |
| <span data-ttu-id="09070-221">**高性能计算**</span><span class="sxs-lookup"><span data-stu-id="09070-221">**High performance computes**</span></span> | <span data-ttu-id="09070-222">高性能计算是具有可选高吞吐量网络接口的速度最快且功能最强大的 CPU 虚拟机。</span><span class="sxs-lookup"><span data-stu-id="09070-222">High performance compute is the fastest and most powerful CPU virtual machines with optional high-throughput network interfaces.</span></span> |

<span data-ttu-id="09070-223">当您在 Azure 中配置 VM 大小时, 您可以筛选工作负载类型。</span><span class="sxs-lookup"><span data-stu-id="09070-223">You're able to filter on the workload type when you configure the VM size in the Azure.</span></span> <span data-ttu-id="09070-224">您选择的大小会直接影响服务的成本。</span><span class="sxs-lookup"><span data-stu-id="09070-224">The size you choose directly affects the cost of your service.</span></span> <span data-ttu-id="09070-225">您需要的 CPU、内存和 GPU 越多, 价格点就越高。</span><span class="sxs-lookup"><span data-stu-id="09070-225">The more CPU, memory, and GPU you need, the higher the price point.</span></span>

### <a name="what-if-my-size-needs-change"></a><span data-ttu-id="09070-226">如果我的大小需要更改, 该怎么办？</span><span class="sxs-lookup"><span data-stu-id="09070-226">What if my size needs change?</span></span>

<span data-ttu-id="09070-227">当现有的大小不再满足您的需求时, Azure 允许您更改 VM 大小。</span><span class="sxs-lookup"><span data-stu-id="09070-227">Azure allows you to change the VM size when the existing size no longer meets your needs.</span></span> <span data-ttu-id="09070-228">您可以升级或降级虚拟机-只要新大小允许使用当前硬件配置。</span><span class="sxs-lookup"><span data-stu-id="09070-228">You can upgrade or downgrade the VM - as long as your current hardware configuration is allowed in the new size.</span></span> <span data-ttu-id="09070-229">这为 VM 管理提供了完全灵活且灵活的方法。</span><span class="sxs-lookup"><span data-stu-id="09070-229">This provides a fully agile and elastic approach to VM management.</span></span>

<span data-ttu-id="09070-230">vm 的大小可以在运行 vm 时更改, 只要新大小在运行虚拟机的当前硬件群集中可用。</span><span class="sxs-lookup"><span data-stu-id="09070-230">The VM size can be changed while the VM is running, as long as the new size is available in the current hardware cluster the VM is running on.</span></span> <span data-ttu-id="09070-231">Azure 门户仅显示可用的大小选择, 从而使这一点显而易见。</span><span class="sxs-lookup"><span data-stu-id="09070-231">The Azure portal makes this obvious by only showing you available size choices.</span></span> <span data-ttu-id="09070-232">如果尝试将 VM 大小调整为不可用的大小, 则命令行工具将报告错误。</span><span class="sxs-lookup"><span data-stu-id="09070-232">The command line tools will report an error if you attempt to resize a VM to an unavailable size.</span></span> <span data-ttu-id="09070-233">更改正在运行的 VM 大小将自动重新启动计算机以完成请求。</span><span class="sxs-lookup"><span data-stu-id="09070-233">Changing a running VM size will automatically reboot the machine to complete the request.</span></span>

<span data-ttu-id="09070-234">如果您停止并取消分配 vm, 则可以选择任何在您的区域中可用的大小, 因为这会从运行它的群集中删除你的 vm。</span><span class="sxs-lookup"><span data-stu-id="09070-234">If you stop and deallocate the VM, you can then select any size available in your region since this removes your VM from the cluster it was running on.</span></span>

> [!WARNING]
> <span data-ttu-id="09070-235">请注意调整生产虚拟机的大小-将自动重新启动, 这可能会导致临时中断并更改某些配置设置 (如 IP 地址)。</span><span class="sxs-lookup"><span data-stu-id="09070-235">Be careful about resizing production VMs - they will be rebooted automatically which can cause a temporary outage and change some configuration settings such as the IP address.</span></span>

### <a name="understanding-the-pricing-model"></a><span data-ttu-id="09070-236">了解定价模型</span><span class="sxs-lookup"><span data-stu-id="09070-236">Understanding the pricing model</span></span>

<span data-ttu-id="09070-237">对于每个 VM, 订阅将收取两个独立的开销: 计算和存储。</span><span class="sxs-lookup"><span data-stu-id="09070-237">There are two separate costs the subscription will be charged for every VM: compute and storage.</span></span> <span data-ttu-id="09070-238">通过将这些成本分开, 可以独立地扩展它们, 并仅支付所需的费用。</span><span class="sxs-lookup"><span data-stu-id="09070-238">By separating these costs, you scale them independently and only pay for what you need.</span></span>

<span data-ttu-id="09070-239">**计算成本**-计算费用以每小时为单位定价, 但以每分钟为单位收费。</span><span class="sxs-lookup"><span data-stu-id="09070-239">**Compute costs** - Compute expenses are priced on a per-hour basis but billed on a per-minute basis.</span></span> <span data-ttu-id="09070-240">例如, 如果 VM 部署的时间为55分钟, 则仅收取55分钟的使用率。</span><span class="sxs-lookup"><span data-stu-id="09070-240">For example, you are only charged for 55 minutes of usage if the VM is deployed for 55 minutes.</span></span> <span data-ttu-id="09070-241">如果你停止并取消分配 VM, 则不会对计算容量收费, 因为这将释放硬件。</span><span class="sxs-lookup"><span data-stu-id="09070-241">You are not charged for compute capacity if you stop and deallocate the VM since this releases the hardware.</span></span> <span data-ttu-id="09070-242">每小时价格根据您选择的 VM 大小和 OS 而有所不同。</span><span class="sxs-lookup"><span data-stu-id="09070-242">The hourly price varies based on the VM size and OS you select.</span></span> <span data-ttu-id="09070-243">VM 的成本包括 Windows 操作系统的费用。</span><span class="sxs-lookup"><span data-stu-id="09070-243">The cost for a VM includes the charge for the Windows operating system.</span></span> <span data-ttu-id="09070-244">基于 Linux 的实例成本更低, 因为没有操作系统许可证费用。</span><span class="sxs-lookup"><span data-stu-id="09070-244">Linux-based instances are cheaper because there is no operating system license charge.</span></span>

> [!TIP]
> <span data-ttu-id="09070-245">通过使用具有**Azure 混合优势**的 Windows 现有许可证, 可以节省资金。</span><span class="sxs-lookup"><span data-stu-id="09070-245">You might be able to save money by reusing existing licenses for Windows with the **Azure Hybrid benefit**.</span></span>

<span data-ttu-id="09070-246">**存储成本**-为 VM 使用的存储单独收取费用。</span><span class="sxs-lookup"><span data-stu-id="09070-246">**Storage costs** - You are charged separately for the storage the VM uses.</span></span> <span data-ttu-id="09070-247">VM 的状态与将导致的存储费用无关;即使 vm 已停止/解除分配且你不会对正在运行的 VM 计费, 你也需要为磁盘使用的存储付费。</span><span class="sxs-lookup"><span data-stu-id="09070-247">The status of the VM has no relation to the storage charges that will be incurred; even if the VM is stopped/deallocated and you aren’t billed for the running VM, you will be charged for the storage used by the disks.</span></span>

<span data-ttu-id="09070-248">你可以从两个付款选项中选择用于计算成本。</span><span class="sxs-lookup"><span data-stu-id="09070-248">You're able to choose from two payment options for compute costs.</span></span>

| <span data-ttu-id="09070-249">可选</span><span class="sxs-lookup"><span data-stu-id="09070-249">Option</span></span> | <span data-ttu-id="09070-250">说明</span><span class="sxs-lookup"><span data-stu-id="09070-250">Description</span></span> |
|--------|-------------|
| <span data-ttu-id="09070-251">**开始时付费**</span><span class="sxs-lookup"><span data-stu-id="09070-251">**Pay as you go**</span></span> | <span data-ttu-id="09070-252">使用 "**即点即**用" 选项, 可以按第二个计算容量付费, 而无需长期承诺或前期付款。</span><span class="sxs-lookup"><span data-stu-id="09070-252">With the **pay-as-you-go** option, you pay for compute capacity by the second, with no long-term commitment or upfront payments.</span></span> <span data-ttu-id="09070-253">您可以根据需要增加或减少计算容量, 也可以随时启动或停止计算。</span><span class="sxs-lookup"><span data-stu-id="09070-253">You're able to increase or decrease compute capacity on demand as well as start or stop at any time.</span></span> <span data-ttu-id="09070-254">如果运行的应用程序具有不能中断的短期或不可预知的工作负载, 则首选此选项。</span><span class="sxs-lookup"><span data-stu-id="09070-254">Prefer this option if you run applications with short-term or unpredictable workloads that cannot be interrupted.</span></span> <span data-ttu-id="09070-255">例如, 如果您正在执行快速测试或在 VM 中开发应用程序, 则可以选择此选项。</span><span class="sxs-lookup"><span data-stu-id="09070-255">For example, if you are doing a quick test, or developing an app in a VM, this would be the appropriate option.</span></span> |
| <span data-ttu-id="09070-256">**保留的虚拟机实例**</span><span class="sxs-lookup"><span data-stu-id="09070-256">**Reserved Virtual Machine Instances**</span></span> | <span data-ttu-id="09070-257">保留的虚拟机实例 (RI) 选项是在指定区域中的一到三年的虚拟机的提前购买。</span><span class="sxs-lookup"><span data-stu-id="09070-257">The Reserved Virtual Machine Instances (RI) option is an advance purchase of a virtual machine for one or three years in a specified region.</span></span> <span data-ttu-id="09070-258">承诺的提前和回报, 与按即点即用定价相比, 价格节省了 72%。</span><span class="sxs-lookup"><span data-stu-id="09070-258">The commitment is made up front, and in return, you get up to 72% price savings compared to pay-as-you-go pricing.</span></span> <span data-ttu-id="09070-259">**RIs**非常灵活, 可以轻松地交换或返回, 以获得提前终止费用。</span><span class="sxs-lookup"><span data-stu-id="09070-259">**RIs** are flexible and can easily be exchanged or returned for an early termination fee.</span></span> <span data-ttu-id="09070-260">如果 VM 必须连续运行, 或者需要预算可预测性,**并且**您可以至少在一年中使用虚拟机, 则首选此选项。</span><span class="sxs-lookup"><span data-stu-id="09070-260">Prefer this option if the VM has to run continuously, or you need budget predictability, **and** you can commit to using the VM for at least a year.</span></span> |

### <a name="storage-for-the-vm"></a><span data-ttu-id="09070-261">虚拟机的存储</span><span class="sxs-lookup"><span data-stu-id="09070-261">Storage for the VM</span></span>

<span data-ttu-id="09070-262">所有 Azure 虚拟机都至少有两个虚拟硬盘 (vhd)。</span><span class="sxs-lookup"><span data-stu-id="09070-262">All Azure virtual machines will have at least two virtual hard disks (VHDs).</span></span> <span data-ttu-id="09070-263">第一个磁盘存储操作系统, 第二个磁盘用作临时存储。</span><span class="sxs-lookup"><span data-stu-id="09070-263">The first disk stores the operating system, and the second is used as temporary storage.</span></span> <span data-ttu-id="09070-264">您可以添加其他磁盘来存储应用程序数据;最大数量由 VM 大小选择 (每个 CPU 通常为两个) 决定。</span><span class="sxs-lookup"><span data-stu-id="09070-264">You can add additional disks to store application data; the maximum number is determined by the VM size selection (typically two per CPU).</span></span> <span data-ttu-id="09070-265">创建一个或多个数据磁盘很常见, 尤其是因为 OS 磁盘往往相当小。</span><span class="sxs-lookup"><span data-stu-id="09070-265">It's common to create one or more data disks, particularly since the OS disk tends to be quite small.</span></span> <span data-ttu-id="09070-266">此外, 将数据分离到不同的 vhd 允许您单独管理磁盘的安全性、可靠性和性能。</span><span class="sxs-lookup"><span data-stu-id="09070-266">Also, separating out the data to different VHDs allows you to manage the security, reliability, and performance of the disk independently.</span></span>

<span data-ttu-id="09070-267">每个 VHD 的数据都以页面 blob 的形式保存在**azure 存储**中, 从而允许 Azure 仅为你使用的存储分配空间。</span><span class="sxs-lookup"><span data-stu-id="09070-267">The data for each VHD is held in **Azure Storage** as page blobs, which allows Azure to allocate space only for the storage you use.</span></span> <span data-ttu-id="09070-268">它也是存储成本的度量方式;您为要使用的存储付费。</span><span class="sxs-lookup"><span data-stu-id="09070-268">It's also how your storage cost is measured; you pay for the storage you are consuming.</span></span>

#### <a name="what-is-azure-storage"></a><span data-ttu-id="09070-269">什么是 Azure 存储？</span><span class="sxs-lookup"><span data-stu-id="09070-269">What is Azure Storage?</span></span>

<span data-ttu-id="09070-270">Azure 存储是 Microsoft 基于云的数据存储解决方案。</span><span class="sxs-lookup"><span data-stu-id="09070-270">Azure Storage is Microsoft's cloud-based data storage solution.</span></span> <span data-ttu-id="09070-271">它支持几乎任何类型的数据, 并提供对存储数据的安全性、冗余和可缩放的访问。</span><span class="sxs-lookup"><span data-stu-id="09070-271">It supports almost any type of data and provides security, redundancy, and scalable access to the stored data.</span></span> <span data-ttu-id="09070-272">存储帐户为特定订阅提供对 Azure 存储中的对象的访问权限。</span><span class="sxs-lookup"><span data-stu-id="09070-272">A storage account provides access to objects in Azure Storage for a specific subscription.</span></span> <span data-ttu-id="09070-273">虚拟机始终具有一个或多个存储帐户, 用于保存每个附加的虚拟磁盘。</span><span class="sxs-lookup"><span data-stu-id="09070-273">VMs always have one or more storage accounts to hold each attached virtual disk.</span></span>

<span data-ttu-id="09070-274">可以通过**标准**或**高级**存储帐户来支持虚拟磁盘。</span><span class="sxs-lookup"><span data-stu-id="09070-274">Virtual disks can be backed by either **Standard** or **Premium** Storage accounts.</span></span> <span data-ttu-id="09070-275">Azure Premium 存储利用固态驱动器 (ssd) 为运行 i/o 密集型工作负荷的 vm 启用高性能和低延迟。</span><span class="sxs-lookup"><span data-stu-id="09070-275">Azure Premium Storage leverages solid-state drives (SSDs) to enable high performance and low latency for VMs running I/O-intensive workloads.</span></span> <span data-ttu-id="09070-276">将 Azure Premium 存储用于生产工作负载, 尤其是那些对性能变体或 i/o 密集型的敏感存储。</span><span class="sxs-lookup"><span data-stu-id="09070-276">Use Azure Premium Storage for production workloads, especially those that are sensitive to performance variations or are I/O intensive.</span></span> <span data-ttu-id="09070-277">对于开发或测试, 标准存储是完好的。</span><span class="sxs-lookup"><span data-stu-id="09070-277">For development or testing, Standard storage is fine.</span></span>

<span data-ttu-id="09070-278">创建磁盘时, 有两个选项可用于管理存储帐户和每个 VHD 之间的关系。</span><span class="sxs-lookup"><span data-stu-id="09070-278">When you create disks, you will have two options for managing the relationship between the storage account and each VHD.</span></span> <span data-ttu-id="09070-279">可以选择 "**非托管磁盘**" 或 "**托管磁盘**"。</span><span class="sxs-lookup"><span data-stu-id="09070-279">You can choose either **unmanaged disks** or **managed disks**.</span></span>

| <span data-ttu-id="09070-280">可选</span><span class="sxs-lookup"><span data-stu-id="09070-280">Option</span></span> | <span data-ttu-id="09070-281">说明</span><span class="sxs-lookup"><span data-stu-id="09070-281">Description</span></span> |
|--------|-------------|
| <span data-ttu-id="09070-282">**非托管磁盘**</span><span class="sxs-lookup"><span data-stu-id="09070-282">**Unmanaged disks**</span></span> | <span data-ttu-id="09070-283">对于非托管磁盘, 您负责处理用于保存与您的 VM 磁盘对应的 vhd 的存储帐户。</span><span class="sxs-lookup"><span data-stu-id="09070-283">With unmanaged disks, you are responsible for the storage accounts that are used to hold the VHDs that correspond to your VM disks.</span></span> <span data-ttu-id="09070-284">您为所使用的空间量支付存储帐户费率。</span><span class="sxs-lookup"><span data-stu-id="09070-284">You pay the storage account rates for the amount of space you use.</span></span> <span data-ttu-id="09070-285">一个存储帐户具有每秒 20000 i/o 操作数的固定速率限制。这意味着存储帐户能够以充分利用的方式支持40标准虚拟硬盘。</span><span class="sxs-lookup"><span data-stu-id="09070-285">A single storage account has a fixed-rate limit of 20,000 I/O operations/sec. This means that a storage account is capable of supporting 40 standard virtual hard disks at full utilization.</span></span> <span data-ttu-id="09070-286">如果需要向外扩展更多磁盘, 则需要更多的存储帐户, 这可能会变得复杂。</span><span class="sxs-lookup"><span data-stu-id="09070-286">If you need to scale out with more disks, then you'll need more storage accounts, which can get complicated.</span></span> |
| <span data-ttu-id="09070-287">**托管磁盘**</span><span class="sxs-lookup"><span data-stu-id="09070-287">**Managed disks**</span></span> | <span data-ttu-id="09070-288">托管磁盘是**较新的推荐磁盘存储模型**。</span><span class="sxs-lookup"><span data-stu-id="09070-288">Managed disks are the **newer and recommended disk storage model**.</span></span> <span data-ttu-id="09070-289">它们通过将管理存储帐户的负担放到 Azure 上来解决此复杂性。 elegantly</span><span class="sxs-lookup"><span data-stu-id="09070-289">They elegantly solve this complexity by putting the burden of managing the storage accounts onto Azure.</span></span> <span data-ttu-id="09070-290">您可以指定磁盘的大小 (最大为 4 TB), 并且 Azure 将创建和管理磁盘_和_存储。</span><span class="sxs-lookup"><span data-stu-id="09070-290">You specify the size of the disk, up to 4 TB, and Azure creates and manages both the disk _and_ the storage.</span></span> <span data-ttu-id="09070-291">您无需担心存储帐户限制, 这将使托管磁盘更易于扩展。</span><span class="sxs-lookup"><span data-stu-id="09070-291">You don't have to worry about storage account limits, which makes managed disks easier to scale out.</span></span> |

### <a name="select-an-operating-system"></a><span data-ttu-id="09070-292">选择操作系统</span><span class="sxs-lookup"><span data-stu-id="09070-292">Select an operating system</span></span>

<span data-ttu-id="09070-293">Azure 提供多种 OS 映像, 可以将其安装到 VM 中, 包括多个版本的 Windows 和 Linux 的各种风格。</span><span class="sxs-lookup"><span data-stu-id="09070-293">Azure provides a variety of OS images that you can install into the VM, including several versions of Windows and flavors of Linux.</span></span> <span data-ttu-id="09070-294">如前所述, 操作系统的选择会影响你的每小时计算定价, 因为 Azure 捆绑了 os 许可证的成本价格。</span><span class="sxs-lookup"><span data-stu-id="09070-294">As mentioned earlier, the choice of OS will influence your hourly compute pricing as Azure bundles the cost of the OS license into the price.</span></span>

<span data-ttu-id="09070-295">如果你要查找的不仅仅是基本 OS 映像, 可以搜索 Azure Marketplace 以获取更复杂的安装映像, 其中包括为特定方案安装的操作系统和热门软件工具。</span><span class="sxs-lookup"><span data-stu-id="09070-295">If you are looking for more than just base OS images, you can search the Azure Marketplace for more sophisticated install images that include the OS and popular software tools installed for specific scenarios.</span></span> <span data-ttu-id="09070-296">例如, 如果您需要一个新的 WordPress 网站, 标准技术堆栈将由 Linux 服务器、Apache web 服务器、MySQL 数据库和 PHP 组成。</span><span class="sxs-lookup"><span data-stu-id="09070-296">For example, if you needed a new WordPress site, the standard technology stack would consist of a Linux server, Apache web server, a MySQL database, and PHP.</span></span> <span data-ttu-id="09070-297">除了设置和配置每个组件之外, 您还可以利用 Marketplace 图像并一次性安装整个堆栈。</span><span class="sxs-lookup"><span data-stu-id="09070-297">Instead of setting up and configuring each component, you can leverage a Marketplace image and install the entire stack all at once.</span></span>

<span data-ttu-id="09070-298">最后, 如果找不到合适的操作系统映像, 可以使用所需的磁盘映像, 将其上载到 azure 存储, 并使用它来创建 azure VM。</span><span class="sxs-lookup"><span data-stu-id="09070-298">Finally, if you can't find a suitable OS image, you can create your disk image with what you need, upload it to Azure storage, and use it to create an Azure VM.</span></span> <span data-ttu-id="09070-299">请记住, Azure 仅支持64位操作系统。</span><span class="sxs-lookup"><span data-stu-id="09070-299">Keep in mind that Azure only supports 64-bit operating systems.</span></span>
