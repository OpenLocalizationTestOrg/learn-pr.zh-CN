<span data-ttu-id="24c44-101">通常, 服务公司的成功将直接与公司与其客户签订的服务级别协议 (SLA) 相关。</span><span class="sxs-lookup"><span data-stu-id="24c44-101">Often, the success of a services company is directly related to the service level agreements (SLA) the company has with its customers.</span></span> <span data-ttu-id="24c44-102">您的客户预期您提供的服务始终可用, 并且其数据保持安全。</span><span class="sxs-lookup"><span data-stu-id="24c44-102">Your customers expect the services you provide always to be available and their data kept safe.</span></span> <span data-ttu-id="24c44-103">Microsoft 会认真对待这一点。</span><span class="sxs-lookup"><span data-stu-id="24c44-103">This is something that Microsoft takes very seriously.</span></span> <span data-ttu-id="24c44-104">Azure 提供了可用于管理可用性、数据安全性和监控的工具, 因此您知道您的服务始终可供客户使用。</span><span class="sxs-lookup"><span data-stu-id="24c44-104">Azure provides tools you can use to manage availability, data security, and monitoring, so you know your services are always available for your customers.</span></span>

<span data-ttu-id="24c44-105">管理 Azure VM 并不局限于管理在 VM 上运行的操作系统或软件。</span><span class="sxs-lookup"><span data-stu-id="24c44-105">Administration of an Azure VM isn't limited to managing the operating system or software that runs on the VM.</span></span> <span data-ttu-id="24c44-106">它有助于了解 Azure 提供的服务, 以确保服务可用性并支持自动化。</span><span class="sxs-lookup"><span data-stu-id="24c44-106">It helps to know which services Azure provides that ensure service availability and support automation.</span></span> <span data-ttu-id="24c44-107">这些服务可帮助您规划您的组织的业务连续性和灾难恢复策略。</span><span class="sxs-lookup"><span data-stu-id="24c44-107">These services help you to plan your organization's business continuity and disaster recovery strategy.</span></span>

<span data-ttu-id="24c44-108">在这里, 我们将介绍 Azure 服务, 可帮助你改进 vm 可用性、简化 vm 管理任务, 并保持 vm 数据的备份和安全。</span><span class="sxs-lookup"><span data-stu-id="24c44-108">Here, we'll cover an Azure service that helps you improve VM availability, streamlines VM management tasks, and keeps your VM data backed up and safe.</span></span> <span data-ttu-id="24c44-109">让我们先定义可用性。</span><span class="sxs-lookup"><span data-stu-id="24c44-109">Let's start by defining availability.</span></span>

## <a name="what-is-availability"></a><span data-ttu-id="24c44-110">什么是可用性？</span><span class="sxs-lookup"><span data-stu-id="24c44-110">What is availability?</span></span>

<span data-ttu-id="24c44-111">可用性是服务可使用的时间百分比。</span><span class="sxs-lookup"><span data-stu-id="24c44-111">Availability is the percentage of time a service is available for use.</span></span>

<span data-ttu-id="24c44-112">假设你有一个网站, 你希望你的客户始终能够访问信息。</span><span class="sxs-lookup"><span data-stu-id="24c44-112">Let's assume you have a website and you want your customers to be able to access information at all times.</span></span> <span data-ttu-id="24c44-113">您的预期是关于网站访问的 100% 可用性。</span><span class="sxs-lookup"><span data-stu-id="24c44-113">Your expectation is 100% availability concerning website access.</span></span>

### <a name="why-do-i-need-to-think-about-availability-when-using-azure"></a><span data-ttu-id="24c44-114">为什么需要在使用 Azure 时考虑可用性？</span><span class="sxs-lookup"><span data-stu-id="24c44-114">Why do I need to think about availability when using Azure?</span></span>

<span data-ttu-id="24c44-115">azure 虚拟机在 azure 数据中心内托管的物理服务器上运行。</span><span class="sxs-lookup"><span data-stu-id="24c44-115">Azure VMs run on physical servers hosted within the Azure Datacenter.</span></span> <span data-ttu-id="24c44-116">与大多数物理设备一样, 有可能出现故障的可能性。</span><span class="sxs-lookup"><span data-stu-id="24c44-116">As with most physical devices, there's a chance that there could be a failure.</span></span> <span data-ttu-id="24c44-117">如果物理服务器发生故障, 则该服务器上托管的虚拟机也将失败。</span><span class="sxs-lookup"><span data-stu-id="24c44-117">If the physical server fails, the virtual machines hosted on that server will also fail.</span></span> <span data-ttu-id="24c44-118">如果发生这种情况, Azure 会自动将 VM 移动到运行状况良好的主机服务器。</span><span class="sxs-lookup"><span data-stu-id="24c44-118">If this happens, Azure will move the VM to a healthy host server automatically.</span></span> <span data-ttu-id="24c44-119">但是, 此自我修复迁移可能需要几分钟时间, 在此期间, 在该虚拟机上托管的应用程序将不可用。</span><span class="sxs-lookup"><span data-stu-id="24c44-119">However, this self-healing migration could take several minutes, during which, the application(s) hosted on that VM will not be available.</span></span>

<span data-ttu-id="24c44-120">虚拟机也可能会受到 Azure 本身启动的定期更新的影响。</span><span class="sxs-lookup"><span data-stu-id="24c44-120">The VMs could also be affected by periodic updates initiated by Azure itself.</span></span> <span data-ttu-id="24c44-121">这些维护事件的范围包括软件更新到硬件升级以及改进平台的可靠性和性能所必需的。</span><span class="sxs-lookup"><span data-stu-id="24c44-121">These maintenance events range from software updates to hardware upgrades and are required to improve platform reliability and performance.</span></span> <span data-ttu-id="24c44-122">通常在不影响任何来宾 vm 的情况下执行这些事件, 但有时虚拟机将重新启动以完成更新或升级。</span><span class="sxs-lookup"><span data-stu-id="24c44-122">These events usually are performed without impacting any guest VMs, but sometimes the virtual machines will be rebooted to complete an update or upgrade.</span></span>

> [!NOTE]
> <span data-ttu-id="24c44-123">Microsoft 不会自动更新你的 VM 的操作系统或软件。</span><span class="sxs-lookup"><span data-stu-id="24c44-123">Microsoft does not automatically update your VM's OS or software.</span></span> <span data-ttu-id="24c44-124">您拥有此的完全控制和责任。</span><span class="sxs-lookup"><span data-stu-id="24c44-124">You have complete control and responsibility for that.</span></span> <span data-ttu-id="24c44-125">但是, 将定期对基础软件主机和硬件进行修补, 以确保始终能够确保可靠性和高性能。</span><span class="sxs-lookup"><span data-stu-id="24c44-125">However, the underlying software host and hardware are periodically patched to ensure reliability and high performance at all times.</span></span>

<span data-ttu-id="24c44-126">为了确保服务不会中断并避免出现单一故障点, 建议至少部署每个 VM 的两个实例。</span><span class="sxs-lookup"><span data-stu-id="24c44-126">To ensure your services aren't interrupted and avoid a single point of failure, it's recommended to deploy at least two instances of each VM.</span></span> <span data-ttu-id="24c44-127">此功能称为_可用性集_。</span><span class="sxs-lookup"><span data-stu-id="24c44-127">This feature is called an _availability set_.</span></span>

### <a name="what-is-an-availability-set"></a><span data-ttu-id="24c44-128">可用性集是什么？</span><span class="sxs-lookup"><span data-stu-id="24c44-128">What is an availability set?</span></span>

<span data-ttu-id="24c44-129">**可用性集**是一项逻辑功能, 用于确保一组相关虚拟机已部署, 以便它们不会受到单一故障点的攻击, 也不会在数据中心的主机操作系统升级过程中同时升级。</span><span class="sxs-lookup"><span data-stu-id="24c44-129">An **availability set** is a logical feature used to ensure that a group of related VMs are deployed so that they aren't all subject to a single point of failure and not all upgraded at the same time during a host operating system upgrade in the datacenter.</span></span> <span data-ttu-id="24c44-130">位于可用性集的 vm 应执行一组相同的功能, 并安装相同的软件。</span><span class="sxs-lookup"><span data-stu-id="24c44-130">VMs placed in an availability set should perform an identical set of functionalities and have the same software installed.</span></span>

> [!TIP]
> <span data-ttu-id="24c44-131">Microsoft 为可用性集中部署的多实例虚拟机提供了 99.95% 的外部连接服务级别协议 (SLA)。</span><span class="sxs-lookup"><span data-stu-id="24c44-131">Microsoft offers a 99.95% external connectivity service level agreement (SLA) for multiple-instance VMs deployed in an availability set.</span></span> <span data-ttu-id="24c44-132">这意味着, 要应用 SLA, 必须至少在可用性集中部署 VM 的两个实例。</span><span class="sxs-lookup"><span data-stu-id="24c44-132">That means that for the SLA to apply, there must be at least two instances of the VM deployed within an availability set.</span></span> 

<span data-ttu-id="24c44-133">您可以通过 "灾难恢复" 部分中的 Azure 门户创建可用性集。</span><span class="sxs-lookup"><span data-stu-id="24c44-133">You can create availability sets through the Azure portal in the disaster recovery section.</span></span> <span data-ttu-id="24c44-134">此外, 还可以使用资源管理器模板或任何脚本或 API 工具生成它们。</span><span class="sxs-lookup"><span data-stu-id="24c44-134">Also, you can build them using Resource Manager templates, or any of the scripting or API tools.</span></span> <span data-ttu-id="24c44-135">将 vm 放入可用性集时, Azure 可确保跨**故障域**传播它们并**更新域**。</span><span class="sxs-lookup"><span data-stu-id="24c44-135">When you place VMs into an availability set, Azure guarantees to spread them across **Fault Domains** and **Update Domains**.</span></span>

#### <a name="what-is-a-fault-domain"></a><span data-ttu-id="24c44-136">什么是故障域？</span><span class="sxs-lookup"><span data-stu-id="24c44-136">What is a fault domain?</span></span>

<span data-ttu-id="24c44-137">故障域是 Azure 中共享公共电源和网络交换机的硬件的逻辑组。</span><span class="sxs-lookup"><span data-stu-id="24c44-137">A fault domain is a logical group of hardware in Azure that shares a common power source and network switch.</span></span> <span data-ttu-id="24c44-138">你可以将其视为本地数据中心中的机架。</span><span class="sxs-lookup"><span data-stu-id="24c44-138">You can think of it as a rack within an on-premises datacenter.</span></span> <span data-ttu-id="24c44-139">可用性集中的前两个 vm 将预配到两个不同的机架中, 以便在机架中网络或电源出现故障时, 仅会影响一个 VM。</span><span class="sxs-lookup"><span data-stu-id="24c44-139">The first two VMs in an availability set will be provisioned into two different racks so that if the network or the power failed in a rack, only one VM would be affected.</span></span> <span data-ttu-id="24c44-140">故障域也是为连接到虚拟机的托管磁盘定义的。</span><span class="sxs-lookup"><span data-stu-id="24c44-140">Fault domains are also defined for managed disks attached to VMs.</span></span>

![显示两个具有两台虚拟机的容错域的图示。](../media/5-fault-domains.png)

#### <a name="what-is-an-update-domain"></a><span data-ttu-id="24c44-144">什么是更新域？</span><span class="sxs-lookup"><span data-stu-id="24c44-144">What is an update domain?</span></span>

<span data-ttu-id="24c44-145">update 域是一组可进行维护或同时重新启动的硬件逻辑组。</span><span class="sxs-lookup"><span data-stu-id="24c44-145">An update domain is a logical group of hardware that can undergo maintenance or be rebooted at the same time.</span></span> <span data-ttu-id="24c44-146">azure 将自动将可用性集置于更新域中, 以最大限度地减少 Azure 平台引入主机操作系统更改时的影响。</span><span class="sxs-lookup"><span data-stu-id="24c44-146">Azure will automatically place availability sets into update domains to minimize the impact when the Azure platform introduces host operating system changes.</span></span> <span data-ttu-id="24c44-147">然后, Azure 每次处理一个更新域。</span><span class="sxs-lookup"><span data-stu-id="24c44-147">Azure then processes each update domain one at a time.</span></span>

<span data-ttu-id="24c44-148">可用性集是一项强大的功能, 可确保你的虚拟机中运行的服务始终对你的客户可用。</span><span class="sxs-lookup"><span data-stu-id="24c44-148">Availability sets are a powerful feature to ensure the services running in your VMs are always available to your customers.</span></span> <span data-ttu-id="24c44-149">但是, 它们并不是万无一失的。</span><span class="sxs-lookup"><span data-stu-id="24c44-149">However, they aren't foolproof.</span></span> <span data-ttu-id="24c44-150">如果数据或 VM 本身上运行的软件出现了什么情况, 该怎么办？</span><span class="sxs-lookup"><span data-stu-id="24c44-150">What if something happens to the data or the software running on the VM itself?</span></span> <span data-ttu-id="24c44-151">为此, 我们需要查看其他灾难恢复和备份技术。</span><span class="sxs-lookup"><span data-stu-id="24c44-151">For that, we'll need to look at other disaster recovery and backup techniques.</span></span>

## <a name="failover-across-locations"></a><span data-ttu-id="24c44-152">跨位置的故障转移</span><span class="sxs-lookup"><span data-stu-id="24c44-152">Failover across locations</span></span>

<span data-ttu-id="24c44-153">您还可以跨网站复制基础结构以处理区域故障转移。</span><span class="sxs-lookup"><span data-stu-id="24c44-153">You can also replicate your infrastructure across sites to handle regional failover.</span></span> <span data-ttu-id="24c44-154">**Azure Site Recovery**将工作负荷从主网站复制到辅助位置。</span><span class="sxs-lookup"><span data-stu-id="24c44-154">**Azure Site Recovery**  replicates workloads from a primary site to a secondary location.</span></span> <span data-ttu-id="24c44-155">如果主站点发生中断, 则可以故障转移到辅助位置。</span><span class="sxs-lookup"><span data-stu-id="24c44-155">If an outage happens at your primary site, you can fail over to a secondary location.</span></span> <span data-ttu-id="24c44-156">此故障转移使用户能够继续访问你的应用程序, 而不会中断。</span><span class="sxs-lookup"><span data-stu-id="24c44-156">This failover allows users to continue to access your applications without interruption.</span></span> <span data-ttu-id="24c44-157">然后, 您可以在主位置启动并再次运行时对其进行故障回复。</span><span class="sxs-lookup"><span data-stu-id="24c44-157">You can then fail back to the primary location once it's up and running again.</span></span> <span data-ttu-id="24c44-158">Azure Site Recovery 是关于虚拟机或物理机的复制;它使您的工作负荷在中断期间可用。</span><span class="sxs-lookup"><span data-stu-id="24c44-158">Azure Site Recovery is about replication of virtual or physical machines; it keeps your workloads available in an outage.</span></span>

<span data-ttu-id="24c44-159">在网站恢复中有很多引人注目的技术功能的同时, 至少有两个显著的业务优势:</span><span class="sxs-lookup"><span data-stu-id="24c44-159">While there are many attractive technical features to Site Recovery, there are at least two significant business advantages:</span></span>

1. <span data-ttu-id="24c44-160">通过网站恢复, 可以将 Azure 用作恢复目标, 从而消除维护辅助物理数据中心的成本和复杂性。</span><span class="sxs-lookup"><span data-stu-id="24c44-160">Site Recovery enables the use of Azure as a destination for recovery, thus eliminating the cost and complexity of maintaining a secondary physical datacenter.</span></span>

2. <span data-ttu-id="24c44-161">Site Recovery 使测试故障转移以实现恢复训练非常简单, 而不会影响生产环境。</span><span class="sxs-lookup"><span data-stu-id="24c44-161">Site Recovery makes it incredibly simple to test failovers for recovery drills without impacting production environments.</span></span> <span data-ttu-id="24c44-162">这样可以轻松测试计划或未计划的故障转移。</span><span class="sxs-lookup"><span data-stu-id="24c44-162">This makes it easy to test your planned or unplanned failovers.</span></span> <span data-ttu-id="24c44-163">毕竟, 如果您从未尝试进行故障转移, 则没有好的灾难恢复计划。</span><span class="sxs-lookup"><span data-stu-id="24c44-163">After all, you don’t have a good disaster recovery plan if you’ve never tried to failover.</span></span>

<span data-ttu-id="24c44-164">使用网站恢复创建的恢复计划可以像您的方案需要那样简单, 也可以复杂。</span><span class="sxs-lookup"><span data-stu-id="24c44-164">The recovery plans you create with Site Recovery can be as simple or as complex as your scenario requires.</span></span> <span data-ttu-id="24c44-165">它们可以包括自定义 PowerShell 脚本、Azure 自动化 runbook 或手动干预步骤。</span><span class="sxs-lookup"><span data-stu-id="24c44-165">They can include custom PowerShell scripts, Azure Automation runbooks, or manual intervention steps.</span></span> <span data-ttu-id="24c44-166">您可以利用恢复计划将工作负载复制到 Azure, 轻松实现迁移的新机会、在浪涌期间临时突发, 或者新应用程序的开发和测试。</span><span class="sxs-lookup"><span data-stu-id="24c44-166">You can leverage the recovery plans to replicate workloads to Azure, easily enabling new opportunities for migration, temporary bursts during surge periods, or development and testing of new applications.</span></span>

<span data-ttu-id="24c44-167">azure Site Recovery 适用于内部部署基础结构中的 azure 资源、hyper-v、VMware 和物理服务器, 并且可以是组织的业务连续性和灾难恢复 (BCDR) 策略的关键部分, 具体方法是协调复制、工作负载和应用程序的故障转移和恢复 (如果主位置出现故障)。</span><span class="sxs-lookup"><span data-stu-id="24c44-167">Azure Site Recovery works with Azure resources, or Hyper-V, VMware, and physical servers in your on-premises infrastructure and can be a key part of your organization’s business continuity and disaster recovery (BCDR) strategy by orchestrating the replication, failover, and recovery of workloads and applications if the primary location fails.</span></span>
