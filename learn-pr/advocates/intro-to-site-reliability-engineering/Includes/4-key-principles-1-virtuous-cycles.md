<span data-ttu-id="a96b9-101">如果确实如此, 在某种意义上说 "你是要做的", 那么我们就会来到本模块的核心。</span><span class="sxs-lookup"><span data-stu-id="a96b9-101">If it is really true that in some sense “you are what you do”, then we’ve come to the heart of this module.</span></span> <span data-ttu-id="a96b9-102">在此单元中, 我们将了解在 SRE 实践中通常被认为是核心的两种做法。</span><span class="sxs-lookup"><span data-stu-id="a96b9-102">In this unit we are going to look at two of the practices that are often considered core to the practice of SRE.</span></span> <span data-ttu-id="a96b9-103">这两个来源都源于创建 "virtuous 周期" 这一点很重要的原则。</span><span class="sxs-lookup"><span data-stu-id="a96b9-103">Both originate from the principle that it is important to create “virtuous cycles."</span></span> <span data-ttu-id="a96b9-104">在此上下文中的 Virtuous 周期是在组织中构建反馈循环的做法, 可帮助组织持续获得更好的效果。</span><span class="sxs-lookup"><span data-stu-id="a96b9-104">Virtuous cycles in this context are practices that build feedback loops in an organization that help that organization continuously get better.</span></span> <span data-ttu-id="a96b9-105">在这两种做法中, 将会有完整的后续模块, 因此我们只会在此处介绍每个部分。</span><span class="sxs-lookup"><span data-stu-id="a96b9-105">There will be entire follow-on modules on exactly these two practices so we’re only going to skim the surface with an overview of each here.</span></span>

### <a name="virtuous-cycle-1-slis-and-slos"></a><span data-ttu-id="a96b9-106">Virtuous 循环 #1: SLIs 和 slo</span><span class="sxs-lookup"><span data-stu-id="a96b9-106">Virtuous cycle #1: SLIs and SLOs</span></span>

<span data-ttu-id="a96b9-107">在本模块的前面部分, 我们对 "适当级别的可靠性" 进行了重大努力。</span><span class="sxs-lookup"><span data-stu-id="a96b9-107">Earlier in this module, we made a big deal about working towards the “appropriate level of reliability”.</span></span> <span data-ttu-id="a96b9-108">这恰好就是该概念进入熊的地方。</span><span class="sxs-lookup"><span data-stu-id="a96b9-108">This is precisely the place where that concept gets brought to bear.</span></span>

<span data-ttu-id="a96b9-109">假设您有一个新的服务, 您计划将其带到生产环境 (已构建或仍处于规划过程中的服务)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-109">Let’s say you have a new service you are planning to bring to production (either one that has been constructed or one that is still in the planning process).</span></span> <span data-ttu-id="a96b9-110">作为此过程的一部分, 一定要做出有关其所需可靠性的一些决定。</span><span class="sxs-lookup"><span data-stu-id="a96b9-110">As part of that process, it is important to make some decisions about its desired reliability.</span></span> <span data-ttu-id="a96b9-111">如果您没有自己编写所有代码, 则在与开发人员协作的过程中进行这些决策 (且这是至关重要的)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-111">If you are not writing all of the code yourself, these decisions are made (and this is crucial) in collaboration with the developers making the thing.</span></span>

<span data-ttu-id="a96b9-112">做出的第一个决定是将用作服务运行状况的指示器 (服务级别指示器或 SLI)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-112">The first decision that gets made is what will be used as indicators of the service’s health (a Service Level Indicator or SLI).</span></span> <span data-ttu-id="a96b9-113">另一种方法是, "如何知道它的运行时间/良好状态？"。</span><span class="sxs-lookup"><span data-stu-id="a96b9-113">Another way to ask this will be “How do you know when it's up/working well?”.</span></span> <span data-ttu-id="a96b9-114">有很多方法可以跟踪我们稍后会详细介绍的这一点, 但这些内容通常是成功的和故障措施 (服务是否已在一定百分比的时间内成功完成操作)、计时度量 (我们在中返回一个答案,一定的时间阈值, 吞吐量的度量 (我们处理一定量的数据) 或所有这些数据的组合。</span><span class="sxs-lookup"><span data-stu-id="a96b9-114">There are lots of ways to track this which we'll explore in detail later, but these things are typically success vs. failure measures (does the service successfully complete an operation some percentage of the time), measures of timing (did we return an answer within a certain threshold of time), measures of throughput (did we process a certain amount of data) or combinations of all of these.</span></span> <span data-ttu-id="a96b9-115">对于一个简单的示例, 我们可能会说, 我们的服务的 SLI 是通过 HTTP 200 代码 (与500或其他一些代码) 指示的成功返回成功的频率。</span><span class="sxs-lookup"><span data-stu-id="a96b9-115">For a simple example, we might say an SLI for our service is how often it returned success, indicated via an HTTP 200 code (vs. a 500 or some other code).</span></span>

<span data-ttu-id="a96b9-116">现在我们有一个清楚的指标, 告诉你如何知道服务的工作方式, 我们想要决定我们预期或需要的可靠性级别。</span><span class="sxs-lookup"><span data-stu-id="a96b9-116">Now that we have a clear indicator for how to tell how the service is doing, we’re going to want to decide what level of reliability we expect or desire from it.</span></span> <span data-ttu-id="a96b9-117">例如, 我们预计在一天内会看到服务的故障率为 20%？</span><span class="sxs-lookup"><span data-stu-id="a96b9-117">For example, do we expect over a period of a day that we'll see a failure rate of 20% from the service?</span></span> <span data-ttu-id="a96b9-118">我们在这里使用圆角和大型数字, 因为它们在开头很容易就是原因。</span><span class="sxs-lookup"><span data-stu-id="a96b9-118">We're using round and large numbers here because they're easy to reason about in the beginning.</span></span> <span data-ttu-id="a96b9-119">在后面的模块中, 我们将增加如以下的语句的复杂性和精度 ("哪些用户将看到该错误率？其中一些？大多数？</span><span class="sxs-lookup"><span data-stu-id="a96b9-119">In later modules, we’ll increase the complexity and precision of statements like this (“which users will see that error rate? some of them? most of them?”</span></span> <span data-ttu-id="a96b9-120">等等)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-120">and so on).</span></span> <span data-ttu-id="a96b9-121">与服务开发人员协作创建的预期是服务级别目标 (SLO)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-121">That expectation, created in collaboration with the service’s developer, is a Service Level Objective (SLO).</span></span>

<span data-ttu-id="a96b9-122">SLO 必须是可在监视系统中准确测量和表示的内容。</span><span class="sxs-lookup"><span data-stu-id="a96b9-122">The SLO needs to be something that can be accurately measured and represented in your monitoring system.</span></span> <span data-ttu-id="a96b9-123">它旨在作为服务可靠性的目标、充分理解的目标以及足够好的数字是什么？</span><span class="sxs-lookup"><span data-stu-id="a96b9-123">It’s meant to be an objective, well understood goal for the reliability for the service—what is the number that is good enough?</span></span> <span data-ttu-id="a96b9-124">没有 "好, 我认为服务在上一周内已经是" 好的 ", 但这有点难说" 进入这里 "。</span><span class="sxs-lookup"><span data-stu-id="a96b9-124">There's no “well, I think the service has been doing ok for the last week or so, but it's kind of hard to tell” going on here.</span></span> <span data-ttu-id="a96b9-125">服务正在会议其 SLO 或不是, 应清楚地确定数据。</span><span class="sxs-lookup"><span data-stu-id="a96b9-125">Either the service is meeting its SLO or it isn’t, the data should be clear.</span></span> <span data-ttu-id="a96b9-126">如果不能满足 SLO (尤其是在一段时间内重复), 则会出现问题, 需要解决。</span><span class="sxs-lookup"><span data-stu-id="a96b9-126">If it isn't meeting its SLO (especially repeatedly over a span of time), then something is wrong and needs to be addressed.</span></span>

### <a name="error-budgets"></a><span data-ttu-id="a96b9-127">错误预算</span><span class="sxs-lookup"><span data-stu-id="a96b9-127">Error budgets</span></span>

<span data-ttu-id="a96b9-128">如果服务不满足其 SLO, 组织可能会进行操作, 这一点非常简单, 但在达到或超过 slo 的情况下, SRE 会将这一完整的概念转到另一个步骤。</span><span class="sxs-lookup"><span data-stu-id="a96b9-128">It can be straightforward to understand that an organization might snap into action if a service doesn’t meet its SLO, but SRE takes this whole concept another step forward for the cases where the SLO is being met or exceeded.</span></span> <span data-ttu-id="a96b9-129">有些组织使用 slo 来构建他们调用 "错误预算" 的内容。</span><span class="sxs-lookup"><span data-stu-id="a96b9-129">Some organizations use SLOs to construct what they call “error budgets”.</span></span>

<span data-ttu-id="a96b9-130">为了说明这一点, 我们将使用我们讨论的示例服务及其 SLO 80% 成功 (将其视为 "必须长达 80% 的时间")。</span><span class="sxs-lookup"><span data-stu-id="a96b9-130">To demonstrate this idea, lets use the sample service we’ve been discussing and its SLO of 80% success (think of it as “must be up 80% of the time”).</span></span> <span data-ttu-id="a96b9-131">在 80% 的 SLO 中, 我们已声明我们的服务必须超过 80% 的时间。</span><span class="sxs-lookup"><span data-stu-id="a96b9-131">With the SLO of 80% uptime we’ve declared that our service must be up 80% of time.</span></span> <span data-ttu-id="a96b9-132">但另一个 20% 呢？</span><span class="sxs-lookup"><span data-stu-id="a96b9-132">But what about the other 20%?</span></span> <span data-ttu-id="a96b9-133">如果我们的服务处于其他 20% 的状态, 我们并不会真正 "在意", 因为我们已决定将额外的 20% 作为服务目标, 对我们来说并不重要。</span><span class="sxs-lookup"><span data-stu-id="a96b9-133">If our service is down that other 20%, we don’t really “care” because we’ve decided being up that extra 20% isn’t important to us as a service goal.</span></span>

<span data-ttu-id="a96b9-134">那么, 如果我们不介意在此期间会发生什么情况, 我们可以对服务做些什么？</span><span class="sxs-lookup"><span data-stu-id="a96b9-134">So if we don’t care about what happens during that time, what can we do with the service?</span></span> <span data-ttu-id="a96b9-135">当然, 我们可以通过升级它来 perturb 正在运行的服务, 也可以通过新版本添加一些功能来实现这一目的。</span><span class="sxs-lookup"><span data-stu-id="a96b9-135">One thing we can certainly do is perturb the running service by upgrading it, perhaps with a new release that adds some features.</span></span> <span data-ttu-id="a96b9-136">如果新版本保持不变, 且不会增加停机时间。</span><span class="sxs-lookup"><span data-stu-id="a96b9-136">If that new release stays up and doesn’t add any downtime, great.</span></span> <span data-ttu-id="a96b9-137">如果新版本导致服务的稳定性降低并在调试时返回错误的 10%, 则仍然可以正常工作。</span><span class="sxs-lookup"><span data-stu-id="a96b9-137">If that new release causes the service to be less stable and return errors another 10% of time as it gets debugged, still just fine.</span></span> <span data-ttu-id="a96b9-138">我们在允许的 unreliability 预算之内。</span><span class="sxs-lookup"><span data-stu-id="a96b9-138">We’re within our budget of allowed unreliability.</span></span>

<span data-ttu-id="a96b9-139">错误预算是服务可能的完全可靠性和所需的可靠性 (100%-80% = 20%) 之间的差异。</span><span class="sxs-lookup"><span data-stu-id="a96b9-139">An error budget is the difference between the service’s potential perfect reliability and its desired reliability (100% - 80% = 20%).</span></span> <span data-ttu-id="a96b9-140">在这种情况下, 错误预算为我们提供 20% unreliability 的基金 (20% 的时间), 在这种情况下, 我们 "不要在意, 因为它仍将处于规范中"。</span><span class="sxs-lookup"><span data-stu-id="a96b9-140">In this case, the error budget gives us a fund of 20% unreliability—20% time where we “don’t care whether it is up or not because it will still be in spec”.</span></span>  <span data-ttu-id="a96b9-141">我们可以使用与其他任何预算一样的方式, 以任何方式 (或许是更多的版本) 在 20% 的时间段上进行绘制和花费。</span><span class="sxs-lookup"><span data-stu-id="a96b9-141">We can draw on and spend that 20% time any way we’d like (perhaps with more releases) until it is exhausted just like any other budget.</span></span>

<span data-ttu-id="a96b9-142">在某些组织中, 您还可以使用错误预算, 以减少不会在其中进行 SLO 的情况。</span><span class="sxs-lookup"><span data-stu-id="a96b9-142">Error budgets are also used in some organizations for the less happy case, the one where you aren’t making your SLO.</span></span> <span data-ttu-id="a96b9-143">在这种情况下, 您可以选择执行一些更严格的操作, 而不只是 "采取操作", 如上所述。</span><span class="sxs-lookup"><span data-stu-id="a96b9-143">In that case, you might choose to do something a little more stringent than just “take an action” as mentioned above.</span></span> <span data-ttu-id="a96b9-144">假设我们的服务遇到一些问题, 已超过 60% 的时间, 如我们前面所选的 SLI 所示。</span><span class="sxs-lookup"><span data-stu-id="a96b9-144">Let’s say our service has been having some issues and has been up just 60% of the time as indicated by the SLI we chose earlier.</span></span> <span data-ttu-id="a96b9-145">我们未实现目标 (SLO)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-145">We didn’t make our objective (the SLO).</span></span> <span data-ttu-id="a96b9-146">我们的服务已用完其错误预算。</span><span class="sxs-lookup"><span data-stu-id="a96b9-146">Our service has used up its error budget.</span></span> <span data-ttu-id="a96b9-147">组织可以选择将其保留在已计划的版本上, 因为它知道 perturbing 系统甚至在此时刻可能只会进一步 worsen 可靠性的情况。</span><span class="sxs-lookup"><span data-stu-id="a96b9-147">The organization may choose to hold back on a planned release because it knows that perturbing the system even further at this point is likely to only further worsen the reliability situation.</span></span> <span data-ttu-id="a96b9-148">通常情况下, 错误预算是在设定的一段时间内 (一个月、一个季度, 等等) 或在服务可靠性提高的情况下计算的, 最后一个预算返回。</span><span class="sxs-lookup"><span data-stu-id="a96b9-148">Error budgets are usually calculated for a set period of time--a month, quarter, and so on--or on a rolling basis so eventually if the service reliability improves, that budget returns.</span></span>

<span data-ttu-id="a96b9-149">在此网关版期间, 组织可能会选择将一些工程资源从功能开发移到可靠性工作, 以帮助揭示和改进导致服务吹出 SLO 的问题的来源。</span><span class="sxs-lookup"><span data-stu-id="a96b9-149">During this time of gated releases, the organization might choose to pivot some engineering resources away from feature development towards reliability work to help uncover and improve the source of the problems that caused the service to blow its SLO.</span></span>

<span data-ttu-id="a96b9-150">我们在遇到错误预算时说 "某些组织" 的原因是它们的实现, 尤其是在用于入口版本的情况下, 需要特定的机构购买。</span><span class="sxs-lookup"><span data-stu-id="a96b9-150">The reason why we say “some organizations” when it comes to error budgets is their implementation, especially in the case where it's used to gate releases, requires a certain institutional buy-in.</span></span> <span data-ttu-id="a96b9-151">组织必须愿意说, 在遇到发布决定时, 如果服务的可靠性不是最高为 snuff, 则该版本将被保留。</span><span class="sxs-lookup"><span data-stu-id="a96b9-151">The organization has to be willing to say that when faced with a release decision, if the reliability of the service to date hasn’t been up to snuff, that release will be held back.</span></span> <span data-ttu-id="a96b9-152">这并不是所有组织都愿意做出的决定。</span><span class="sxs-lookup"><span data-stu-id="a96b9-152">That’s not a decision all organizations are willing to make.</span></span> <span data-ttu-id="a96b9-153">这也不是对已耗尽的错误预算的唯一可能的响应, 而是最有讨论的。</span><span class="sxs-lookup"><span data-stu-id="a96b9-153">This is also not the only possible response to a depleted error budget, but it is the one most talked about.</span></span>

<span data-ttu-id="a96b9-154">我们将在单独的模块中详细了解有关 SLIs、slo 和错误预算的详细信息, 但在这些做法的 virtuous 周期方面有必要的重点。</span><span class="sxs-lookup"><span data-stu-id="a96b9-154">We’ll be talking in considerably more detail about SLIs, SLOs, and error budgets in a separate module, but it is worthwhile highlighting the virtuous cycle aspect of these practices.</span></span> <span data-ttu-id="a96b9-155">理论上, 它提供了一种方法, 使组织能够以一种方式对服务的可靠性进行描述、通信和操作, 使每个人都能获得更好的可靠性。</span><span class="sxs-lookup"><span data-stu-id="a96b9-155">In theory, it provides a way for an organization to describe, communicate, and act on the reliability of a service in a way that gets everyone working towards better reliability.</span></span> <span data-ttu-id="a96b9-156">此反馈循环可能相当重要。</span><span class="sxs-lookup"><span data-stu-id="a96b9-156">This feedback loop can be incredibly important.</span></span>

## <a name="virtuous-cycle-2-blameless-postmortems"></a><span data-ttu-id="a96b9-157">Virtuous 循环 #2: blameless postmortems</span><span class="sxs-lookup"><span data-stu-id="a96b9-157">Virtuous cycle #2: blameless postmortems</span></span>

<span data-ttu-id="a96b9-158">事后对重大事件 (通常是意外事件) 的追溯分析而言, 甚至不是远程特定于网站可靠性工程。</span><span class="sxs-lookup"><span data-stu-id="a96b9-158">The idea of a postmortem—the retrospective analysis of a significant, usually undesired event—is not even remotely specific to site reliability engineering.</span></span> <span data-ttu-id="a96b9-159">操作世界也不常见。</span><span class="sxs-lookup"><span data-stu-id="a96b9-159">It isn't even uncommon to the operations world.</span></span> <span data-ttu-id="a96b9-160">一个更接近独特之处的事情是 SRE 的 insistence, postmortems 需要是 "blameless"。</span><span class="sxs-lookup"><span data-stu-id="a96b9-160">One thing that is closer to being distinctive is SRE’s insistence that postmortems need to be “blameless.”</span></span> <span data-ttu-id="a96b9-161">他们需要重点关注过程的故障或执行事件的技术, 而不是特定人员的操作。</span><span class="sxs-lookup"><span data-stu-id="a96b9-161">They need to focus on the failure of the process or the technology doing the incident, not the actions of specific people.</span></span> <span data-ttu-id="a96b9-162">"什么是我们目前允许 X 来执行导致故障的事情的过程？</span><span class="sxs-lookup"><span data-stu-id="a96b9-162">“What was it about the process we had in place that allowed X to do the thing that led to the failure?</span></span> <span data-ttu-id="a96b9-163">此人有哪些信息不可用, 甚至在导致它们遇到错误结论的时刻也是突出的？</span><span class="sxs-lookup"><span data-stu-id="a96b9-163">What information did that person not have available, or even prominent at the moment that led to them coming to the wrong conclusion?</span></span> <span data-ttu-id="a96b9-164">应进行什么类型的 guardrails, 以便无法进行此类灾难性故障？</span><span class="sxs-lookup"><span data-stu-id="a96b9-164">What sort of guardrails should have been in place so it wasn’t possible to have such a catastrophic failure take place?”</span></span> <span data-ttu-id="a96b9-165">这是 blameless 事后提出的问题的种类。</span><span class="sxs-lookup"><span data-stu-id="a96b9-165">These are the sort of questions that are asked in a blameless postmortem.</span></span>

<span data-ttu-id="a96b9-166">这些问题的 tenor 和方向是至关重要的。</span><span class="sxs-lookup"><span data-stu-id="a96b9-166">The tenor and direction of these questions is crucial.</span></span> <span data-ttu-id="a96b9-167">他们正在搜索改进系统或过程的方法, 而不是 punish 其使用这些系统或进程的个人在中断中参与的方法。</span><span class="sxs-lookup"><span data-stu-id="a96b9-167">They are searching for ways to improve the systems or processes, not ways to punish the individuals whose use of those systems or processes in good faith contributed to the outage.</span></span> <span data-ttu-id="a96b9-168">请务必记住 "不能触发可靠的方式"。</span><span class="sxs-lookup"><span data-stu-id="a96b9-168">It's important to remember “You can’t fire your way to reliable”.</span></span> <span data-ttu-id="a96b9-169">在我们的经验中, 每次出现生产事件 (很少例外) 时都会触发人员的组织无法从这些事件中了解。</span><span class="sxs-lookup"><span data-stu-id="a96b9-169">In our experience, an organization that fires a person every time there is a production incident (with very few exceptions), will not learn from those incidents.</span></span> <span data-ttu-id="a96b9-170">相反, 在拐角中有一个单独的, 摇动, 恐怕对所有内容进行任何更改。</span><span class="sxs-lookup"><span data-stu-id="a96b9-170">Instead, there will be a single individual left, shaking in the corner, afraid to make any changes to anything at all.</span></span>

<span data-ttu-id="a96b9-171">但在组织中事后的正常运行过程将创建 virtuous 周期。</span><span class="sxs-lookup"><span data-stu-id="a96b9-171">But a well functioning post-mortem process in an organization creates a virtuous cycle.</span></span> <span data-ttu-id="a96b9-172">它让组织能够从其中断中了解, 并持续改进其系统 (提供正确的分析和后续操作)。</span><span class="sxs-lookup"><span data-stu-id="a96b9-172">It lets the organization learn from its outages and continuously improve its systems (providing proper analysis and followup is done).</span></span>

<span data-ttu-id="a96b9-173">这种与故障和错误的关系—组织将其用于学习和改进的机会, 这是网站可靠性工程的核心原则。</span><span class="sxs-lookup"><span data-stu-id="a96b9-173">This relationship to failures and errors—embraced by the organization as opportunities for learning and improvement—is a core principle of site reliability engineering.</span></span> <span data-ttu-id="a96b9-174">构建 virtuous 周期以利用这些机会, 并指导组织更好地进行可靠性是另一个。</span><span class="sxs-lookup"><span data-stu-id="a96b9-174">The construction of virtuous cycles to make use of these opportunities and to guide the organization towards greater reliability is another.</span></span>

<span data-ttu-id="a96b9-175">让我们来研究我们下一个部门中的其他一些原则和做法, 这些原则和做法在 SRE 的人中居中。</span><span class="sxs-lookup"><span data-stu-id="a96b9-175">Let’s explore some other principles and practices, those centered on the human side of SRE, in our next unit.</span></span>
