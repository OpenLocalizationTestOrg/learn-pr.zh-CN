:::row:::
  :::column:::
    ![表示 Azure 虚拟机的图像](../media/3-azure-vms.png)
  :::column-end:::
  :::column span="3":::
Azure 虚拟机允许你在云中创建和使用虚拟机。 它们以虚拟化服务器的形式提供了基础结构作为服务 (IaaS), 可通过多种不同的方式使用。 就像物理计算机一样, 您可以自定义在 VM 上运行的所有软件。 当您需要对 OS 进行全面控制或需要运行自定义软件或使用自定义托管配置时, 这将使其成为理想选择。
  :::column-end:::
:::row-end:::

通常情况下, 可以通过选择预先配置的虚拟机映像, 在几分钟内创建和配置新的虚拟机。 选择图像是创建 VM 时所做的最重要决定之一。 图像是用于创建虚拟机的模板。 这些模板已包含操作系统 (OS), 通常是其他软件, 如开发工具或 web 托管环境。

## <a name="moving-to-the-cloud-with-vms"></a>使用 vm 迁移到云

在从物理服务器移动到云 ("抬起和转换") 时, 虚拟机也是极好的选择。 您可以创建物理服务器的映像, 并将其托管在虚拟机中, 而无需进行任何更改。 就像物理本地服务器一样, 你将需要维护虚拟机。 这意味着更新操作系统及其运行的软件。 

## <a name="scaling-vms-in-azure"></a>在 Azure 中扩展虚拟机

您可以为测试、开发或次要任务运行单个虚拟机, 也可以将 vm 组合在一起, 以提供高可用性、可伸缩性和冗余。 azure 有几项专门用于这些关键功能的功能, 以确保无论正常运行时间要求如何, azure 都能满足这些要求。

- 可用性集
- 虚拟机规模集
- Azure 批处理

### <a name="what-are-availability-sets"></a>什么是可用性集？

**可用性集**是两个或更多个虚拟机的逻辑分组, 可确保您的应用程序在计划内或计划外维护期间仍可用。

_计划的维护事件_是 Microsoft 对托管虚拟机的基础 Azure fabric 进行更新的时间。 这样做是为了修补安全漏洞、提高性能以及添加或更新功能。 大多数情况下, 可以在不影响来宾 vm 的情况下执行这些更新-但是, 有时需要重新启动才能完成更新。 如果 VM 是可用性集的一部分, 则 Azure fabric 将确保对更新进行排序, 以便不会同时重新启动所有关联的虚拟机。 此分组称为_更新域_。 Update 域是每个数据中心的逻辑部分, 通过软件和逻辑实现。

_计划外维护事件_是指那些涉及数据中心中的硬件故障 (例如断电或磁盘故障) 的事件。 作为可用性集一部分的虚拟机将自动切换到正在运行的物理服务器, 以使 vm 继续运行。 此组称为_容错域_。 容错域实质上是一台服务器机架。 它提供了在数据中心中的不同硬件之间物理分离工作负载的情况。 这包括支持位于服务器机架中的物理服务器的电源、冷却和网络硬件。 如果支持服务器机架的硬件变得不可用, 则中断仅影响服务器机架。

Azure 创建两个故障域 (两个机架, 每个都有专用的电源和网络资源) 和五个逻辑更新域。 然后, 你的 vm 按顺序放在创建的域中, 如下所示。

![Azure 中的可用性集, 显示跨服务器复制的更新域和故障域](../media/3-availability-sets.png)

可用性集没有成本;仅为集中的 vm 付费。 强烈建议将每个工作负荷放在可用性集内, 以确保 VM 体系结构中不存在单点故障。

### <a name="what-are-virtual-machine-scale-sets"></a>什么是虚拟机规模集？

使用 Azure 虚拟机扩展集, 可以创建和管理一组相同的负载平衡虚拟机。 假设您正在运行一个网站, 使科学家能够上载需要处理的已对用户的图像。 如果复制了 VM, 则通常需要配置其他服务以在网站的多个实例之间路由请求。 这正是 VM 扩展集为你实现的功能。

利用扩展集, 可以在几分钟内集中管理、配置和更新大量 vm, 以提供高可用性的应用程序。 VM 实例的数量可以根据需求或定义的计划自动增加或减少。 使用虚拟机扩展集, 可以为计算、大型数据和容器工作负荷等区域构建大规模服务。

### <a name="what-is-azure-batch"></a>什么是 Azure Batch？

Azure Batch 支持大规模作业调度和计算管理, 能够扩展到数万、数百或数千个虚拟机。 

当您准备好运行作业时, 批处理将为您启动一个计算虚拟机池, 安装应用程序和临时数据, 运行包含任意多个任务的作业, 识别故障并重新排队工作, 并在工作完成时向下扩展池。 

在某些情况下, 您可能需要原始计算功率或 supercomputer 级别的计算能力;Azure 提供这些功能。
