<span data-ttu-id="ecb20-101">你已经完成了资源, 并将其移动到了比以前更多的组织的资源组中。</span><span class="sxs-lookup"><span data-stu-id="ecb20-101">You've gone through your resources and moved them into resource groups that are more organized than before.</span></span> <span data-ttu-id="ecb20-102">但如果资源有多个用途, 该怎么办？</span><span class="sxs-lookup"><span data-stu-id="ecb20-102">But what if resources have multiple uses?</span></span> <span data-ttu-id="ecb20-103">如何更好地搜索、筛选和组织这些资源？</span><span class="sxs-lookup"><span data-stu-id="ecb20-103">How do you better search, filter, and organize these resources?</span></span> <span data-ttu-id="ecb20-104">在您希望改进 Azure 资源的组织时, 标记可能非常有用。</span><span class="sxs-lookup"><span data-stu-id="ecb20-104">Tags can be helpful as you look to improve organization of your Azure resources.</span></span>

## <a name="what-are-tags"></a><span data-ttu-id="ecb20-105">什么是标记？</span><span class="sxs-lookup"><span data-stu-id="ecb20-105">What are tags?</span></span>

<span data-ttu-id="ecb20-106">标记是可应用于资源和资源组的文本数据的名称/值对。</span><span class="sxs-lookup"><span data-stu-id="ecb20-106">Tags are name/value pairs of text data that you can apply to resources and resource groups.</span></span> <span data-ttu-id="ecb20-107">标记允许您关联资源的自定义详细信息, 以及资源具有的标准 Azure 属性:</span><span class="sxs-lookup"><span data-stu-id="ecb20-107">Tags allow you to associate custom details about your resource, in addition to the standard Azure properties a resource has:</span></span>

- <span data-ttu-id="ecb20-108">部门 (财务、市场营销等)</span><span class="sxs-lookup"><span data-stu-id="ecb20-108">department (finance, marketing, etc.)</span></span>
- <span data-ttu-id="ecb20-109">环境 (生产、测试、开发)、</span><span class="sxs-lookup"><span data-stu-id="ecb20-109">environment (prod, test, dev),</span></span>
- <span data-ttu-id="ecb20-110">成本中心</span><span class="sxs-lookup"><span data-stu-id="ecb20-110">cost center</span></span>
- <span data-ttu-id="ecb20-111">生命周期和自动化 (例如, 关闭和启动虚拟机)。</span><span class="sxs-lookup"><span data-stu-id="ecb20-111">life cycle and automation (e.g. shutdown and startup of virtual machines).</span></span>

<span data-ttu-id="ecb20-112">一个资源最长可包含15个标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-112">A resource can have up to 15 tags.</span></span> <span data-ttu-id="ecb20-113">对于除存储帐户之外的所有类型的资源, 名称限制为512个字符, 最多可包含128个字符。</span><span class="sxs-lookup"><span data-stu-id="ecb20-113">The name is limited to 512 characters for all types of resources except storage accounts, which have a limit of 128 characters.</span></span> <span data-ttu-id="ecb20-114">对于所有类型的资源, tag 值限制为256个字符。</span><span class="sxs-lookup"><span data-stu-id="ecb20-114">The tag value is limited to 256 characters for all types of resources.</span></span> <span data-ttu-id="ecb20-115">标记不是从父资源继承的。</span><span class="sxs-lookup"><span data-stu-id="ecb20-115">Tags are not inherited from parent resources.</span></span> <span data-ttu-id="ecb20-116">并非所有资源类型都支持标记, 并且标记不能应用于经典资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-116">Not all resource types support tags, and tags cannot be applied to classic resources.</span></span>

<span data-ttu-id="ecb20-117">可以通过 azure 门户、azure CLI、azure PowerShell、资源管理器模板和 REST API 添加和操作标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-117">Tags can be added and manipulated through the Azure portal, Azure CLI, Azure PowerShell, Resource Manager templates, and through the REST API.</span></span> <span data-ttu-id="ecb20-118">例如, 若要使用 Azure CLI 将资源标记添加到虚拟网络, 可以使用以下命令:</span><span class="sxs-lookup"><span data-stu-id="ecb20-118">For example, to add a resource tag to a virtual network using the Azure CLI, you could use the following command:</span></span>

```azurecli
az resource tag --tags Department=Finance \
       -g msftlearn-core-infrastructure-rg \
       -name msftlearn-vnet1 \
       --resource-type "Microsoft.Network/virtualNetworks"
```

<span data-ttu-id="ecb20-119">此外, 还可以利用 Azure 策略根据诸如创建资源的用户或创建的资源类型等条件, 将标记添加到创建的资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-119">In addition, you can leverage Azure Policy to add tags to created resources based on conditions such as who is creating the resource, or the type of resource being created.</span></span> <span data-ttu-id="ecb20-120">例如, 可以添加标记以标识成本中心或在其中创建资源的特定环境。</span><span class="sxs-lookup"><span data-stu-id="ecb20-120">For example, you could add a tag to identify a cost center, or specific environment a resource will be created in.</span></span>

## <a name="apply-tags-to-resources"></a><span data-ttu-id="ecb20-121">将标签应用于资源</span><span class="sxs-lookup"><span data-stu-id="ecb20-121">Apply tags to resources</span></span>

<span data-ttu-id="ecb20-122">让我们将一些标签应用于您创建的资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-122">Let's apply some tags to the resources you created.</span></span> <span data-ttu-id="ecb20-123">回想一下, 我们在资源组**msftlearn-vnet1**和**msftlearn-vnet2**中创建了一个资源组**msftlearn-core-rg**和两个 vnet。</span><span class="sxs-lookup"><span data-stu-id="ecb20-123">Recall that we created a resource group **msftlearn-core-infrastructure-rg** and two VNets inside that resource group, **msftlearn-vnet1** and **msftlearn-vnet2**.</span></span> <span data-ttu-id="ecb20-124">vnet 的名称是相对常规的, 因此, 我们希望将 vnet 与来自不同部门的服务相关联。</span><span class="sxs-lookup"><span data-stu-id="ecb20-124">The names of the VNets are relatively generic, so we'd like to associate the VNets with services from different departments.</span></span> 

1. <span data-ttu-id="ecb20-125">继续执行并提起[Azure 门户](https://portal.azure.com/?azure-portal=true)。</span><span class="sxs-lookup"><span data-stu-id="ecb20-125">Go ahead and pull up the [Azure portal](https://portal.azure.com/?azure-portal=true).</span></span> <span data-ttu-id="ecb20-126">导航到 "msftlearn"-"**基础结构-rg** " 资源组。</span><span class="sxs-lookup"><span data-stu-id="ecb20-126">Navigate to your **msftlearn-core-infrastructure-rg** resource group.</span></span>

1. <span data-ttu-id="ecb20-127">在资源组的 "**概述**" 选项卡上, 您应看到两个 vnet 列出。</span><span class="sxs-lookup"><span data-stu-id="ecb20-127">On the **Overview** tab of your resource group, you should see your two VNets listed.</span></span> <span data-ttu-id="ecb20-128">默认视图不显示 "标记" 列, 因此, 让我们将其添加到显示中。</span><span class="sxs-lookup"><span data-stu-id="ecb20-128">The default view doesn't display the tags column, so let's add that to the display.</span></span> <span data-ttu-id="ecb20-129">选择顶部的 "**编辑列**"。</span><span class="sxs-lookup"><span data-stu-id="ecb20-129">Select **Edit columns** at the top.</span></span> <span data-ttu-id="ecb20-130">在 "**可用列**" 列表中\*\*\*\* , 选择 " **->** 标记", 然后单击以将其添加到 "**选定的列**" 列表中。</span><span class="sxs-lookup"><span data-stu-id="ecb20-130">In the **Available columns** list, select **Tags** and click **->** to add it to the **Selected columns** list.</span></span> <span data-ttu-id="ecb20-131">单击 "**应用**" 以应用所做的更改。</span><span class="sxs-lookup"><span data-stu-id="ecb20-131">Click **Apply** to apply your changes.</span></span>

    ![演示如何将 "标签" 列添加到显示中的门户图像](../media/3-add-tag-column.PNG)

1. <span data-ttu-id="ecb20-133">现在, 您应该会看到 "标记" 列, 但它是空的, 因为我们尚未添加任何标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-133">You should now see the tags column, but it will be empty since we've not added any tags yet.</span></span> <span data-ttu-id="ecb20-134">我们将直接在此处添加标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-134">We'll add the tags directly here.</span></span> <span data-ttu-id="ecb20-135">您还可以在资源的 "**标签**" 面板上向支持它的任何资源中添加标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-135">You can also add tags to any resource that supports it on the resource's **Tags** panel.</span></span> <span data-ttu-id="ecb20-136">在资源列表中, 您应该会在 "**标签**" 列中看到一个铅笔, 您可以在其中直接编辑标签。</span><span class="sxs-lookup"><span data-stu-id="ecb20-136">In the list of resources, you should see a pencil in the **TAGS** column where you can directly edit the tags.</span></span> <span data-ttu-id="ecb20-137">单击**msftlearn-vnet1**资源的铅笔。</span><span class="sxs-lookup"><span data-stu-id="ecb20-137">Click the pencil for the **msftlearn-vnet1** resource.</span></span>

1. <span data-ttu-id="ecb20-138">这将显示用于编辑标签的对话框。</span><span class="sxs-lookup"><span data-stu-id="ecb20-138">This will display the dialog to edit the Tags.</span></span> <span data-ttu-id="ecb20-139">让我们将几个标记添加到此 VNet。</span><span class="sxs-lookup"><span data-stu-id="ecb20-139">Let's add a couple tags to this VNet.</span></span> <span data-ttu-id="ecb20-140">在 "**名称**框类型"**部门**中, 在 "**值**" 框中键入 "**财务**"。</span><span class="sxs-lookup"><span data-stu-id="ecb20-140">In the **NAME** box type **Department**, and in the **VALUE** box type **Finance**.</span></span> <span data-ttu-id="ecb20-141">单击 "**保存**" 以保存所做的更改, 然后单击 "**关闭**" 关闭该对话框。</span><span class="sxs-lookup"><span data-stu-id="ecb20-141">Click **Save** to save your changes, then click **Close** to close the dialog.</span></span>

    ![显示对话框以添加标记的门户图像](../media/3-add-tag-1.PNG)

1. <span data-ttu-id="ecb20-143">让我们为**msftlearn-vnet2** VNet 执行相同的步骤。</span><span class="sxs-lookup"><span data-stu-id="ecb20-143">Let's do the same steps for the **msftlearn-vnet2** VNet.</span></span> <span data-ttu-id="ecb20-144">对于此 VNet, 请将 "**部门: 营销**" 标记添加到资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-144">For this VNet, add a **Department:Marketing** tag to the resource.</span></span>

    <span data-ttu-id="ecb20-145">您现在应该会看到应用于每个资源的标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-145">You should now see your tags applied to each resource.</span></span>

    ![显示包含标记的资源的门户的图像](../media/3-tags-displayed.PNG)

1. <span data-ttu-id="ecb20-147">让我们批量为这两个资源添加标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-147">Let's add tags to both of these resources in bulk.</span></span> <span data-ttu-id="ecb20-148">选中每个 vnet 左侧的复选框, 然后在顶部菜单中单击 "**分配标签**"。</span><span class="sxs-lookup"><span data-stu-id="ecb20-148">Select the checkbox on the left for each of the VNets and click **Assign tags** in the top menu.</span></span> <span data-ttu-id="ecb20-149">通过选择多个资源, 我们可以批量向其添加标记, 以便在有多个资源要对其应用相同标记的情况下轻松地向其添加标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-149">By selecting multiple resources, we can add a tag to them in bulk, making it easy if we have multiple resources we want to apply the same tag to.</span></span>

    <span data-ttu-id="ecb20-150">将 "**环境: 培训**" 标记添加到资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-150">Add the **Environment:Training** tag to the resources.</span></span> <span data-ttu-id="ecb20-151">您应该会在对话框中看到将应用于每个 vnet 的标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-151">You should see in the dialog that the tag will be applied to each of the VNets.</span></span>

    ![显示用于批量添加标签的对话框的门户图像](../media/3-add-bulk-tag.PNG)

    <span data-ttu-id="ecb20-153">返回到资源列表现在, 您将看到一个**2**显示, 因为我们现在对每个资源应用了两个标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-153">Back in the resource list you'll now see a **2** displayed as we now have two tags applied to each resource.</span></span>

1. <span data-ttu-id="ecb20-154">我们来看看如何使用标记来筛选你的资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-154">Let's take a look at how we can use tags to filter your resources.</span></span> <span data-ttu-id="ecb20-155">在左侧的主 Azure 菜单上, 选择 "**所有资源**"。</span><span class="sxs-lookup"><span data-stu-id="ecb20-155">On the main Azure menu on the left select **All resources**.</span></span>

1. <span data-ttu-id="ecb20-156">在 "**所有标记**" 下拉下的 "**环境**选择**培训**" 下。</span><span class="sxs-lookup"><span data-stu-id="ecb20-156">In the **All tags** drop down, under **Environment** select **Training**.</span></span> <span data-ttu-id="ecb20-157">您应该只会看到显示的两个 vnet, 因为我们已使用 "**环境: 培训**" 标记对这些资源进行了标记。</span><span class="sxs-lookup"><span data-stu-id="ecb20-157">You should see only your two VNets displayed, since we tagged those resources with the **Environment:Training** tag.</span></span>

    ![在培训标记上筛选出的所有资源的图像](../media/3-all-resources-tag-filter.PNG)

1. <span data-ttu-id="ecb20-159">此外, 我们还可以通过对 "**部门: 财务**" 或 "**部门: 营销**标记" 进行进一步筛选来进一步筛选这些内容。</span><span class="sxs-lookup"><span data-stu-id="ecb20-159">We can further filter these by additionally filtering on the **Department:Finance** or **Department:Marketing** tags.</span></span>

## <a name="use-tags-for-organization"></a><span data-ttu-id="ecb20-160">使用组织的标记</span><span class="sxs-lookup"><span data-stu-id="ecb20-160">Use tags for organization</span></span>

<span data-ttu-id="ecb20-161">上面的示例只是一个示例, 您可以在其中使用标记来组织资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-161">The above example is just one example of where you can use tags to organize your resources.</span></span> <span data-ttu-id="ecb20-162">通过其灵活性, 可以通过多种方式使用标记来提高优势。</span><span class="sxs-lookup"><span data-stu-id="ecb20-162">With their flexibility, there are several ways you can use tags to your advantage.</span></span>

<span data-ttu-id="ecb20-163">您可以使用标记对帐单数据进行分组。</span><span class="sxs-lookup"><span data-stu-id="ecb20-163">You can use tags to group your billing data.</span></span> <span data-ttu-id="ecb20-164">例如, 如果您正在为不同的组织运行多个虚拟机, 请使用标记按成本中心对使用进行分组。</span><span class="sxs-lookup"><span data-stu-id="ecb20-164">For example, if you're running multiple VMs for different organizations, use the tags to group usage by cost center.</span></span> <span data-ttu-id="ecb20-165">您还可以使用标记按运行时环境对成本进行分类, 例如在生产环境中运行的 vm 的记帐使用情况。</span><span class="sxs-lookup"><span data-stu-id="ecb20-165">You can also use tags to categorize costs by runtime environment, such as the billing usage for VMs running in the production environment.</span></span> <span data-ttu-id="ecb20-166">在导出帐单数据或通过计费 api 访问它时, 这些标记将包含在该数据中, 并可用于从成本角度进一步切分您的数据。</span><span class="sxs-lookup"><span data-stu-id="ecb20-166">When exporting billing data or accessing it through billing APIs, tags are included in that data and can be used to further slice your data from a cost perspective.</span></span>

<span data-ttu-id="ecb20-167">您可以使用特定的标记名称或值检索订阅中的所有资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-167">You can retrieve all the resources in your subscription with a specific tag name or value.</span></span> <span data-ttu-id="ecb20-168">标记使您能够从不同的资源组中检索相关资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-168">Tags enable you to retrieve related resources from different resource groups.</span></span> <span data-ttu-id="ecb20-169">当您需要组织资源以进行计费或管理时, 此方法非常有用。</span><span class="sxs-lookup"><span data-stu-id="ecb20-169">This approach is helpful when you need to organize resources for billing or management.</span></span>

<span data-ttu-id="ecb20-170">标记资源还可以帮助监视跟踪受影响的资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-170">Tagging resources can also help in monitoring to track down impacted resources.</span></span> <span data-ttu-id="ecb20-171">监视系统可能包含带警报的标记数据, 使您能够准确知道受影响的用户。</span><span class="sxs-lookup"><span data-stu-id="ecb20-171">Monitoring systems could include tag data with alerts, giving you the ability to know exactly who is impacted.</span></span> <span data-ttu-id="ecb20-172">在上面的示例中, 我们将 "**部门: 财务**" 标记应用到**msftlearn-vnet1**资源。</span><span class="sxs-lookup"><span data-stu-id="ecb20-172">In our example above, we applied the **Department:Finance** tag to the **msftlearn-vnet1** resource.</span></span> <span data-ttu-id="ecb20-173">如果在**msftlearn-vnet1**上引发了警报, 并且警报包含了标记, 我们就会知道财务部门可能会受到触发警报的条件的影响。</span><span class="sxs-lookup"><span data-stu-id="ecb20-173">If an alarm was thrown on **msftlearn-vnet1** and the alarm included the tag, we'd know that the finance department may be impacted by the condition that triggered the alarm.</span></span> <span data-ttu-id="ecb20-174">如果出现问题, 则此上下文信息可能非常有用。</span><span class="sxs-lookup"><span data-stu-id="ecb20-174">This contextual information can be valuable if and when an issue occurs.</span></span>

<span data-ttu-id="ecb20-175">此外, 在自动化中使用标记也是很常见的。</span><span class="sxs-lookup"><span data-stu-id="ecb20-175">It's also common for tags to be used in automation.</span></span> <span data-ttu-id="ecb20-176">如果要在非工作时间内自动关闭和启动虚拟机, 以节省成本, 可以使用标记来协助实现。</span><span class="sxs-lookup"><span data-stu-id="ecb20-176">If you want to automate the shutdown and startup of virtual machines in development environments during off-hours to save costs, you can use tags to assist in this.</span></span> <span data-ttu-id="ecb20-177">将**shutdown:** **7AM**标记添加到虚拟机, 然后创建一个查找这些标记的自动化作业, 并根据标记值将其关闭或启动它们。</span><span class="sxs-lookup"><span data-stu-id="ecb20-177">Add a **shutdown:6PM** and **startup:7AM** tag to the virtual machines, then create an automation job that looks for these tags, and shuts them down or starts them up based on the tag value.</span></span> <span data-ttu-id="ecb20-178">Azure 自动化 runbook 库中有几个解决方案, 这些解决方案使用标记的方式类似于实现此目的。</span><span class="sxs-lookup"><span data-stu-id="ecb20-178">There are several solutions in the Azure Automation Runbooks Gallery that use tags in a similar manner to accomplish this.</span></span>
