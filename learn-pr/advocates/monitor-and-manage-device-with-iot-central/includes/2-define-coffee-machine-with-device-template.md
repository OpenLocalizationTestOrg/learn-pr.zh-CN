在 Azure IoT Central 中, 设备可以与您的应用程序交换的数据在定义设备的行为和功能的设备模板中指定, 或者在这种情况下在这种情况下为咖啡机。 创建设备模板时, 将从模板生成模拟设备。

模拟的设备生成遥测, 使您能够在连接物理/实际设备之前测试应用程序的行为。 

在此单位中, 您将为咖啡店创建一个用于指定以下功能和行为的设备模板:

### <a name="measurements"></a>值

度量是来自你的设备的数据。 您可以将多个度量值添加到设备模板, 以匹配设备的功能。

* **遥测度量**: 设备在一段时间内收集的数值数据点。 它们表示为连续流。 在这种情况下, 遥测度量为空气潮湿和水源温度。 

* **状态测量**: 设备或其组件在一段时间内的状态。 在这种情况下, 您将状态设置为 Brewing/not Brewing, 并且检测到未检测到的杯/杯。

### <a name="settings"></a>Settings

您可以使用设置将配置数据从应用程序发送到设备。 在这种情况下, 在 "设置" 中调整最佳的水源温度并将其发送到咖啡机。 如果设置已更新, 则在 UI 中将其标记为挂起, 直到设备确认已对设置更改做出响应。

### <a name="properties"></a>属性

与设备关联的设备元数据。 有两种类型的属性。

* 您可以使用*应用程序属性*在应用程序中记录有关设备的信息。 在这种情况下, 可以使用应用程序属性来设置咖啡机的理想水源温度范围。 应用程序属性存储在应用程序中, 并且不与设备同步。 

* 您可以使用*设备属性*使设备能够向应用程序发送属性值。 这些属性仅可由设备更改。 在这种情况下, 您可以在 IoT Central 中配置名为 device 质保的设备属性已过期。 在将咖啡计算机连接到 IoT Central 之前, "设备保修过期" 字段仍为空。 一旦连接, 咖啡店将向应用程序发送保修状态。 

### <a name="commands"></a>命令

可以使用命令从应用程序远程管理设备。 您可以从云上直接运行设备上的命令来控制设备。 在这种情况下, 您可以在您的咖啡机上运行命令, 将其设置为维护或启动 brewing。 

## <a name="create-a-device-template-for-the-coffee-maker"></a>为咖啡 maker 创建设备模板
设备模板定义设备的行为和功能或在这种情况下为咖啡 maker。

1. 导航到 Azure IoT 中心门户中的应用程序**主页**, 并选择 "**创建设备模板**"。

> [!TIP]
> 您可以通过单击左侧菜单上的 "主页" 图标访问主页。

1. 为自定义设备模板输入*已连接的咖啡 Maker* 。 
 
1. 选择 "**创建**"。 您已为咖啡 maker 创建了一个空白设备模板, 您可以在其中定义计算机的行为和功能。 

## <a name="define-telemetry-measurements-of-temperature-and-humidity"></a>定义温度和湿度的遥测度量
1. 在 "**已连接的咖啡 Maker**设备" 模板中, 确保位于定义遥测的 "**度量**" 页上。 

1. 若要添加温度遥测度量, 请选择 "**编辑模板**", 然后选择 "**新建度量**"。 然后选择 "**遥测**" 作为 "度量类型"。

1. 为设备模板定义的每种遥测类型都包含如下配置选项:
    * 显示选项
    * 遥测的详细信息
    * 模拟参数

    若要配置温度和湿度遥测, 请使用下表中的信息。 创建遥测项目时, 需要通过为表中的每个项目选择 " **+ 新度量**" 来添加新的度量。
    
    |显示名称|字段名称|"单位"|Min|Max|小数位数|
    |---|---|---|---|---|---|
    |水源温度|waterTemperature|温度|86|100|1|
    |空气湿度|airHumidity|%|20|100|0|
   
    您还可以选择遥测显示器的颜色。 若要保存遥测定义, 请选择 "**保存**"。 在为剩余单位中的度量、设置、属性和命令创建更多定义时, 请记住在完成后保存。  

    > [!NOTE]
    > 输入的字段名称与设备模板中的表中所示的完全相同。 如果字段名称与相应设备代码中的属性名称不匹配, 则遥测无法显示在应用程序中。 输入设置和属性信息时, 请执行相同的操作。

    ![显示在编辑遥测刀片上添加了水温度遥测的已连接的 "咖啡 maker" 设备模板的度量页面的屏幕截图。](../media/2-device-template-a.png)

## <a name="define-state-measurement-for-brewingnot-brewing-and-cup-detectedcup-not-detected"></a>定义 brewing/not brewing 的状态测量和检测到的未检测到的杯/杯
通过选择 "**编辑模板**", 然后选择 " **+ 新度量**", 在 "**度量**" 页中添加以下状态。 然后, 选择 "**状态**" 作为 "度量类型":

在 "**状态** > **Brewing** " 页上, 将值添加为 true。 单击**+** "值" 旁边的 "**值**", 将其他值添加为 false, 可选的显示名称为 Not Brewing。 请务必选择 "**保存**" 以保存编辑内容。

   |显示名称|字段名称|值1|显示名称1|值2|显示名称2|
   |---|---|---|---|---|---|
   |Brewing|stateBrewing|True|Brewing|FALSE|不 Brewing|
   |检测到杯|stateCupDetected|True|检测到杯|FALSE|未检测到杯|

> [!NOTE]
> 定义遥测和状态之后, 您将看到在设备屏幕上从设备模板生成的模拟数据。 模拟数据使您能够在将物理设备连接到 IoT Central 之前测试应用程序的行为。 

## <a name="set-the-optimal-temperature-of-the-coffee-machine"></a>设置咖啡机的最佳温度
导航到 "**设置**" 页, "**度量**" 旁边的选项卡。 单击 "**编辑模板**"。 在 "**设置**" 页面上的 "**库**" 下添加以下**编号**设置:

|显示名称|字段名称|"单位"|小|Min|Max|初始|
|---|---|---|---|---|---|---|---|
|最佳温度|setTemperature|温度|1|86|100|95|

## <a name="use-properties-to-store-warranty-info-and-water-temperature-range"></a>使用属性存储保修信息和水源温度范围

通过选择 "**编辑模板**", 在 "**属性**" 页上添加以下**数字**属性:

|显示名称|字段名称|"单位"|小数位数|Min|Max|初始
|---|---|---|---|---|---|---|
|咖啡的最小温度|propertyMinTemperature|温度|1|88|92|90|
|咖啡 Maker 的最大温度|propertyMaxTemperature|温度|1|96|99|98| 

在 "**属性**" 页上添加以下**设备属性**:

   |显示名称|字段名称|数据类型|
   |---|---|---|
   |设备保修已过期|propertyWarrantyExpired|多种|

> [!NOTE]
> 设备属性由您的设备 (在此示例中, 为您的咖啡计算机) 发送。 将咖啡馆计算机连接到 Azure IoT 中心后, 设备属性保修将发送到应用程序, 并显示在 "设备保修过期" 字段中。 

## <a name="use-commands-to-set-maintenance-mode-and-start-brewing"></a>使用命令设置维护模式并启动 brewing

通过选择 "**编辑模板**", 在 "**命令**" 页上添加以下命令。

|显示名称|字段名称|默认超时|数据类型|
|---|---|---|---|---|---|---|
|设置维护模式|cmdSetMaintenance|30|文本框| 
|启动 Brewing|cmdStartBrewing|30|文本框|